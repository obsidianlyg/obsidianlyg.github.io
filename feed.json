{
    "version": "https://jsonfeed.org/version/1",
    "title": "L小悠的日常L",
    "subtitle": "obsidianlyg",
    "icon": "https://obsidianlyg.github.io/images/favicon.ico",
    "description": "最好的生活是：时光，浓淡相宜，人心，远近相安",
    "home_page_url": "https://obsidianlyg.github.io",
    "items": [
        {
            "id": "https://obsidianlyg.github.io/Note/Java%E4%B8%ADList%E9%9B%86%E5%90%88%E5%88%86%E9%A1%B5/",
            "url": "https://obsidianlyg.github.io/Note/Java%E4%B8%ADList%E9%9B%86%E5%90%88%E5%88%86%E9%A1%B5/",
            "title": "利用Java导入Excel到数据库",
            "date_published": "2023-12-05T06:43:39.000Z",
            "content_html": "<h3 id=\"使用stream-api进行分页\"><a class=\"anchor\" href=\"#使用stream-api进行分页\">#</a> 使用 stream api 进行分页</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> subList <span class=\"token operator\">=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">skip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>pageNo<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">toList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>pageNo 为当前页数，pageSize 为每页大小</p>\n<h3 id=\"配合jpa使用样例\"><a class=\"anchor\" href=\"#配合jpa使用样例\">#</a> 配合 JPA 使用样例</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">summaryList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IkgPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>page <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getPageSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token comment\">// 不分页全量查询  </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span> <span class=\"token operator\">==</span> page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                page <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IkgPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            page<span class=\"token punctuation\">.</span><span class=\"token function\">setPageNumber</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            page<span class=\"token punctuation\">.</span><span class=\"token function\">setPageSize</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span>MAX_VALUE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">//        Map&lt;String, Object> param = page.getParams();  </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">//        if (param != null) &#123;  </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">//  </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//        &#125;  </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">></span></span> summaryDTOList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> maps <span class=\"token operator\">=</span> bidmarginrecoveryRepo<span class=\"token punctuation\">.</span><span class=\"token function\">getSummary</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">:</span> maps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token class-name\">BidMarginSummaryDTO</span> dto <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setProjectId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"projectId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setCmpName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"collectionUnit\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setNextDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"nextDate\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">double</span> margin <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">double</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"margin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">double</span> currentAmount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">double</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"currentAmount\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">double</span> actualAmount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">double</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"actualAmount\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token comment\">// 保证金  </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setApplyAmount</span><span class=\"token punctuation\">(</span>margin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token comment\">// 保证金申请的实交金额  </span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setActualAmount</span><span class=\"token punctuation\">(</span>actualAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token comment\">// 已回收金额  </span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setRecoveryAmount</span><span class=\"token punctuation\">(</span>currentAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token comment\">// 未回收金额  </span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setNotRecoveryAmount</span><span class=\"token punctuation\">(</span>margin<span class=\"token operator\">-</span>currentAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            summaryDTOList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>dto<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">int</span> total <span class=\"token operator\">=</span> summaryDTOList<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">int</span> pageSize <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getPageSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">int</span> pageNo <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getPageNumber</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">//        int pageSum = (total -1) / pageSize +1;  </span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        page<span class=\"token punctuation\">.</span><span class=\"token function\">setTotal</span><span class=\"token punctuation\">(</span>total<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        page<span class=\"token punctuation\">.</span><span class=\"token function\">setRows</span><span class=\"token punctuation\">(</span>summaryDTOList<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">skip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>pageNo <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">toList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">return</span> page<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpdXhpYW83MjM4NDYvYXJ0aWNsZS9kZXRhaWxzLzExNjIxMDY2MA==\">参考链接</span></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/SpringBoot%E4%B8%8B%E4%BD%BF%E7%94%A8Quartz%E8%AE%BE%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/",
            "url": "https://obsidianlyg.github.io/Note/SpringBoot%E4%B8%8B%E4%BD%BF%E7%94%A8Quartz%E8%AE%BE%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/",
            "title": "SpringBoot下使用Quartz设置定时任务",
            "date_published": "2023-11-28T03:46:00.000Z",
            "content_html": "<h3 id=\"基础使用\"><a class=\"anchor\" href=\"#基础使用\">#</a> <strong>基础使用</strong></h3>\n<p>Quartz 的核心类有以下三部分：</p>\n<ul>\n<li><strong>任务 Job ：</strong> 需要实现的任务类，实现  <code>execute()</code>  方法，执行后完成任务。</li>\n<li><strong>触发器 Trigger ：</strong> 包括  <code>SimpleTrigger</code>  和  <code>CronTrigger</code> 。</li>\n<li><strong>调度器 Scheduler ：</strong> 任务调度器，负责基于  <code>Trigger</code>  触发器，来执行 Job 任务。</li>\n</ul>\n<h3 id=\"添加依赖\"><a class=\"anchor\" href=\"#添加依赖\">#</a> 添加依赖</h3>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- 核心包 --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.quartz-scheduler<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>quartz<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.3.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">&lt;!-- 工具包 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.quartz-scheduler<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>quartz-jobs<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.3.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"demo\"><a class=\"anchor\" href=\"#demo\">#</a> demo</h3>\n<p>QuartzConfig 类<br />\n这个类用来进行任务描述，进行定时执行并将对应的执行逻辑类进行绑定</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">/**  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre> * 定义任务描述和具体的执行时间  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre> */</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">QuartzConfig</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JobDetail</span> <span class=\"token function\">jobDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 指定任务描述具体的实现类  </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">JobBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">newJob</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IDCardWarningJob</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token comment\">// 指定任务的名称  </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">withIdentity</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"IDCardWarningJob\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token comment\">// 任务描述  </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">withDescription</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"任务描述：身份预警更新表\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token comment\">// 每次任务执行后进行存储  </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">storeDurably</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Trigger</span> <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token comment\">// 创建触发器  </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">TriggerBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">newTrigger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token comment\">// 绑定工作任务  </span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">forJob</span><span class=\"token punctuation\">(</span><span class=\"token function\">jobDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">//                .withSchedule (CronScheduleBuilder.dailyAtHourAndMinute (1, 0))  // 设置每天凌晨 1 点触发一次任务  </span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">withSchedule</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CronScheduleBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">cronSchedule</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0 0 1 * * ?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">// 设置每天凌晨 1 点触发一次任务  </span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>demoJob 类<br />\n这个类负责定时任务的逻辑处理（execute 方法中写代码逻辑）</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>alibaba<span class=\"token punctuation\">.</span>druid<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>logging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Log</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>alibaba<span class=\"token punctuation\">.</span>druid<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>logging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LogFactory</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>iknight<span class=\"token punctuation\">.</span>cost<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IdentityWarningService</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Job</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JobExecutionContext</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JobExecutionException</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Autowired</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">IDCardWarningJob</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Job</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Log</span> logger <span class=\"token operator\">=</span> <span class=\"token class-name\">LogFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLog</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IDCardWarningJob</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token annotation punctuation\">@Autowired</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">IdentityWarningService</span> service<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setClaimPostServiceImpl</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IdentityWarningService</span> service<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>service <span class=\"token operator\">=</span> service<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JobExecutionContext</span> context<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">JobExecutionException</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        service<span class=\"token punctuation\">.</span><span class=\"token function\">updateDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>关于 cron 表达式可以跳转这个连接 -&gt;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9xcWUyLmNvbS9jcm9u\"> 表达式生成器</span></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E9%80%9A%E8%BF%87Java%E5%AF%BC%E5%85%A5Excel/",
            "url": "https://obsidianlyg.github.io/Note/%E9%80%9A%E8%BF%87Java%E5%AF%BC%E5%85%A5Excel/",
            "title": "利用Java导入Excel到数据库",
            "date_published": "2023-08-02T09:05:39.000Z",
            "content_html": "<h1 id=\"esayexcel的使用\"><a class=\"anchor\" href=\"#esayexcel的使用\">#</a> EsayExcel 的使用</h1>\n<h2 id=\"引入依赖\"><a class=\"anchor\" href=\"#引入依赖\">#</a> 引入依赖</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.alibaba<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>easyexcel<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.1.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"类属性中的注解\"><a class=\"anchor\" href=\"#类属性中的注解\">#</a> 类属性中的注解</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 默认下标从<span class=\"token number\">0</span>开始，index可以不填，value值必填</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"excel名称\"</span><span class=\"token punctuation\">,</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre># 可以识别多行字段</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品价格\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre># 忽略该属性</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token annotation punctuation\">@ExcelIgnore</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> sex<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"代码部分\"><a class=\"anchor\" href=\"#代码部分\">#</a> 代码部分</h2>\n<p>在 Service 中的代码如下</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">importExcel</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MultipartFile</span> file<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Boolean</span> keep<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token comment\">// 获取文件流</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token class-name\">InputStream</span> inputStream <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token comment\">//easyExcel 导入文件</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token class-name\">EasyExcel</span><span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>inputStream<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EmployeeModel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EmpImportListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> pubCodeRepo<span class=\"token punctuation\">,</span> orgRepo<span class=\"token punctuation\">,</span> keep<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">sheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">doRead</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>若 Excel 中只有第一行有标题可以去除 head 与 headRowNumber 方法</strong><br />\n SyncLineLossImportListener 类</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SyncLineLossImportListener</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AnalysisEventListener</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TPowerSyncLineLoss</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Logger</span> LOGGER <span class=\"token operator\">=</span> <span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SyncLineLossImportListener</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     * 每隔 5 条存储数据库，实际使用中可以 3000 条，然后清理 list ，方便内存回收</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> BATCH_COUNT <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TPowerSyncLineLoss</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">ListUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayListWithExpectedSize</span><span class=\"token punctuation\">(</span>BATCH_COUNT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     * 如果使用了 spring, 请使用这个构造方法。每次创建 Listener 的时候需要把 spring 管理的类传进来</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">TPowerSyncLineLossService</span> tPowerSyncLineLossService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> dataDate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SyncLineLossImportListener</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TPowerSyncLineLossService</span> tPowerSyncLineLossService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tPowerSyncLineLossService <span class=\"token operator\">=</span> tPowerSyncLineLossService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SyncLineLossImportListener</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TPowerSyncLineLossService</span> tPowerSyncLineLossService<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> dataDate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tPowerSyncLineLossService <span class=\"token operator\">=</span> tPowerSyncLineLossService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataDate <span class=\"token operator\">=</span> dataDate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TPowerSyncLineLoss</span> syncLineLoss<span class=\"token punctuation\">,</span> <span class=\"token class-name\">AnalysisContext</span> analysisContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"解析到一条数据:&#123;&#125;\"</span><span class=\"token punctuation\">,</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>syncLineLoss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>syncLineLoss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token comment\">// 达到 BATCH_COUNT 了，需要去存储一次数据库，防止数据几万条数据在内存，容易 OOM</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> BATCH_COUNT<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token function\">saveData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token comment\">// 存储完成清理 list</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            list <span class=\"token operator\">=</span> <span class=\"token class-name\">ListUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayListWithExpectedSize</span><span class=\"token punctuation\">(</span>BATCH_COUNT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>     * 所有数据解析完成了 都会来调用</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>     *</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>     * @param context</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">doAfterAllAnalysed</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AnalysisContext</span> context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token comment\">// 这里也要保存数据，确保最后遗留的数据也存储到数据库</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token function\">saveData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"所有数据解析完成！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>     * 加上存储数据库</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">saveData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;&#125;条数据，开始存储数据库！\"</span><span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>tmp<span class=\"token operator\">-></span><span class=\"token punctuation\">&#123;</span>tmp<span class=\"token punctuation\">.</span><span class=\"token function\">setDataDate</span><span class=\"token punctuation\">(</span>dataDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        tPowerSyncLineLossService<span class=\"token punctuation\">.</span><span class=\"token function\">saveBatch</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"存储数据库成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>设置二级表头<br />\n在需要合并单元格的属性上设置  <code>@ExcelMerge</code>  注解，二级表头通过设置  <code>@ExcelProperty</code>  注解中 <strong>value</strong> 值为数组形式来实现该效果：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @author william@StarImmortal</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token annotation punctuation\">@Data</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderBO</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"订单主键\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> isPrimaryKey <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> id<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"订单编号\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> orderId<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"收货地址\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> address<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"创建时间\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token annotation punctuation\">@DateTimeFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yyyy-MM-dd HH:mm:ss\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Date</span> createTime<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品编号\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> productId<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品名称\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品标题\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> subtitle<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"品牌名称\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> brandName<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品价格\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">BigDecimal</span> price<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品数量\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> count<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxOTkxNjU4OTIzL2FydGljbGUvZGV0YWlscy8xMjgxNTMwMTI=\">导入导出参考连接</span></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/ventoy%E4%B8%BB%E9%A2%98%E6%B5%8B%E8%AF%95/",
            "url": "https://obsidianlyg.github.io/Note/ventoy%E4%B8%BB%E9%A2%98%E6%B5%8B%E8%AF%95/",
            "title": "ventoy主题配置并测试",
            "date_published": "2022-07-14T05:11:45.000Z",
            "content_html": "<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmVudG95Lm5ldC9jbi9kb3dubG9hZC5odG1s\">ventoy 下载地址</span></p>\n<h2 id=\"准备工作\"><a class=\"anchor\" href=\"#准备工作\">#</a> 准备工作</h2>\n<p>ventoy 软件</p>\n<p>安装好 ventoy 的 u 盘</p>\n<p>安装好 VMware</p>\n<p>选好主题（<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ25vbWUtbG9vay5vcmcvYnJvd3NlP2NhdD0xMDkmYW1wO29yZD1yYXRpbmc=\">主题链接</span>）</p>\n<h2 id=\"配置\"><a class=\"anchor\" href=\"#配置\">#</a> 配置</h2>\n<ol>\n<li>将主题包解压并放到 U 盘里</li>\n<li>打开 ventoy 安装位置，点击 VentoyPlugson.exe 启动插件并启动（启动后会弹出 web 配置界面）</li>\n<li>选择主题插件选项 -&gt; 主题配置文件栏点击新增 -&gt; 输入完整的绝对路径并确定</li>\n<li>停止并退出插件 -&gt;<img data-src=\"https://i.imgtg.com/2023/06/27/OkzsLg.png\" alt=\"image-20220714133001837\" /></li>\n</ol>\n<h2 id=\"测试\"><a class=\"anchor\" href=\"#测试\">#</a> 测试</h2>\n<p>打开 VMware 新建虚拟机（基本新建步骤不做介绍，可自行百度）</p>\n<p>关键步骤：</p>\n<ul>\n<li>\n<p>点击编辑虚拟机设置 -&gt; 硬件选项 -&gt; 点击添加 -&gt; 点击硬盘</p>\n</li>\n<li>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/Okz8cC.png\" alt=\"image-20220714133943441\" /></p>\n</li>\n<li>\n<p>选择 SATA→使用物理磁盘 →设备一般选最后一个，之后一直下一步完成即可</p>\n</li>\n<li>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/OkzuOL.png\" alt=\"image-20220714142328396\" /></p>\n</li>\n<li>\n<p>最上边绿色三角，选择打开电源时进入固件</p>\n</li>\n<li>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/OkzINi.png\" alt=\"image-20220714134305864\" /></p>\n</li>\n<li>\n<p>最后开启虚拟机即可看到主题啦（温馨提示：更新完主题配置，重启虚拟机才能看到更新后的内容）</p>\n</li>\n</ul>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/Okz3LX.png\" alt=\"image-20220714134421036\" /></p>\n",
            "tags": [
                "linux"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Linux%E5%A4%87%E4%BB%BD%EF%BC%88Rsnapshot%EF%BC%89/",
            "url": "https://obsidianlyg.github.io/Note/Linux%E5%A4%87%E4%BB%BD%EF%BC%88Rsnapshot%EF%BC%89/",
            "title": "Linux备份（Rsnapshot）",
            "date_published": "2022-07-04T01:04:52.000Z",
            "content_html": "<h1 id=\"linux备份rsnapshot\"><a class=\"anchor\" href=\"#linux备份rsnapshot\">#</a> Linux 备份（Rsnapshot）</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudHh1dy50b3AvYXJ0aWNsZS9yc25hcHNob3Q=\">参考链接</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NodXlhbndlbjg1MDcvYXJ0aWNsZS9kZXRhaWxzLzEwMDkwNjk5MA==\">参考链接 2</span></p>\n<h3 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h3>\n<p><code>apt intstall rsnapshot rsync</code></p>\n<h3 id=\"修改配置文件\"><a class=\"anchor\" href=\"#修改配置文件\">#</a> 修改配置文件</h3>\n<p><code>vim /etc/rsnapshot.conf</code></p>\n<blockquote>\n<p>特别注意配置文件对 tab 有着严格的要求，建议复制内部自带的 tab 进行编写</p>\n</blockquote>\n<ul>\n<li>编写配置\n<ul>\n<li>\n<p><code>snapshot_root</code>  指定一个备份目录</p>\n</li>\n<li>\n<p><code>cmd_ssh</code>  允许远程备份（直接取消注释即可）</p>\n</li>\n<li>\n<p>指定备份保留数量</p>\n<p>如下所示，其中的 <code>hourly</code>  参数是名称，后面数值对应备份保留数量</p>\n<p>对于备份，采用的是增量备份，无需担心过多的频率带来的额外空间开销</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#########################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#           BACKUP INTERVALS            #</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># Must be unique and in ascending order #</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># i.e. alpha, beta, gamma, etc.      #</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#########################################</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>retain\thourly\t<span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>retain\tdaily\t<span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>retain\tweekly\t<span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>retain\tmonthly\t<span class=\"token number\">2</span></pre></td></tr></table></figure></li>\n<li>\n<p>指定当前服务器的 SSH 端口</p>\n<p>若更改了 SSH 默认端口，需要指定远程备份服务器的端口号，否则不变即可</p>\n<p><code>ssh_args -p xxxx</code></p>\n</li>\n<li>\n<p>备份目录</p>\n<p>对于本地备份，直接指定路径即可</p>\n<blockquote>\n<p>注意最后要添加 / 进行路径闭合，不然语法检查不通过</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 本地备份路径</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>backup        /       localhost/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>backup        /etc/       localhost/</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 远程备份</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>backup         root@example.com:/home/         /data/backup/</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 排除不需要的目录，多个可用逗号隔开</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>backup        /       localhost/       <span class=\"token assign-left variable\">exclude</span><span class=\"token operator\">=</span>/mnt1,exclude<span class=\"token operator\">=</span>/mnt2,exclude<span class=\"token operator\">=</span>/mnt3</pre></td></tr></table></figure></li>\n<li>\n<p>配置概览</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>config_version\t<span class=\"token number\">1.2</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>snapshot_root\t/mnt3/back_up/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>cmd_cp\t\t/bin/cp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>cmd_rm\t\t/bin/rm</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>cmd_rsync\t/usr/bin/rsync</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>cmd_logger\t/usr/bin/logger</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>retain\thourly\t<span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>retain\tdaily\t<span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>retain\tweekly\t<span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>retain\tmonthly\t<span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>verbose\t\t<span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>loglevel\t<span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>lockfile\t/var/run/rsnapshot.pid</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>backup\t/\t\tlocalhost/\t<span class=\"token assign-left variable\">exclude</span><span class=\"token operator\">=</span>/mnt1,exclude<span class=\"token operator\">=</span>/mnt2,exclude<span class=\"token operator\">=</span>/mnt3</pre></td></tr></table></figure></li>\n<li>\n<p>参数解释</p>\n<ol>\n<li><code>config_version 1.2</code> = 配置文件版本</li>\n<li><code>snapshot_root</code> = 存储快照的备份目的地</li>\n<li><code>cmd_cp</code> = 复制命令的路径</li>\n<li><code>cmd_rm</code> = 删除命令的路径</li>\n<li><code>cmd_rsync</code> = rsync 的路径</li>\n<li><code>cmd_ssh</code> = SSH 路径</li>\n<li><code>cmd_logger</code> = shell 命令接口到 syslog 的路径</li>\n<li><code>cmd_du</code> = 磁盘使用命令的路径</li>\n<li><code>interval hourly</code> = 要保留多少小时的备份。</li>\n<li><code>interval daily</code> = 要保留多少每日备份。</li>\n<li><code>interval weekly</code> = 要保留多少每周备份。</li>\n<li><code>interval monthly</code> = 每月要保留多少备份。</li>\n<li><code>ssh_args</code> = 可选的 SSH 参数，例如不同的端口 (-p)</li>\n<li><code>verbose</code> = verbose</li>\n<li><code>loglevel</code> = loglevel</li>\n<li><code>logfile</code> = 日志文件的路径</li>\n<li><code>exclude_file</code> = 排除文件的路径（将更详细地解释）</li>\n<li><code>rsync_long_args</code> = 传递给 rsync 的长参数</li>\n<li><code>lockfile</code> = lockfile</li>\n<li><code>backup</code> = 要备份的内容的完整路径，然后是放置的相对路径。</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<p>对配置文件的语法测试</p>\n<p><code>rsnapshot configtest</code></p>\n<p>测试当前配置，但不使其生效</p>\n<p>rsnapshot -t hourly</p>\n<h3 id=\"执行备份\"><a class=\"anchor\" href=\"#执行备份\">#</a> 执行备份</h3>\n<p><code>rsnapshot hourly</code></p>\n<h3 id=\"自动化流程\"><a class=\"anchor\" href=\"#自动化流程\">#</a> <strong>自动化流程</strong></h3>\n<p>使流程自动化，你需要安排 rsnapshot 以一定的时间间隔运行 Cron. 默认情况下，rsnapshot 自带 cron 文件在  <code>/etc/cron.d/rsnapshot</code> <br />\n，如果它不存在，则创建一个并向其添加以下几行。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># This is a sample cron file for rsnapshot.</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># The values used correspond to the examples in /etc/rsnapshot.conf.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># There you can also set the backup points and many other things.</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># To activate this cron file you have to uncomment the lines below.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># Feel free to adapt it to your needs.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">0</span>     */12    * * *    root    /usr/bin/rsnapshot hourly</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">30</span>     <span class=\"token number\">3</span>     * * *    root    /usr/bin/rsnapshot daily</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">15</span>     <span class=\"token number\">3</span>     * * <span class=\"token number\">1</span>    root    /usr/bin/rsnapshot weekly</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">30</span>     <span class=\"token number\">2</span>     <span class=\"token number\">1</span> * *    root    /usr/bin/rsnapshot monthly</pre></td></tr></table></figure><blockquote>\n<p>实际上可以直接输入 <code>crontab -e</code>  之后直接编辑即可</p>\n</blockquote>\n",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/about/",
            "url": "https://obsidianlyg.github.io/about/",
            "title": "关于个人",
            "date_published": "2022-06-26T16:00:00.000Z",
            "content_html": "<h1 id=\"本鱼\"><a class=\"anchor\" href=\"#本鱼\">#</a> 本鱼</h1>\n<p>昵称：鲈鱼</p>\n<p>性别：男</p>\n<p>个人 QQ：879142964</p>\n<hr />\n<p>简介：</p>\n<ul>\n<li>爱好：硬要说的话就是，本鱼特别喜欢听音乐，<br />\n特别是纯音乐，当然其他音乐也是可以接受的，<br />\n音乐类型偏向轻柔吧。<br />\n特别是在做事情的时候，很喜欢听音乐。</li>\n</ul>\n",
            "tags": [
                "about"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Ubuntu%E6%8D%A2%E6%BA%90/",
            "url": "https://obsidianlyg.github.io/Note/Ubuntu%E6%8D%A2%E6%BA%90/",
            "title": "Ubuntu笔记",
            "date_published": "2022-05-01T02:29:28.000Z",
            "content_html": "<h2 id=\"查看信息\"><a class=\"anchor\" href=\"#查看信息\">#</a> 查看信息</h2>\n<p>查看完整整的 Ubuntu 系统信息：cat /proc/version</p>\n<p>查看列表型系统版本信息：lsb_release -a</p>\n<h2 id=\"换源\"><a class=\"anchor\" href=\"#换源\">#</a> 换源</h2>\n<p>Ubuntu 系统中，软件源文件地址为：/etc/apt/sources.list</p>\n<p>替换文件内容</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#添加阿里源</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#添加清华源</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse multiverse</span></pre></td></tr></table></figure><h2 id=\"ssh允许远程root连接\"><a class=\"anchor\" href=\"#ssh允许远程root连接\">#</a> ssh 允许远程 root 连接</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/ssh/sshd_config</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PermitRootLogin <span class=\"token function\">yes</span></pre></td></tr></table></figure><h2 id=\"修改root密码\"><a class=\"anchor\" href=\"#修改root密码\">#</a> 修改 root 密码</h2>\n<p><code>sudo passwd root</code></p>\n<h2 id=\"删除用户\"><a class=\"anchor\" href=\"#删除用户\">#</a> 删除用户</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#删除用户（在 root 权限下）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">userdel</span> -f <span class=\"token punctuation\">(</span>强制删除用户<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">userdel</span> -r <span class=\"token punctuation\">(</span>同时删除用户以及家目录<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">userdel</span> -fr xiyang</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#查看指定位置文件最后一行</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">tail</span> -1 /etc/passwd</pre></td></tr></table></figure><h2 id=\"解决启动终端无法加载bashrc导致文件无法高亮\"><a class=\"anchor\" href=\"#解决启动终端无法加载bashrc导致文件无法高亮\">#</a> 解决启动终端无法加载.bashrc 导致文件无法高亮</h2>\n<p>添加.bash_profile</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token builtin class-name\">test</span> -f .bashrc <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">source</span> .bashrc</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">fi</span></pre></td></tr></table></figure>",
            "tags": [
                "ubuntu"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/maven%E9%85%8D%E7%BD%AE/",
            "url": "https://obsidianlyg.github.io/Note/maven%E9%85%8D%E7%BD%AE/",
            "title": "maven基础配置",
            "date_published": "2022-04-30T05:30:58.000Z",
            "content_html": "<ol>\n<li>\n<p>打开安装的 maven 的 setting.xml</p>\n</li>\n<li>\n<p>修改仓库位置 - localRepository 标签 (改成自己想改的位置)</p>\n</li>\n<li>\n<p>在 mirrors 标签添加</p>\n</li>\n</ol>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>alimaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>aliyun maven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://maven.aliyun.com/nexus/content/repositories/central/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>repo1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>central repo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://repo1.maven.org/maven2/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>aliyunmaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>apache snapshots<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>阿里云阿帕奇仓库<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://maven.aliyun.com/repository/apache-snapshots<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><ol start=\"4\">\n<li>在 profiles 标签添加</li>\n</ol>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>profile</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repositories</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>aliyunmaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>aliyunmaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://maven.aliyun.com/repository/public<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>layout</span><span class=\"token punctuation\">></span></span>default<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>layout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>MavenCentral<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://repo1.maven.org/maven2/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>aliyunmavenApache<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://maven.aliyun.com/repository/apache-snapshots<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repositories</span><span class=\"token punctuation\">></span></span>             </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>profile</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure>",
            "tags": [
                "maven"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Jenkins%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/",
            "url": "https://obsidianlyg.github.io/Note/Jenkins%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/",
            "title": "Jenkins安装及使用",
            "date_published": "2022-04-30T04:54:43.000Z",
            "content_html": "<h1 id=\"jenkins安装及使用\"><a class=\"anchor\" href=\"#jenkins安装及使用\">#</a> Jenkins 安装及使用</h1>\n<p>ubuntuserver 安装步骤</p>\n<h2 id=\"前置要求\"><a class=\"anchor\" href=\"#前置要求\">#</a> 前置要求</h2>\n<h3 id=\"安装java和maven\"><a class=\"anchor\" href=\"#安装java和maven\">#</a> 安装 java 和 maven</h3>\n<h3 id=\"下载jenkins\"><a class=\"anchor\" href=\"#下载jenkins\">#</a> 下载 jenkins</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> -q -O - https://pkg.jenkins.io/debian/jenkins.io.key <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> apt-key <span class=\"token function\">add</span> -</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">sh</span> -c <span class=\"token string\">'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> jenkins</pre></td></tr></table></figure><h3 id=\"需要有jdk镜像\"><a class=\"anchor\" href=\"#需要有jdk镜像\">#</a> 需要有 jdk 镜像</h3>\n<p>构建最小 jdk 镜像</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamF2YS5jb20vZW4vZG93bmxvYWQvbWFudWFsLmpzcA==\">jre8 下载地址</span></p>\n<p>选择  Linux x64filesize</p>\n<p>解压文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -xzvf jre-8u181-linux-x64.tar.gz</pre></td></tr></table></figure><p>删除无用的文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> jre1.8.0_181/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rm</span> -rf COPYRIGHT LICENSE README release THIRDPARTYLICENSEREADME-JAVAFX.txt THIRDPARTYLICENSEREADME.txt Welcome.html</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rm</span> -rf  lib/plugin.jar <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        lib/ext/jfxrt.jar <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        bin/javaws <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        lib/javaws.jar <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        lib/desktop <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        plugin <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        lib/deploy* <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        lib/*javafx* <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        lib/*jfx* <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        lib/amd64/libdecora_sse.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        lib/amd64/libprism_*.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        lib/amd64/libfxplugins.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        lib/amd64/libglass.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        lib/amd64/libgstreamer-lite.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        lib/amd64/libjavafx*.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        lib/amd64/libjfx*.so</pre></td></tr></table></figure><p>重新打包</p>\n<p><code>tar zcvf jre8.tar.gz *</code></p>\n<p>新建 Dockerfile</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># using alpine-glibc instead of alpine  is mainly because JDK relies on glibc</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>FROM docker.io/jeanblanchard/alpine-glibc</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># author</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>MAINTAINER simon</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># A streamlined jre</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ADD jre8.tar.gz /usr/java/jdk/</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># set env</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>ENV JAVA_HOME /usr/java/jdk</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ENV <span class=\"token environment constant\">PATH</span> <span class=\"token variable\">$&#123;<span class=\"token environment constant\">PATH</span>&#125;</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$&#123;JAVA_HOME&#125;</span>/bin</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># run container with base path:/opt</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>WORKDIR /opt</pre></td></tr></table></figure><p>构建 docker 镜像 (Dockerfile 与压缩包在同一目录下)</p>\n<p><code>docker build -t jdk8 .</code></p>\n<p>java 中 pom 文件修改，指定 jdk8 镜像</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.spotify<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>docker-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.0.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>imageName</span><span class=\"token punctuation\">></span></span>ibase/$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>imageName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">&lt;!--&lt;dockerDirectory>src/main/docker&lt;/dockerDirectory>--></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>forceTags</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>forceTags</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>baseImage</span><span class=\"token punctuation\">></span></span>jdk8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>baseImage</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>entryPoint</span><span class=\"token punctuation\">></span></span>[\"java\",\"-jar\",\"/$&#123;project.build.finalName&#125;.jar\"]<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>entryPoint</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>targetPath</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>targetPath</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>directory</span><span class=\"token punctuation\">></span></span>$&#123;project.build.directory&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>directory</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>include</span><span class=\"token punctuation\">></span></span>$&#123;project.build.finalName&#125;.jar<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>include</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>另一种写法 (这是我用过的)</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>build</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>finalName</span><span class=\"token punctuation\">></span></span>lwapp-config<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>finalName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugins</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-boot-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.spotify<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>docker-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.2.2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    <span class=\"token comment\">&lt;!-- 安装 docker 的主机的地址 --></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>imageName</span><span class=\"token punctuation\">></span></span>192.168.98.205:5092/$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>imageName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>baseImage</span><span class=\"token punctuation\">></span></span>jdk8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>baseImage</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>entryPoint</span><span class=\"token punctuation\">></span></span>[\"java\",\"-jar\",\"/$&#123;project.build.finalName&#125;.jar\"]<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>entryPoint</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    <span class=\"token comment\">&lt;!--&lt;dockerCertPath>/etc/ca/docker-ca&lt;/dockerCertPath>--></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>targetPath</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>targetPath</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>directory</span><span class=\"token punctuation\">></span></span>$&#123;project.build.directory&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>directory</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>include</span><span class=\"token punctuation\">></span></span>$&#123;project.build.finalName&#125;.jar<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>include</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    <span class=\"token comment\">&lt;!-- 安装 docker 的主机的地址 --></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dockerHost</span><span class=\"token punctuation\">></span></span>http://192.168.98.205:2375<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dockerHost</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugins</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>build</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"安装私有docker仓库\"><a class=\"anchor\" href=\"#安装私有docker仓库\">#</a> 安装私有 docker 仓库</h3>\n<p><code>docker run -di --name=myregistry -p 5092:5000 registry</code></p>\n<p>尝试访问 registry 容器 ：<span class=\"exturl\" data-url=\"aHR0cDovLzEwLjYyLjE3LjEwMToxMDA5Mi92Mi9fY2F0YWxvZw==\">http://10.62.17.101:10092/v2/_catalog</span></p>\n<p>想要上传还需要 docker 开放 2375 端口</p>\n<p><code>vi /usr/lib/systemd/system/docker.service</code></p>\n<p>进入后修改</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 注释掉或删除这句话</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/bin/dockerd -H fd:// --containerd<span class=\"token operator\">=</span>/run/containerd/containerd.sock</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 加入下面这句</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock -H fd:// --containerd<span class=\"token operator\">=</span>/run/containerd/containerd.sock</pre></td></tr></table></figure><h3 id=\"让虚拟机识别到更改的仓库\"><a class=\"anchor\" href=\"#让虚拟机识别到更改的仓库\">#</a> 让虚拟机识别到更改的仓库</h3>\n<p>在 /etc/docker/daemon.json 添加</p>\n<p><code>&quot;insecure-registries&quot;:[&quot;192.168.98.205:5092&quot;]</code></p>\n<p>重新加载 docker 和 daemon</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl daemon-reload</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl restart docker</pre></td></tr></table></figure><p>修改要上传的标签并上传</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker tag jdk8 <span class=\"token number\">192.168</span>.98.205:5092/jdk8</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docker push <span class=\"token number\">192.168</span>.98.205:5092/jdk8</pre></td></tr></table></figure><h3 id=\"可选项安装gogs\"><a class=\"anchor\" href=\"#可选项安装gogs\">#</a> (可选项) 安装 gogs</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker run -d -p <span class=\"token number\">20022</span>:22 -p <span class=\"token number\">23000</span>:3000 -v /root/gogs_data:/data gogs/gogs</pre></td></tr></table></figure><p>注：将自己的代码上传到 gogs 或者其他的 git 仓库中，Jenkins 会根据这个仓库地址的代码进行生成镜像</p>\n<h2 id=\"jenkins的使用\"><a class=\"anchor\" href=\"#jenkins的使用\">#</a> Jenkins 的使用</h2>\n<ol>\n<li>安装好后 Jenkins 默认启动了 8080 端口，输入网址进入需要输入密钥</li>\n</ol>\n<p>密钥可以使用  <code>systemctl status jenkins</code>  查看</p>\n<p>或者  <code>cat /var/lib/jenkins/secrets/initialAdminPassword</code></p>\n<ol start=\"2\">\n<li>进入后会有两个选项可以不用选直接点击右上角关闭</li>\n<li>主界面侧边栏找到系统管理</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGTcC.png\" alt=\"image-20220430125903251\" /></p>\n<ol>\n<li>\n<p>点击插件管理<img data-src=\"https://i.imgtg.com/2023/06/19/OTGWOL.png\" alt=\"image-20220430125956038\" /></p>\n</li>\n<li>\n<p>选择可选插件搜索想要的插件选中后点击 install（安装 Git plugin 和 Maven Integration plugin）</p>\n</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGbNi.png\" alt=\"image-20220430130423000\" /></p>\n<ol start=\"6\">\n<li>退出插件管理进入全局工具配置</li>\n<li>配置 maven 的 setting 文件的路径和 jdk 的路径 (jdk 可以不用改使用默认的)，配置完成点击保存即可</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGkLX.png\" alt=\"image-20220430130900088\" /></p>\n<ol start=\"8\">\n<li>返回主页点击新建任务，输入名称选择 - 构建一个 maven 项目，点击确定</li>\n<li>源码管理选择 Git，输入之前上传仓库的 clone 地址</li>\n<li>(之前的都不用动) Build 的 RootPom 选择 git 仓库中的位置。(在表面则不用改，文件夹内部则为：文件夹名 /pom.xml)</li>\n<li>Goals and options 根据需求填写，一般为  <code>clean package docker:build -DpushImage</code></li>\n<li>点击保存后返回主界面点击三角开关即可，成功则显示绿色√，否则为红色 ×</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGxut.png\" alt=\"image-20220430131609017\" /></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/redis%E5%85%A5%E9%97%A8/",
            "url": "https://obsidianlyg.github.io/Note/redis%E5%85%A5%E9%97%A8/",
            "title": "redis入门",
            "date_published": "2022-02-02T09:15:12.000Z",
            "content_html": "<h2 id=\"redis测试\"><a class=\"anchor\" href=\"#redis测试\">#</a> redis 测试</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 测试： 100 个并发连接  100000 请求</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>redis-benchmark -h localhost -p <span class=\"token number\">6379</span> -c <span class=\"token number\">100</span> -n <span class=\"token number\">100000</span></pre></td></tr></table></figure><h2 id=\"五大数据类型\"><a class=\"anchor\" href=\"#五大数据类型\">#</a> 五大数据类型</h2>\n<blockquote>\n<p><strong>redis</strong> 是<strong>单线程</strong>的，可以用作<strong>数据库</strong>，<strong>缓存</strong>和<strong>消息中间件 MQ</strong></p>\n</blockquote>\n<p>官方表示：redis 是基于内存操作的，CPU 不是 redis 性能瓶颈，redis 的瓶颈是根据机器的内存和网络带宽，既然可以使用单线程来实现，就使用单线程了！</p>\n<p>为什么默认端口是 6379：粉丝效应</p>\n<p>redis 默认有 16 个数据库，默认使用的是第 0 个数据库</p>\n<p>可以使用 select 进行切换</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcw==\">官方文档</span></p>\n<h3 id=\"redis-key\"><a class=\"anchor\" href=\"#redis-key\">#</a> Redis-key</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root<span class=\"token punctuation\">[</span>/usr/local/bin<span class=\"token punctuation\">]</span>: redis-cli -p <span class=\"token number\">6379</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token keyword\">select</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> DBSIZE <span class=\"token comment\">#查看 DB 大小</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> keys * <span class=\"token comment\">#查看所有的 key</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>flushdb <span class=\"token comment\">#清除当前数据库</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>flushall <span class=\"token comment\">#清空所有数据库</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>EXISTS age <span class=\"token comment\">#判断 age 键是否存在，有为 1，否则为 0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> exists age1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> move age <span class=\"token number\">1</span> <span class=\"token comment\">#移除 age , 1 代表当前数据库</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span>expire age <span class=\"token number\">10</span> <span class=\"token comment\"># 10 秒后过期</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span>ttl age <span class=\"token comment\">#还剩多少时间过期</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span>type age <span class=\"token comment\">#查看当前数据类型</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>string</pre></td></tr></table></figure><h3 id=\"string字符串\"><a class=\"anchor\" href=\"#string字符串\">#</a> String（字符串）</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> key1 v1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> append key1 hell  <span class=\"token comment\"># 存在则追加，不存在则新建</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get key1</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token string\">\"v1hell\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> strlen key1 <span class=\"token comment\"># 获取字符串的长度</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">6</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> views <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> incr views  <span class=\"token comment\"># 自动加 1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> decr views <span class=\"token comment\"># 自动减 1</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> incrby views <span class=\"token number\">10</span> <span class=\"token comment\"># 增加指定数值 同理 decrby</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">11</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 字符串范围 range</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> key1 <span class=\"token string\">\"hello,kuangshen\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> GETRANGE key1 <span class=\"token number\">0</span> <span class=\"token number\">3</span>  <span class=\"token comment\"># 截取 [0,3]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token string\">\"hell\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> GETRANGE key1 <span class=\"token number\">0</span> -1  <span class=\"token comment\"># 取所有</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token string\">\"hello,kuangshen\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 替换</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SETRANGE key2 <span class=\"token number\">1</span> xx <span class=\"token comment\"># 从 1 开始替换字符串</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">7</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> GETRANGE key2 <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token string\">\"axxdefg\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># setex (set with expire) # 设置过期时间</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># setnx (set if not exist) # 不存在设置 （在分布式锁中会常用）</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setex key3 <span class=\"token number\">30</span> <span class=\"token string\">\"sds\"</span> <span class=\"token comment\"># key3 30 秒存在时间</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ttl key3</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">26</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setnx mykey <span class=\"token string\">\"hello\"</span> <span class=\"token comment\"># 设置成功返回 1 否则返回 0 如果不存在则创建，如果存在就创建失败</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setnx mykey <span class=\"token string\">\"Mongo\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get mykey</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># 同时设置（获取）多个键值对</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>mset</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>mget</pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mset k1 v1 k2 v2 k3 v3</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> keys *</pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k1\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mget k1 k2 k3</pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v1\"</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v2\"</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v3\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>同样的 msetnx msetex 同理（原子性操作，要么一起成功要么一起失败）</pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\"># 关于对象</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token builtin class-name\">set</span> user:1 <span class=\"token punctuation\">&#123;</span>name:zhangsan, age:3<span class=\"token punctuation\">&#125;</span> <span class=\"token comment\"># 这是一个 user:1 对象 值为 json 字符来保存对象！</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\"># 这里 key 的设计: user:&#123;id&#125;:&#123;filed&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\"># 冒号：代表一个层级，方便查看和管理</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mset user:1:name zhangsan user:1:age <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mget user:1:name user:1:age</pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"zhangsan\"</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"2\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>getset <span class=\"token comment\"># 先 get 再 set</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getset db redis  <span class=\"token comment\"># 如果不存在返回 nil 并创建</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get db</pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token string\">\"redis\"</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getset db mongodb <span class=\"token comment\"># 如果存在则返回当前值，并修改</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token string\">\"redis\"</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get db</pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token string\">\"mongodb\"</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr></table></figure><p>数据结构是想通的！</p>\n<p>String 类型使用场景：value 除了是字符串还可以是数字</p>\n<ul>\n<li>计数器</li>\n<li>统计多单位数量</li>\n<li>粉丝数</li>\n<li>对象缓存存储</li>\n</ul>\n<h3 id=\"list列表\"><a class=\"anchor\" href=\"#list列表\">#</a> List（列表）</h3>\n<p>在 redis 的 list 中，可以做成栈，队列，阻塞队列！redis 不区分大小写命令</p>\n<p>list 内部可以存在重复值</p>\n<p>注：只有 push 和 pop 才分左右，其余前置 l 均为 list 的意思</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LPUSH list one  <span class=\"token comment\"># lpush 中的 l 指的是 left，从左边插入，同理有 rpush，相当于压栈</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LPUSH list teo</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LPUSH list three</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LRANGE list <span class=\"token number\">0</span> -1 <span class=\"token comment\"># 查所有， 都是从零开始计算的</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"teo\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LRANGE list <span class=\"token number\">0</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"teo\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>移除命令，同理有lpop和rpop</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>获取下标值index，也是分lindex和rindex</pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"teo\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"four\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lindex list <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>获取list长度，llen</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> llen list</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>移除指定的值</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>lrem  （list remove）</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>因为list内部可以存在重复值，所以出现lrem key count value</pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> lrem list <span class=\"token number\">1</span> one</pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>只保留一部分值</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>ltrim</pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello3\"</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ltrim mylist <span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token comment\"># 通过下标截取指定长度</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>rpoplpush <span class=\"token comment\"># 移除列表最后一个元素，并添加到新的列表中</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>rpoplpush <span class=\"token builtin class-name\">source</span> destination</pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> rpoplpush mylist myotherlist</pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange myotherlist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>lset 更新元素（前提:该元素存在，否则会报错）</pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lpush list value1</pre></td></tr><tr><td data-num=\"84\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lset list <span class=\"token number\">0</span> item <span class=\"token comment\"># 更新元素</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"89\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"90\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"item\"</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>linsert 从列表中具体的值前面（或后面）插入值</pre></td></tr><tr><td data-num=\"94\"></td><td><pre>linsert key before<span class=\"token operator\">|</span>after pivot value</pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"96\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"item\"</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> linsert list before item before</pre></td></tr><tr><td data-num=\"99\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"101\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"before\"</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"item\"</span></pre></td></tr></table></figure><blockquote>\n<p>小结</p>\n</blockquote>\n<ul>\n<li>实际上是一个链表</li>\n<li>key 不存在就创建，存在则新增</li>\n<li>如果移除了所有值，也就是空链表，则代表不存在</li>\n<li>在两边插入或改值时，效率最高，中间元素效率会低一点。</li>\n</ul>\n<h3 id=\"set集合\"><a class=\"anchor\" href=\"#set集合\">#</a> Set（集合）</h3>\n<p>set 是一个无序不重复集合</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd myset lovekuangshen <span class=\"token comment\"># 建立集合，增加值</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> smembers myset  <span class=\"token comment\"># 查看集合内容</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"lovekuangshen\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sismember myset hello <span class=\"token comment\"># 判断 hello 是否存在于 myset 中</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> scard myset <span class=\"token comment\"># 查看集合中元素的个数</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>srem key value <span class=\"token comment\"># 移除集合中的元素</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>SRANDMEMBER key <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">]</span> 随机筛选元素，默认筛选个数为1</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>随机删除key，指定删除key</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>spop随机移除元素</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>将一个指定的值移动到另外一个set中</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>smove <span class=\"token builtin class-name\">source</span> destination member</pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> smove myset myset2 hello</pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SMEMBERS myset</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"lovekuangshen\"</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SMEMBERS myset2</pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"set2\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>微博，B站，共同关注！（并集）</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>数字集合类：</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>- 差集</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>- 交集</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>- 并集</pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd <span class=\"token builtin class-name\">set</span> a</pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd <span class=\"token builtin class-name\">set</span> b</pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd <span class=\"token builtin class-name\">set</span> c</pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd set2 c</pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd set2 d</pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd set2 e</pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SDIFF <span class=\"token builtin class-name\">set</span> set2 <span class=\"token comment\"># 找不同，也就是差集</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"a\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"b\"</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SINTER <span class=\"token builtin class-name\">set</span> set2 <span class=\"token comment\"># 交集 可以实现共同好友</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"c\"</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SUNION <span class=\"token builtin class-name\">set</span> set2 <span class=\"token comment\"># 并集</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"a\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"c\"</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"b\"</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"e\"</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"d\"</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr></table></figure><p>微博，A 用户将所有关注的人放在一个 set 集合中！将它的粉丝也放在一个集合中！<br />\n 共同关注，共同爱好，二度好友，推荐好友！(六度分割理论)</p>\n<h3 id=\"hash哈希\"><a class=\"anchor\" href=\"#hash哈希\">#</a> Hash（哈希）</h3>\n<p>map 集合，key-map</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hset <span class=\"token builtin class-name\">hash</span> filed1 kuangshen  <span class=\"token comment\"># 设置值</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hget <span class=\"token builtin class-name\">hash</span> filed1 <span class=\"token comment\"># 获取值</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hmset <span class=\"token builtin class-name\">hash</span> filed2 k2 filed3 k3 filed4 k4 <span class=\"token comment\"># 同时设置多个值</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hmget <span class=\"token builtin class-name\">hash</span> filed1 filed2 filed3 <span class=\"token comment\"># 同时获取多个值</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hgetall <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取全部数据</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed1\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed2\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed3\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token number\">7</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed4\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k4\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hdel <span class=\"token builtin class-name\">hash</span> filed1 <span class=\"token comment\"># 删除指定字段</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hgetall <span class=\"token builtin class-name\">hash</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed2\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed3\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed4\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k4\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hlen <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取长度</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre> HEXISTS <span class=\"token builtin class-name\">hash</span> filed2 <span class=\"token comment\"># 判断元素是否存在</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre> <span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre> <span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hkeys <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取所有 key</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed2\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed3\"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed4\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hvals <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取所有值</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k4\"</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre> HINCRBY <span class=\"token builtin class-name\">hash</span> f1 <span class=\"token number\">1</span> <span class=\"token comment\"># f1 自增 1 HINCRBY hash f1 -1 相当于自减</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre> <span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hsetnx <span class=\"token builtin class-name\">hash</span> f1 <span class=\"token number\">5</span> <span class=\"token comment\"># 如果不存在则可以设置，存在则不行</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hsetnx <span class=\"token builtin class-name\">hash</span> f2 <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p>hash 存变更数据 user name age，尤其是用户信息之类的，经常变动的信息，hash 更适合于对象的存储，String 更适合字符串的存储！</p>\n<h3 id=\"zset有序集合\"><a class=\"anchor\" href=\"#zset有序集合\">#</a> zset（有序集合）</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zadd myset <span class=\"token number\">1</span> one <span class=\"token number\">2</span> two <span class=\"token number\">3</span> three <span class=\"token comment\"># 添加三个值，数字是排序标志</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange myset <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zadd salary <span class=\"token number\">2500</span> xiaohong <span class=\"token number\">5000</span> zhangsan <span class=\"token number\">500</span> kuangshen</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>排序</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># ZRANGEBYSCORE key min max withscores (选填，附带成绩等排序标志)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZRANGEBYSCORE myset <span class=\"token punctuation\">(</span>-1 <span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token comment\"># (后两个是区间，有括号表示不包含该数字)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZRANGEBYSCORE salary -inf +inf <span class=\"token comment\"># 全部用户从小到大排序 (范围)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xiaohong\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"zhangsan\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZREVRANGE myset <span class=\"token number\">0</span> -1 <span class=\"token comment\"># 从大到小排列</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZRANGEBYSCORE salary -inf <span class=\"token number\">2500</span> withscores <span class=\"token comment\"># 2500 以内</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"500\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xiaohong\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"2500\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>zrem 移除元素</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrem salary xiaohong</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange salary <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"zhangsan\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>zcard key 查看元素个数</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>zcount key min max 统计区间值的个数</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zcount myset <span class=\"token number\">1</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr></table></figure><p>案例思路： set 排序，存储班级成绩表，工资排序表，排行榜</p>\n<p>普通消息， 1， 重要消息， 2， 带权重进行判断！</p>\n<h2 id=\"三种特殊数据类型\"><a class=\"anchor\" href=\"#三种特殊数据类型\">#</a> 三种特殊数据类型</h2>\n<h3 id=\"geospatial地理位置\"><a class=\"anchor\" href=\"#geospatial地理位置\">#</a> geospatial（地理位置）</h3>\n<p>朋友定位，附近的人，打车距离计算</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9qaW5nd2VpZHUuYm1jeC5jb20v\">经纬度查询 (获取测试数据)</span></p>\n<blockquote>\n<p>geoadd (添加地理位置)</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 规则：地球两极无法添加， 一般直接通过 java 程序一次性导入</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>geoadd key 经度 纬度 名字</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd china:city <span class=\"token number\">116.23128</span> <span class=\"token number\">40.22077</span> beijing</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd china:city <span class=\"token number\">121</span> <span class=\"token number\">31</span> shanghai</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd china:city <span class=\"token number\">106</span> <span class=\"token number\">29</span> chongqing</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><blockquote>\n<p>geopos (获取)</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geopos china:city xian</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"108.00000160932540894\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"34.00000062127011091\"</span></pre></td></tr></table></figure><blockquote>\n<p>geodist (获取两点距离)</p>\n</blockquote>\n<p>单位：</p>\n<ul>\n<li><strong>m</strong> for meters.</li>\n<li><strong>km</strong> for kilometers.</li>\n<li><strong>mi</strong> for miles.</li>\n<li><strong>ft</strong> for feet.</li>\n</ul>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geodist china:city beijing chongqing</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">\"1557966.1279\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geodist china:city beijing chongqing km</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token string\">\"1557.9661\"</span></pre></td></tr></table></figure><blockquote>\n<p>georadius</p>\n</blockquote>\n<p>附近的人 (获取所有附近的人的地址，定位！)</p>\n<p>georadius 经度 纬度 半径 单位</p>\n<p>withcoord 显示他人的定位信息</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shenzhen\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hangzhou\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km count <span class=\"token number\">2</span> <span class=\"token comment\"># 限制显示的数量</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km withdist<span class=\"token comment\"># 显示到 (110,30) 中心的距离</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"402.8557\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"483.2155\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km withcoord</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"106.00000172853469849\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"28.99999952347345555\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"108.00000160932540894\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"34.00000062127011091\"</span></pre></td></tr></table></figure><blockquote>\n<p>georadiusbymember</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 找出位于指定元素周围的其他元素</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadiusbymember china:city chongqing <span class=\"token number\">1000</span> km</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr></table></figure><blockquote>\n<p>geohash - 返回一个或多个位置元素的个 geohash 表示</p>\n</blockquote>\n<p>该命令返回 11 个字符的 geohash 字符串</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 将二维的经纬度转换成一维的字符串，，如果两个字符串越接近，那么距离越近。</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geohash china:city beijing chongqing</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"wx4sucvncn0\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"wm5kup6c5p0\"</span></pre></td></tr></table></figure><blockquote>\n<p>geo 底层实现原理就是 zset，可以使用 zset 命令操作 geo！</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange china:city <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shenzhen\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hangzhou\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shanghai\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"beijing\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrem china:city hangzhou <span class=\"token comment\"># 移除 geo 建立的元素</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange china:city <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shenzhen\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shanghai\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"beijing\"</span></pre></td></tr></table></figure><h3 id=\"hyperloglog\"><a class=\"anchor\" href=\"#hyperloglog\">#</a> Hyperloglog</h3>\n<p>基数（一个集合中不重复的元素）</p>\n<blockquote>\n<p>简介：用于做基数统计的算法</p>\n</blockquote>\n<p>优点：占用内存固定， 2^64 个不同的元素的基数，只需要废 12KB 的内存，从内存角度看 Hyperloglog 是首选</p>\n<p>0.81% 错误率！统计 UV 任务是可以忽略不计的。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> pfadd mykey a b c d e f g h i j <span class=\"token comment\"># 添加</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFCount mykey <span class=\"token comment\"># 计数，统计基数数量</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFCOUNT mykey2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">9</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFMERGE mykey3 mykey mykey2 <span class=\"token comment\"># 合并</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFCOUNT mykey3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">15</span></pre></td></tr></table></figure><p>允许容错，一定可以使用 Hyperloglog</p>\n<p>不允许容错，就使用 set 或者自己的数据类型即可</p>\n<h3 id=\"bitmaps\"><a class=\"anchor\" href=\"#bitmaps\">#</a> Bitmaps</h3>\n<blockquote>\n<p>按位存储</p>\n</blockquote>\n<p>统计疫情感染人数：000000110101010</p>\n<p>统计用户信息：活跃，不活跃！登录，未登录！365 打卡！两个状态的都可以使用 bitmaps</p>\n<p>Bitmaps 位图，数据结构！都是操作二进制位来进行记录的，只有 0 和 1 两种状态</p>\n<blockquote>\n<p>测试</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token comment\"># 设置七天的打卡状态，0-6 > 周一到周天</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">1</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">2</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">3</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">4</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">5</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">6</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getbit sign <span class=\"token number\">3</span> <span class=\"token comment\"># 确认周四有没有打卡</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 统计的操作，统计打卡天数，默认全部</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> bitcount sign</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr></table></figure><h2 id=\"redis的事务\"><a class=\"anchor\" href=\"#redis的事务\">#</a> redis 的事务</h2>\n<p><mark>redis 的单条命令可以保证原子性（要么同时成功，要么同时失败），但是 redis 的事务不行</mark></p>\n<p>redis 事务本质：一组命令的集合。一个事务中的所有命令都会被序列化，在事务的执行过程中，会按照顺序执行。</p>\n<p>一次性，顺序性，排他性。执行一系列的命令！</p>\n<p><mark>redis 事务没有隔离级别的概念</mark></p>\n<p>所有命令在事务中，并没有被直接执行！只有发起执行命令的时候才会执行！</p>\n<p>redis 事务：</p>\n<ul>\n<li>开启事务（multi）</li>\n<li>命令入队（......）</li>\n<li>执行事务（exec）</li>\n</ul>\n<blockquote>\n<p>正常执行事务</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi <span class=\"token comment\"># 开启事务</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 v1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k2 v2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k2</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k3 v3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span> <span class=\"token comment\"># 执行事务</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v2\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> OK</pre></td></tr></table></figure><blockquote>\n<p>放弃事务</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 v1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k2 v2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k4 v4</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> DISCARD <span class=\"token comment\"># 取消事务</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k4 <span class=\"token comment\"># 事务中队列的命令都不会被执行</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>编译型异常（代码有问题，命令有错），事务中所有的命令都不会被执行</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 v1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k3 v3</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getset k3</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> ERR wrong number of arguments <span class=\"token keyword\">for</span> <span class=\"token string\">'getset'</span> <span class=\"token builtin class-name\">command</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> EXECABORT Transaction discarded because of previous errors.</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k1</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>运行时异常（例如：1/0），如果事务队列中存在语法性错误，那么执行命令的时候，其他命令是可以正常执行的。错误命令会抛出异常。</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 <span class=\"token string\">\"v1\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> incr k</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k2 v2</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k3 v3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k3</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span> <span class=\"token comment\"># 虽然第一条错了，但是后面仍然执行成功</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> ERR value is not an integer or out of range</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v3\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k2</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token string\">\"v2\"</span></pre></td></tr></table></figure><blockquote>\n<p>监控 watch</p>\n</blockquote>\n<p>悲观锁：</p>\n<ul>\n<li>很悲观，认为什么时候都会出现问题，无论做什么都会加锁！</li>\n</ul>\n<p>乐观锁：</p>\n<ul>\n<li>很乐观，认为什么时候都不会出现问题，所以不会上锁！更新数据的时候去判断一下，在此期间是否有人修改过这个数据。</li>\n<li>获取 version，更新的时候去比较 version</li>\n</ul>\n<blockquote>\n<p>监视测试</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> money <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> out <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token function\">watch</span> money  <span class=\"token comment\"># 监视 money 对象</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi <span class=\"token comment\"># 事务正常结束，数据期间没有发生变动，这个时候正常执行成功！(一旦事务执行后，监视会自动取消)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> DECRBY money <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> INCRBY out <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">80</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">20</span></pre></td></tr></table></figure><p>测试多线程修改值，使用 watch 相当于 redis 的乐观锁操作</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> WATCH money</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> DECRBY money <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> INCRBY out <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span> <span class=\"token comment\"># 执行之前。另外一个线程修改了这个值，这个时候，会导致事务执行失败！（无论失败成功 exec 都会自动解锁）</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> unwatch <span class=\"token comment\"># 停止监视，之后再重新监视执行</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token function\">watch</span> money</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>OK</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E6%B5%8B%E8%AF%95/",
            "url": "https://obsidianlyg.github.io/Note/%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E6%B5%8B%E8%AF%95/",
            "title": "移动应用测试",
            "date_published": "2022-01-20T16:14:39.000Z",
            "content_html": "<h1 id=\"移动应用测试\"><a class=\"anchor\" href=\"#移动应用测试\">#</a> 移动应用测试</h1>\n<h2 id=\"查看包名\"><a class=\"anchor\" href=\"#查看包名\">#</a> 查看包名：</h2>\n<ul>\n<li>\n<p>方案一：如果你应用已经安装在手机上了，可以直接打开手机上该应用，进入到你要操作的界面，然后执行 (<strong>注：一定要用 cmd 运行，powershell 会报参数不正确</strong>):</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb shell dumpsys activity recents <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"intent=&#123;\"</span></pre></td></tr></table></figure><p>会出现如下信息：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.<span class=\"token environment constant\">HOME</span><span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10000000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.launcher3/.Launcher<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10000000 <span class=\"token assign-left variable\">pkg</span><span class=\"token operator\">=</span>tv.danmaku.bili <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>tv.danmaku.bili/.MainActivityV2<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.flysilkworm/.app.activity.FrameworkActivity<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10800000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>io.appium.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>C:<span class=\"token punctuation\">\\</span>WINDOWS<span class=\"token punctuation\">\\</span>System3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>adb shell dumpsys activity recents <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"intent=&#123;\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>tv.danmaku.bili/.MainActivityV2<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.<span class=\"token environment constant\">HOME</span><span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10000000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.launcher3/.Launcher<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.flysilkworm/.app.activity.FrameworkActivity<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10800000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>io.appium.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>其中 cmp=tv.danmaku.bili/.MainActivityV2 就是 / 之前是包名（appPackage），之后是 appActivity</p>\n</li>\n<li>\n<p>方案二：如果是已有 apk 在电脑上</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>aapt dump badging D:<span class=\"token punctuation\">\\</span>Desktop<span class=\"token punctuation\">\\</span>软测<span class=\"token punctuation\">\\</span>iBiliPlayer-bili.apk <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"package\"</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>aapt dump badging D<span class=\"token punctuation\">:</span>\\Desktop\\软测\\iBiliPlayer<span class=\"token operator\">-</span>bili<span class=\"token punctuation\">.</span>apk <span class=\"token operator\">|</span> find <span class=\"token string\">\"launchable-activity\"</span></pre></td></tr></table></figure><p>会出现如下信息：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>、</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>C:<span class=\"token punctuation\">\\</span>WINDOWS<span class=\"token punctuation\">\\</span>System3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>aapt dump badging D:<span class=\"token punctuation\">\\</span>Desktop<span class=\"token punctuation\">\\</span>软测<span class=\"token punctuation\">\\</span>iBiliPlayer-bili.apk <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"package\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>package: <span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span><span class=\"token string\">'tv.danmaku.bili'</span> <span class=\"token assign-left variable\">versionCode</span><span class=\"token operator\">=</span><span class=\"token string\">'6430500'</span> <span class=\"token assign-left variable\">versionName</span><span class=\"token operator\">=</span><span class=\"token string\">'6.43.0'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span>、 </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>C:<span class=\"token punctuation\">\\</span>WINDOWS<span class=\"token punctuation\">\\</span>System3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>aapt dump badging D:<span class=\"token punctuation\">\\</span>Desktop<span class=\"token punctuation\">\\</span>软测<span class=\"token punctuation\">\\</span>iBiliPlayer-bili.apk <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"launchable-activity\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>launchable-activity: <span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span><span class=\"token string\">'tv.danmaku.bili.MainActivityV2'</span>  <span class=\"token assign-left variable\">label</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">icon</span><span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr></table></figure><p>1、的 name 是包名，2、的 name 是 appActivity（tv.danmaku.bili.MainActivityV2，</p>\n<p>可以省略 tv.danmaku.bili）</p>\n</li>\n<li>\n<p>方案三：算是方案一的进阶吧 (推荐)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb shell dumpsys window w <span class=\"token operator\">|</span>findstr <span class=\"token punctuation\">\\</span>/ <span class=\"token operator\">|</span>findstr <span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 或者</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>adb shell dumpsys activity activities <span class=\"token operator\">|</span> findstr mFocusedActivity</pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"在ui-automator-viewerbat中运行一次python就连不上的问题\"><a class=\"anchor\" href=\"#在ui-automator-viewerbat中运行一次python就连不上的问题\">#</a> 在 UI Automator Viewer.bat 中运行一次 Python 就连不上的问题：</h2>\n<p><strong>特别提示：如果按照 Python 模板写，按 q 退出可以避免连不上的问题，相关代码如下</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>q <span class=\"token operator\">=</span> input<span class=\"token punctuation\">(</span><span class=\"token string\">'input q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    driver.quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>方案一：重启模拟器</p>\n<p>方案二：重启 adb（推荐方案二，因为方案一很慢 (￣_￣|||)）</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb kill-server <span class=\"token operator\">&amp;</span> adb start-server</pre></td></tr></table></figure><p>方案三：appium 重连（原因：运行后 appium 占用指定端口与本身需要的端口冲突导致）</p>\n<h2 id=\"python中测试基本语法\"><a class=\"anchor\" href=\"#python中测试基本语法\">#</a> <strong>Python 中测试基本语法</strong>：</h2>\n<p>参考语法文档：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5ieWh5Lm5ldC90dXQvYXV0by9hcHBpdW0vMDIv\">http://www.byhy.net/tut/auto/appium/02/</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 根据 id</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_elements_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"android:id/button2\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#既可以找多个元素也可以找单个元素</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 点击事件</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"cn.xuexi.android:id/comm_head_xuexi_score\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># tap 点按（bounds 属性，停留的时间）</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>driver<span class=\"token punctuation\">.</span>tap<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token number\">850</span><span class=\"token punctuation\">,</span><span class=\"token number\">1080</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 发送文字事件（resource-id）</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>sbox <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'search_src_text'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sbox<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'Doyoudo'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 根据 class 元素</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_elements_by_class_name<span class=\"token punctuation\">(</span><span class=\"token string\">'android.widget.TextView'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 根据 ACCESSIBILITY ID（content-desc 属性）</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_accessibility_id<span class=\"token punctuation\">(</span><span class=\"token string\">'找人'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 根据 Xpath</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//ele1/ele2[@attr=\"value\"]'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 模拟滑动</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>driver<span class=\"token punctuation\">.</span>swipe<span class=\"token punctuation\">(</span>start_x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">,</span> start_y<span class=\"token operator\">=</span>y1<span class=\"token punctuation\">,</span> end_x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">,</span> end_y<span class=\"token operator\">=</span>y2<span class=\"token punctuation\">,</span> duration<span class=\"token operator\">=</span><span class=\"token number\">800</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># 按键</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\"># 输入回车键，确定搜索</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\"># 返回</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>BACK<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># 隐式等待 设置缺省等待 10 秒时间（不推荐）</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>driver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># 强制等待 等 5 秒（推荐）</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\"># 显示等待 (有点多直接看链接吧)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>blog<span class=\"token punctuation\">.</span>csdn<span class=\"token punctuation\">.</span>net<span class=\"token operator\">/</span>sinat_41774836<span class=\"token operator\">/</span>article<span class=\"token operator\">/</span>details<span class=\"token operator\">/</span><span class=\"token number\">88965281</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\"># 打开通知栏，返回直接 BACK 键</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>driver<span class=\"token punctuation\">.</span>open_notifications<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\"># 截屏手机，并且下载到指定目录中</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>os<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">(</span><span class=\"token string\">'adb shell screencap /sdcard/screen3.png &amp;&amp; adb pull /sdcard/screen3.png'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><a href=\"https://blog.csdn.net/Asaasa1/article/details/109383652\"><strong>关于 TouchAction 类与 MultiAction 类的相关用法</strong></a> (九宫格解锁可以用 touchaction)</p>\n<p><strong>联合查询:</strong></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># xpath 方式： 可以联合 @resource-id 属性和 @text 文本属性来下定位</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">\"//*[@resource-id='com.taobao.taobao:id/tv_scan_text'][@text='扫一扫']\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 内嵌 Java 方式： 后面可以一直.name () 这种方式添加（调用 UI Automator API 的 java 代码，实现最为直接的自动化控制。）</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>code <span class=\"token operator\">=</span> <span class=\"token string\">'new UiSelector().text(\"追番\").resourceId(\"tv.danmaku.bili:id/tab_title\")'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_android_uiautomator<span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ele<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\"># 具体 java 代码 来自谷歌 Android 文档：</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>developer<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>training<span class=\"token operator\">/</span>testing<span class=\"token operator\">/</span>ui<span class=\"token operator\">-</span>automator</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">#常用列表</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        text<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 对应 text</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        resourceId<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 对应 resource-id</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        description<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 对应 content-desc</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        className<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 对应 class</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        index<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\"># 对应 index</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        instance<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># 是匹配的结果所有元素里面的第几个元素</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        textContains<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 根据文本包含什么字符串 (与 text 连用)</span></pre></td></tr></table></figure><p><strong>注：</strong></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_android_uiautomator<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">'new UiSelector(). className(\" android.widget. TextView\"). textContains(\"白月黑羽\").instance(4)'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>等同于下方代码</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>eles <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_elements_by_android_uiautomator<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token string\">'new UiSelector(). className(\"android.widget. TextView\"). textContains(\"白月黑羽\")'</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>eles<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"python基础模板python的第三方库appium-python-client\"><a class=\"anchor\" href=\"#python基础模板python的第三方库appium-python-client\">#</a> <strong>Python 基础模板</strong>（Python 的第三方库 appium-python-client）</h2>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> appium <span class=\"token keyword\">import</span> webdriver</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> appium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>extensions<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>nativekey <span class=\"token keyword\">import</span> AndroidKey</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>desired_caps <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string\">'platformName'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Android'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 被测手机是安卓</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">'platformVersion'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'5'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 手机安卓版本</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string\">'deviceName'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'HUAWEI'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 设备名，安卓手机可以随意填写</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'appPackage'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'tv.danmaku.bili'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 启动 APP Package 名称</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string\">'appActivity'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'.MainActivityV2'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 启动 Activity 名称</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token string\">'unicodeKeyboard'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 使用自带输入法，输入中文时填 True</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">'resetKeyboard'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 执行完程序恢复原来输入法</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">'noReset'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>       <span class=\"token comment\"># 不要重置 App</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token string\">'newCommandTimeout'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6000</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token string\">'automationName'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'UiAutomator2'</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\"># 'app': r'd:\\apk\\bili.apk',</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\"># 连接 Appium Server，初始化自动化环境</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    driver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Remote<span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:4723/wd/hub'</span><span class=\"token punctuation\">,</span> desired_caps<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\"># 设置缺省等待时间</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\"># 青少年保护</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    iknow <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_elements_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"text3\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">if</span> iknow<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        iknow<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"expand_search\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    sbox <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'search_src_text'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    sbox<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'Doyoudo'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    eles <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_elements_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">for</span> ele <span class=\"token keyword\">in</span> eles<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    ele<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    q <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        driver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> err<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'An exception happened: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    q <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        driver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"自定义python模板\"><a class=\"anchor\" href=\"#自定义python模板\">#</a> 自定义 Python 模板</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">import</span> <span class=\"token function\">time</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>from appium <span class=\"token function\">import</span> webdriver</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>from appium.webdriver.common.touch_action <span class=\"token function\">import</span> TouchAction</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>from appium.webdriver.extensions.android.nativekey <span class=\"token function\">import</span> AndroidKey</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>desired_caps <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'platformName'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'Android'</span>,</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string\">'platformVersion'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'7'</span>,</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token string\">'deviceName'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'HUAWEI'</span>,</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">'appPackage'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'tv.danmaku.bili'</span>,  <span class=\"token comment\"># adb shell dumpsys activity activities | findstr mFocusedActivity</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">'appActivity'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'.MainActivityV2'</span>,  <span class=\"token comment\"># 启动 Activity 名称</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token string\">'unicodeKeyboard'</span><span class=\"token builtin class-name\">:</span> True,</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token string\">'resetKeyboard'</span><span class=\"token builtin class-name\">:</span> True,</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token string\">'noReset'</span><span class=\"token builtin class-name\">:</span> True,</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token string\">'newCommandTimeout'</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">6000</span>,</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token string\">'automationName'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'UiAutomator2'</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>def id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_element_by_id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>def ids<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_elements_by_id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>def xpath<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_element_by_xpath<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>def xpaths<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_elements_by_xpath<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>def desc<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_element_by_accessibility_id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>def class_names<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_elements_by_class_name<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>def tap<span class=\"token punctuation\">(</span>a, b, c, d<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.tap<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>a, b<span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span>c, d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>, <span class=\"token number\">100</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>def back<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    driver.press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.BACK<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>def enter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    driver.press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>def move<span class=\"token punctuation\">(</span>x, y, m, n<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    driver.swipe<span class=\"token punctuation\">(</span>start_x<span class=\"token operator\">=</span>x, <span class=\"token assign-left variable\">start_y</span><span class=\"token operator\">=</span>y, <span class=\"token assign-left variable\">end_x</span><span class=\"token operator\">=</span>m, <span class=\"token assign-left variable\">end_y</span><span class=\"token operator\">=</span>n, <span class=\"token assign-left variable\">duration</span><span class=\"token operator\">=</span><span class=\"token number\">800</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>def long_press<span class=\"token punctuation\">(</span>el1, el2<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    action <span class=\"token operator\">=</span> TouchAction<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    action.long_press<span class=\"token punctuation\">(</span>el1<span class=\"token punctuation\">)</span>.move_to<span class=\"token punctuation\">(</span>el2<span class=\"token punctuation\">)</span>.release<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>try:</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    driver <span class=\"token operator\">=</span> webdriver.Remote<span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:4723/wd/hub'</span>, desired_caps<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    driver.implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    time.sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    q <span class=\"token operator\">=</span> input<span class=\"token punctuation\">(</span><span class=\"token string\">'input q to quit\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        driver.quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>except Exception as err:</pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    print<span class=\"token punctuation\">(</span><span class=\"token string\">'An exception happened: '</span> + str<span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">))</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    q <span class=\"token operator\">=</span> input<span class=\"token punctuation\">(</span><span class=\"token string\">'error q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        driver.quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"appium测试ui界面模板就是python中的desired_caps注这里内部必须都为双引号\"><a class=\"anchor\" href=\"#appium测试ui界面模板就是python中的desired_caps注这里内部必须都为双引号\">#</a> appium 测试 ui 界面模板 (就是 python 中的 desired_caps）<strong>注：这里内部必须都为双引号</strong></h2>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"platformName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Android\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\"platformVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"57\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"deviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"HUAWEI\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"appPackage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cn.xuexi.android\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"appActivity\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"com.alibaba.android.rimet.biz.SplashActivity\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token property\">\"unicodeKeyboard\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token property\">\"resetKeyboard\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token property\">\"noReset\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token property\">\"newCommandTimeout\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token property\">\"automationName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UiAutomator2\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"adb基本命令\"><a class=\"anchor\" href=\"#adb基本命令\">#</a> adb 基本命令</h2>\n<ul>\n<li>\n<p><strong>先附上参考文档：</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cud2FuYW5kcm9pZC5jb20vYmxvZy9zaG93LzIzMTA=\">https://www.wanandroid.com/blog/show/2310</span></p>\n</li>\n<li>\n<p><strong>查看当前连接设备</strong></p>\n<p><code>adb devices</code></p>\n</li>\n<li>\n<p><strong>如果发现多个设备</strong></p>\n<p><code>adb -s 设备号 其他指令</code></p>\n</li>\n<li>\n<p><strong>查看顶部 Activity</strong></p>\n<ul>\n<li>\n<p>windows 环境下:</p>\n<p><code>adb shell dumpsys activity | findstr &quot;mFocusedActivity&quot;</code></p>\n</li>\n<li>\n<p>Linux、Mac 环境下：</p>\n<p><code>adb shell dumpsys activity | grep &quot;mFocusedActivity&quot;</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>查看日志</strong></p>\n<p><code>adb logcat</code></p>\n</li>\n<li>\n<p><strong>安装 apk 文件</strong></p>\n<p><code>adb install xxx.apk</code></p>\n<p>推荐使用覆盖安装:</p>\n<p><code>adb install -r xxx.apk</code></p>\n</li>\n<li>\n<p><strong>卸载 App</strong></p>\n<p><code>adb uninstall com.zhy.app</code></p>\n<p>如果想要保留数据，则</p>\n<p><code>adb uninstall -k com.zhy.app</code></p>\n</li>\n<li>\n<p><strong>传递文件</strong></p>\n<ul>\n<li>\n<p>往手机 SDCard 传递文件</p>\n<p><code>adb push 文件名 手机端SDCard路径</code></p>\n</li>\n<li>\n<p>从手机端下载文件</p>\n<p><code>adb pull /sdcard/xxx.txt</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>启动 Activity</strong></p>\n<p><code>adb shell am start 包名/完整Activity路径</code></p>\n</li>\n<li>\n<p><strong>清除 APP 数据</strong></p>\n<p><code>adb shell pm clear com.example.packagename</code></p>\n<p><strong>注：该命令清除掉 APP 的缓存，还能把 APP 的数据给清空</strong></p>\n</li>\n<li>\n<p><strong>查看所有 App 的名称</strong></p>\n<p><code>adb shell pm list packages</code></p>\n<p>注：该命令可以查看手机上的 APP 名称。可以在后面加上 -f ，这样还能显示该 APP 的路径，即： <code>adb shell pm list packages -f</code>  或者  <code>adb shell pm path &lt;PACKAGE&gt;</code></p>\n<p><strong>列出第三方应用</strong>： <code>adb shell pm list packages -3</code></p>\n</li>\n</ul>\n",
            "tags": [
                "Python"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/WallPaper/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/WallPaper/",
            "title": "壁纸网站",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"wallpapers\"><a class=\"anchor\" href=\"#wallpapers\">#</a> WallPapers</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3dhbGxoYXZlbi5jYy8=\">wallhaven.cc</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3dhbGxwYXBlcnMubmV0Lw==\">wallpapers.net</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2ZsaWNrci5jb20v\">flickr.com</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2ltZ3VyLmNvbS8=\">imgur.com</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2RldmlhbnRhcnQuY29tLw==\">deviantart.com</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2ludGVyZmFjZWxpZnQuY29tLw==\">interfacelift.com</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3ZsYWRzdHVkaW8uY29tLw==\">vladstudio.com</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2RldmlhbnRhcnQubmV0Lw==\">deviantart.net</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2ltYWdlc2hhY2suY29tLw==\">imageshack.com</span></p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/Linux%E9%80%89%E6%8B%A9%E5%AD%97%E4%BD%93/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/Linux%E9%80%89%E6%8B%A9%E5%AD%97%E4%BD%93/",
            "title": "Linux选择字体",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"选择字体\"><a class=\"anchor\" href=\"#选择字体\">#</a> 选择字体</h1>\n<p>vim ~/.config/fontconfig/fonts.conf</p>\n<p>在 family 中设置字体的名称（也就是 archwiki 中所说的名字）</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>alias</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>family</span><span class=\"token punctuation\">></span></span>serif<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>family</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>prefer</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>family</span><span class=\"token punctuation\">></span></span>你喜欢的拉丁衬线字体名称<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>family</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>family</span><span class=\"token punctuation\">></span></span>你的中文衬线字体名称<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>family</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>prefer</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>alias</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>修改字体配置后可以用 fc-match -a monospace | head 检查字体选择设置是否正确.</p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/arch%E6%8D%A2%E6%BA%90/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/arch%E6%8D%A2%E6%BA%90/",
            "title": "arch换源",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"arch换源\"><a class=\"anchor\" href=\"#arch换源\">#</a> arch 换源</h1>\n<p>sudo wget -O /etc/pacman.d/mirrorlist <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYXJjaGxpbnV4Lm9yZy9taXJyb3JsaXN0L2FsbC8=\">https://www.archlinux.org/mirrorlist/all/</span><br />\nsudo vim  /etc/pacman.d/mirrorlist<br />\n# 进入后对 china 底下的注释删除<br />\n pacman -Syy<br />\npacman -S pacman-mirrorlist# 可以不写</p>\n<p>#注意 aur 助手 yay，yaourt 等需要添加官方源</p>\n<pre><code>然后很多教程在这里配置就结束了，就遇到一些问题，比如我们安装某些软件的时候会提示gpg签名错误损坏等这些，这个是因为没有导入key的原因，我们需要导入一下GPG KEY，具体操作就是\n安装archlinuxcn-keyring 包导入 GPG key。\n\n</code></pre>\n<p><code># sudo pacman -S archlinuxcn-keyring</code></p>\n<p>中文社区仓库</p>\n<p>编辑 /etc/pacman.conf 配置文件</p>\n<p>sudo vim /etc/pacman.conf</p>\n<p>添加源</p>\n<p>[archlinuxcn]</p>\n<p>#The Chinese Arch Linux communities packages.</p>\n<p>#SigLevel = Optional TrustedOnly</p>\n<p>#SigLevel = Optional TrustAll</p>\n<p>#官方源</p>\n<p>Server   = [<span class=\"exturl\" data-url=\"aHR0cDovL3JlcG8uYXJjaGxpbnV4Y24ub3JnLw==\">http://repo.archlinuxcn.org/</span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>h</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">(</mo><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mo>:</mo><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">/</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>o</mi><mi mathvariant=\"normal\">.</mi><mi>a</mi><mi>r</mi><mi>c</mi><mi>h</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>u</mi><mi>x</mi><mi>c</mi><mi>n</mi><mi mathvariant=\"normal\">.</mi><mi>o</mi><mi>r</mi><mi>g</mi><mi mathvariant=\"normal\">/</mi></mrow><annotation encoding=\"application/x-tex\">arch](http://repo.archlinuxcn.org/</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">]</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">/</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">n</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord\">/</span></span></span></span>arch)</p>\n<p>#163 源</p>\n<p>Server = [<span class=\"exturl\" data-url=\"aHR0cDovL21pcnJvcnMuMTYzLmNvbS9hcmNobGludXgtY24v\">http://mirrors.163.com/archlinux-cn/</span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>h</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">(</mo><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mo>:</mo><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">/</mi><mi>m</mi><mi>i</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mi>s</mi><mi mathvariant=\"normal\">.</mi><mn>163.</mn><mi>c</mi><mi>o</mi><mi>m</mi><mi mathvariant=\"normal\">/</mi><mi>a</mi><mi>r</mi><mi>c</mi><mi>h</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>u</mi><mi>x</mi><mo>−</mo><mi>c</mi><mi>n</mi><mi mathvariant=\"normal\">/</mi></mrow><annotation encoding=\"application/x-tex\">arch](http://mirrors.163.com/archlinux-cn/</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">]</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">/</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mord\">3</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">m</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">n</span><span class=\"mord\">/</span></span></span></span>arch)</p>\n<p>#清华大学</p>\n<p>Server = [<span class=\"exturl\" data-url=\"aHR0cHM6Ly9taXJyb3JzLnR1bmEudHNpbmdodWEuZWR1LmNuL2FyY2hsaW51eGNuLw==\">https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/</span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>h</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">(</mo><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mi>s</mi><mo>:</mo><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">/</mi><mi>m</mi><mi>i</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mi>s</mi><mi mathvariant=\"normal\">.</mi><mi>t</mi><mi>u</mi><mi>n</mi><mi>a</mi><mi mathvariant=\"normal\">.</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>h</mi><mi>u</mi><mi>a</mi><mi mathvariant=\"normal\">.</mi><mi>e</mi><mi>d</mi><mi>u</mi><mi mathvariant=\"normal\">.</mi><mi>c</mi><mi>n</mi><mi mathvariant=\"normal\">/</mi><mi>a</mi><mi>r</mi><mi>c</mi><mi>h</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>u</mi><mi>x</mi><mi>c</mi><mi>n</mi><mi mathvariant=\"normal\">/</mi></mrow><annotation encoding=\"application/x-tex\">arch](https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">]</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">/</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">a</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">a</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">u</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">n</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">n</span><span class=\"mord\">/</span></span></span></span>arch)</p>\n<p><strong>以上源只能添加一个</strong></p>\n<p>yay 用户（选择性换源）</p>\n<p>执行以下命令修改 aururl :</p>\n<p>yay --aururl &quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hdXIudHVuYS50c2luZ2h1YS5lZHUuY24v\">https://aur.tuna.tsinghua.edu.cn</span>&quot; --save</p>\n<p>修改的配置文件 (如果上方不行就去配置文件改成英文引号）</p>\n<p>vim ~/.config/yay/config.json</p>\n<p>查看配置</p>\n<p>yay -P -g</p>\n<p>手动更改源排名</p>\n<p>sudo pacman-mirrors -i -c China -m rank</p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/ArcoLinux/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/ArcoLinux/",
            "title": "arch衍生版arcolinux",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"arcolinux\"><a class=\"anchor\" href=\"#arcolinux\">#</a> ArcoLinux</h1>\n<p>super+shfit+a，程序启动窗口</p>\n<p>super+Q，退出</p>\n<p>super + 鼠标单击，可以拖动窗口</p>\n<p>super+Enter，打开默认 urxvt 终端模拟器，附带三个，termite,xfec 自带终端和 alacritt</p>\n<p>Super+Space，修改当前窗口布局</p>\n<p>软件包管理工具有 pacman,pamac,yay</p>\n<p><img data-src=\"https://gitee.com/obsidianlyg/gallery/raw/master/image//2021-08-10_08-27.png\" alt=\"ArcoLinux%20dbdbb4c808024da189a08d644815664f/2021-08-10_08-27.png\" /></p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/snap%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/snap%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/",
            "title": "snap的安装与使用",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"snap的安装与使用\"><a class=\"anchor\" href=\"#snap的安装与使用\">#</a> snap 的安装与使用</h1>\n<h3 id=\"依次执行\"><a class=\"anchor\" href=\"#依次执行\">#</a> <strong>依次执行</strong></h3>\n<h3 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> <strong>安装</strong></h3>\n<p><code>sudo pacman -S snapd</code></p>\n<h3 id=\"启动并设置开启启动并立即启动\"><a class=\"anchor\" href=\"#启动并设置开启启动并立即启动\">#</a> <strong>启动并设置开启启动并立即启动</strong></h3>\n<p><code>sudo systemctl enable --now snapd.socket</code></p>\n<h3 id=\"添加-snap-的命令\"><a class=\"anchor\" href=\"#添加-snap-的命令\">#</a> <strong>添加 snap 的命令</strong></h3>\n<p><code>sudo ln -s /var/lib/snapd/snap /snap</code></p>\n<h3 id=\"安装完了-snap-后如果你用的是桌面系统那么你可以下载安装-snap-store-来进行-gui-界面管理\"><a class=\"anchor\" href=\"#安装完了-snap-后如果你用的是桌面系统那么你可以下载安装-snap-store-来进行-gui-界面管理\">#</a> <strong>安装完了 snap 后，如果你用的是桌面系统，那么你可以下载安装 snap store 来进行 GUI 界面管理</strong></h3>\n<p><code>sudo snap install snap-store</code></p>\n<p>目前 snap 官方给出支持以下发行版的 linux： Arch Linux CentOS Debian Deepin Elementary OS Fedora GalliumOS KDE Neon Kubuntu Linux Mint Lubuntu Manjaro Linux openSUSE Parrot Security OS Raspbian Solus Ubuntu Xubuntu Zorin OS</p>\n<p>理论上如果你的 linux 是基于以上某个发行版本的话应该也可以使用相同的方式安装 之后你就可以使用  sudo snap install packageName 的命令来安装应用了，如果安装了 snap store 的话可以打开 snap store 来选择安装 如果没有安装 snap store 的话可以到 snap store 网页中选择自己想要下载的应用，然后选择自己想要或喜欢的应用点击图标进入详情页，在详情页中点击 install 就可以看到安装的命令了，复制到终端执行即可。</p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/vim/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/vim/",
            "title": "vim",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"vim\"><a class=\"anchor\" href=\"#vim\">#</a> vim</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVhbnlpZmVuZy5jb20vYmxvZy8yMDE4LzA5L3ZpbXJjLmh0bWw=\">https://www.ruanyifeng.com/blog/2018/09/vimrc.html</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNDExMTc5MC9hcnRpY2xlL2RldGFpbHMvODg3NTEzMzU=\">Vim 入门级基础配置</span></p>\n<p>支持中文不乱码:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token string\">'设置编码'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">fileencodings</span><span class=\"token operator\">=</span>utf-8,ucs-bom,gb18030,gbk,gb2312,cp936</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">termencoding</span><span class=\"token operator\">=</span>utf-8</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">encoding</span><span class=\"token operator\">=</span>utf-8</pre></td></tr></table></figure><ul>\n<li>\n<p>vim 分屏技巧</p>\n<p><code>:sv</code>  垂直分屏</p>\n<p><code>:sp</code>  水平分屏</p>\n<p>通过 <code>&lt;C-w&gt;</code>  开启窗口相关命令</p>\n<p>后面接上下左右就是将光标移动到指定方向的窗口</p>\n<p>若接 <code>&lt;</code>   <code>&gt;</code>  则是左右调整窗口大小， <code>12&gt;</code>  则是窗口向右移动 12 个单位</p>\n<p>同理 <code>+</code>   <code>-</code>  就是上下调整</p>\n<p>若后接等于则各个窗口调至初始状态</p>\n<p><code>:wall</code>  全部保存</p>\n<p><code>:qall</code>  全部退出</p>\n<p><code>:only</code>  关闭其他窗口</p>\n<p>调整分屏大小：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RpeW9uZ2xhbzQwNTUvYXJ0aWNsZS9kZXRhaWxzLzEwMTE4NDE3Ng==\">https://blog.csdn.net/diyonglao4055/article/details/101184176</span></p>\n<p>使用技巧：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3djeTIzNTgwL2FydGljbGUvZGV0YWlscy84MTM4NzE4OA==\">https://blog.csdn.net/wcy23580/article/details/81387188</span></p>\n</li>\n<li>\n<p>安装侧边栏目录插件</p>\n<p>#下载压缩文件<br />\n <code>wget http://www.vim.org/scripts/download_script.php?src_id=17123 -O nerdtree.zip</code> <br />\n# 解压<br />\n <code>unzip nerdtree.zip</code> <br />\n# 在家目录下创建.vim/{plugin,doc}<br />\n <code>mkdir -p ~/.vim/&#123;plugin,doc&#125;</code> <br />\n# 复制两个文件<br />\n <code>cp plugin/NERD_tree.vim ~/.vim/plugin/</code> <br />\n <code>cp doc/NERD_tree.txt ~/.vim/doc/</code></p>\n<p>插件快捷键设置</p>\n<p>&quot; 设置 NerdTree<br />\n <code>map &lt;F3&gt; :NERDTreeMirror&lt;CR&gt;</code> <br />\n <code>map &lt;F3&gt; :NERDTreeToggle&lt;CR&gt;</code></p>\n</li>\n<li>\n<p>基础配置</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> nu</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>syntax on</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">set</span> nocompatible</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">tabstop</span><span class=\"token operator\">=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token string\">\" 开启插件</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>filetype plugin indent on</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> \"</span> 搜索时忽略大小写，但有一个或以上大些字母时仍保持对大写敏感</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">set</span> ignorecase smartcase </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token builtin class-name\">set</span> incsearch</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">mouse</span><span class=\"token operator\">=</span>a</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">encoding</span><span class=\"token operator\">=</span>utf-8</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">t_Co</span><span class=\"token operator\">=</span><span class=\"token number\">256</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>filetype indent on</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token string\">\"set paste</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\"</span><span class=\"token builtin class-name\">set</span> autoindent </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">shiftwidth</span><span class=\"token operator\">=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token builtin class-name\">set</span> expandtab</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">softtabstop</span><span class=\"token operator\">=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token builtin class-name\">set</span> wrap</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token builtin class-name\">set</span> linebreak</pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">wrapmargin</span><span class=\"token operator\">=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">scrolloff</span><span class=\"token operator\">=</span><span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre> \"设置NerdTree</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>map <span class=\"token operator\">&lt;</span>F<span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>></span> :NERDTreeMirror<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>map <span class=\"token operator\">&lt;</span>F<span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>></span> :NERDTreeToggle<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span></pre></td></tr></table></figure></li>\n<li>\n<p>小技巧</p>\n<ul>\n<li>\n<p>宏录制</p>\n<p>qa: 把你的操作记录在寄存器 a 中，操作完成后按 q 停止录制。</p>\n<p>于是 <code>@a</code>  会 replay 被录制的宏。</p>\n<p><code>@@</code>  是一个快捷键用来 replay 最新录制的宏。</p>\n<p><code>100@@</code> 会执行 100 次</p>\n</li>\n<li>\n<p>v 选中相关使用</p>\n<p>选中后：</p>\n<p><code>J</code>  →把所有行连接起来</p>\n<p><code>&lt;</code>  或  <code>&gt;</code>  → 左右缩进</p>\n<p><code>=</code>  → 自动缩进</p>\n<p>未选中 J 单行执行连接， <code>&lt;&lt;</code>  或 <code>&gt;&gt;</code>  单行缩进</p>\n</li>\n<li>\n<p>块选中</p>\n<p><code>&lt;C-v&gt;</code>  通过移动键选中区域后按 <code>x</code>  删除，</p>\n<p>或者按 <code>I</code>  (大写的 i) 进行多行插入</p>\n</li>\n<li>\n<p>一行文字大小写转换</p>\n<p><code>Vu</code>  或 <code>guu</code>  一行文字全小写</p>\n<p><code>VU</code>  或  <code>gUU</code>  一行文字全大写</p>\n</li>\n<li>\n<p>查看光标处的 ASCII 码： <code>ga</code></p>\n</li>\n<li>\n<p>查看光标处的 utf-8 编码： <code>g8</code></p>\n</li>\n<li>\n<p>打开光标处所指的文件： <code>gf</code></p>\n</li>\n<li>\n<p>剪切一行： <code>dd</code></p>\n</li>\n<li>\n<p>复制一行： <code>yy</code></p>\n</li>\n<li>\n<p>到第 N 行</p>\n<p>N  <code>G</code></p>\n<p>N  <code>gg</code></p>\n<p><code>:</code>  N  <code>&lt;CR&gt;</code></p>\n</li>\n<li>\n<p>选中括号或引号内的内容</p>\n<p>vi 与 va</p>\n<p><img data-src=\"https://gitee.com/obsidianlyg/gallery/raw/master/image//Untitled.png\" alt=\"Untitled\" /></p>\n</li>\n<li>\n<p>自带的自动提示功能</p>\n<p>前提：之前有输入过这个单词或汉字</p>\n<p>按 <code>&lt;C-p&gt;</code>  或者 <code>&lt;C-n&gt;</code>  就可以自动补齐啦</p>\n</li>\n</ul>\n</li>\n</ul>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/%E8%A7%A3%E5%86%B3vim%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E5%A4%96%E5%8A%A0%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/%E8%A7%A3%E5%86%B3vim%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E5%A4%96%E5%8A%A0%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/",
            "title": "vim乱码问题",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"解决vim中文乱码问题外加基本配置\"><a class=\"anchor\" href=\"#解决vim中文乱码问题外加基本配置\">#</a> 解决 vim 中文乱码问题外加基本配置</h1>\n<p>vim ~/.vimrc<br />\nset fileencodings=utf-8,gb2312,gb18030,gbk,ucs-bom,cp936,latin1<br />\nset enc=utf8<br />\nset fencs=utf8,gbk,gb2312,gb18030<br />\nset nu</p>\n<p>set mouse=a</p>\n<p>&quot; 显示颜色</p>\n<p>set t_Co=256</p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/ranger%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/ranger%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/",
            "title": "ranger常用命令",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"ranger常用命令\"><a class=\"anchor\" href=\"#ranger常用命令\">#</a> ranger 常用命令</h1>\n<p>生成配置文件</p>\n<p>ranger --copy-config=all</p>\n<p>在 rc.conf 中 map f console scout -ftsea% space 搜索指定文件并显示</p>\n<p>shift+s 进入当前文件位置</p>\n<p><strong>导航</strong></p>\n<ul>\n<li>f = 向下翻页</li>\n<li>b = 向上翻页</li>\n<li>gg = 转到列表顶部</li>\n<li>G = 转到列表底部</li>\n<li>H = 返回导航历史记录</li>\n<li>h = 移至上级目录</li>\n<li>J = 下一页 1/2 页</li>\n<li>J = 下移</li>\n<li>K = 上一页 1/2 页</li>\n<li>k = 向上移动</li>\n<li>L = 前进浏览历史记录</li>\n<li>Q = 退出</li>\n</ul>\n<p><strong>处理文件</strong></p>\n<ul>\n<li>我… 显示文件</li>\n<li>E | I… 编辑文件</li>\n<li>r… 使用所选程序打开文件</li>\n<li>cw… 重命名文件</li>\n<li>/… 搜索文件 (n | p 跳至下一个 / 上一个匹配项)      + 部分文件名 + tab 可以直接跳转</li>\n<li>dd .. 将文件标记为剪切</li>\n<li>ud… 未切割</li>\n<li>p… 粘贴文件</li>\n<li>yy .. 复制 / 粘贴文件</li>\n<li>zh… 显示隐藏文件</li>\n<li>= 选择当前文件</li>\n<li>：delete = 删除所选文件</li>\n<li>：mkdir… 创建目录</li>\n<li>：touch… 创建一个文件</li>\n<li>：rename… 重命名文件</li>\n</ul>\n<p><a href=\"%5Bhttps://blog.csdn.net/HideOnLie/article/details/103719698?ops_request_misc=%7B%22request%5Fid%22%3A%22162843197416780265431441%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=162843197416780265431441&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-103719698.first_rank_v2_pc_rank_v29&amp;utm_term=ranger%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87&amp;spm=1018.2226.3001.4187%5D(https://blog.csdn.net/HideOnLie/article/details/103719698?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162843197416780265431441%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=162843197416780265431441&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-103719698.first_rank_v2_pc_rank_v29&amp;utm_term=ranger%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87&amp;spm=1018.2226.3001.4187)\">相关链接</a></p>\n<p>显示图标的 ico 插件： <code>git clone https://github.com/alexanderjeurissen/ranger_devicons ~/.config/ranger/plugins/ranger_devicons</code></p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/",
            "url": "https://obsidianlyg.github.io/Arch/Arch%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/",
            "title": "arch个人笔记",
            "date_published": "2021-12-27T04:53:55.000Z",
            "content_html": "<h1 id=\"arch个人笔记\"><a class=\"anchor\" href=\"#arch个人笔记\">#</a> Arch 个人笔记</h1>\n<h2 id=\"arch换源\"><a class=\"anchor\" href=\"#arch换源\">#</a> <a href=\"/Arch/Arch/arch%E6%8D%A2%E6%BA%90/\">arch 换源</a></h2>\n<h2 id=\"解决vim中文乱码问题外加基本配置\"><a class=\"anchor\" href=\"#解决vim中文乱码问题外加基本配置\">#</a> <a href=\"/Arch/Arch/%E8%A7%A3%E5%86%B3vim%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E5%A4%96%E5%8A%A0%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/\">解决 vim 中文乱码问题外加基本配置</a></h2>\n<h2 id=\"v2ray\"><a class=\"anchor\" href=\"#v2ray\">#</a> <a href=\"/Arch/Arch/v2ray/\">v2ray</a></h2>\n<h2 id=\"snap的安装与使用\"><a class=\"anchor\" href=\"#snap的安装与使用\">#</a> <a href=\"/Arch/Arch/snap%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/\">snap 的安装与使用</a></h2>\n<h2 id=\"arcolinux\"><a class=\"anchor\" href=\"#arcolinux\">#</a> <a href=\"/Arch/Arch/ArcoLinux/\">ArcoLinux</a></h2>\n<h2 id=\"选择字体\"><a class=\"anchor\" href=\"#选择字体\">#</a> <a href=\"/Arch/Arch/%E9%80%89%E6%8B%A9%E5%AD%97%E4%BD%93/\">选择字体</a></h2>\n<h2 id=\"ranger常用命令\"><a class=\"anchor\" href=\"#ranger常用命令\">#</a> <a href=\"/Arch/Arch/ranger%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/\">ranger 常用命令</a></h2>\n<h2 id=\"vim\"><a class=\"anchor\" href=\"#vim\">#</a> <a href=\"/Arch/Arch/vim/\">vim</a></h2>\n<h2 id=\"wallpapers\"><a class=\"anchor\" href=\"#wallpapers\">#</a> <a href=\"/Arch/Arch/WallPaper/\">WallPapers</a></h2>\n<h2 id=\"网站引入\"><a class=\"anchor\" href=\"#网站引入\">#</a> 网站引入</h2>\n<p>很强的 web 导航：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub2lzZWRoLmNuLw==\">https://noisedh.cn/</span></p>\n<p>相关 arch 显卡，娱乐等配置推荐<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hcmNobGludXhzdHVkaW8uZ2l0aHViLmlvL0FyY2hMaW51eFR1dG9yaWFsLyMv\"> https://archlinuxstudio.github.io/ArchLinuxTutorial/#/</span></p>\n<p>修改 ranger 默认编辑器：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3ptaHptaHptL2FydGljbGUvZGV0YWlscy8xMDY3NjU0ODA=\">https://blog.csdn.net/zmhzmhzm/article/details/106765480</span></p>\n<p>解决 aur 缺少依赖问题：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pZ2h0YnhnL2FydGljbGUvZGV0YWlscy8xMTIyNzIzNTA=\">https://blog.csdn.net/mightbxg/article/details/112272350</span></p>\n<p>flameshot (火焰截图)</p>\n<p>不知道文件是否是文件夹用：ls -F</p>\n<h2 id=\"shell常设快捷命令\"><a class=\"anchor\" href=\"#shell常设快捷命令\">#</a> shell 常设快捷命令</h2>\n<h1 id=\"命令别名\"><a class=\"anchor\" href=\"#命令别名\">#</a> 命令别名</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">cp</span><span class=\"token operator\">=</span><span class=\"token string\">'cp -i'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">mv</span><span class=\"token operator\">=</span><span class=\"token string\">'mv -i'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">rm</span><span class=\"token operator\">=</span><span class=\"token string\">'rm -i'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">ls</span><span class=\"token operator\">=</span><span class=\"token string\">'ls  -F --color=auto'</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">ll</span><span class=\"token operator\">=</span><span class=\"token string\">'ls -al'</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">grep</span><span class=\"token operator\">=</span><span class=\"token string\">'grep --color=auto'</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">la</span><span class=\"token operator\">=</span><span class=\"token string\">'ls -a'</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">pacman</span><span class=\"token operator\">=</span><span class=\"token string\">'sudo pacman-color'</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">p</span><span class=\"token operator\">=</span><span class=\"token string\">'sudo pacman-color'</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">y</span><span class=\"token operator\">=</span><span class=\"token string\">'yaourt'</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">h</span><span class=\"token operator\">=</span><span class=\"token string\">'htop'</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">vim</span><span class=\"token operator\">=</span><span class=\"token string\">'sudo vim'</span></pre></td></tr></table></figure><h2 id=\"解决谷歌无法输入中文问题\"><a class=\"anchor\" href=\"#解决谷歌无法输入中文问题\">#</a> 解决谷歌无法输入中文问题</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> .zshrc</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LC_CTYPE</span><span class=\"token operator\">=</span>zh_CN.UTF-8</pre></td></tr></table></figure><h2 id=\"archlinux同步网络时间\"><a class=\"anchor\" href=\"#archlinux同步网络时间\">#</a> ArchLinux 同步网络时间</h2>\n<p><code>sudo timedatectl set-ntp true</code></p>\n<h2 id=\"tim和weixin安装github链接\"><a class=\"anchor\" href=\"#tim和weixin安装github链接\">#</a> tim 和 weixin 安装 github 链接</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NvdW50c3RhcmxpZ2h0L2RlZXBpbi13aW5lLXRpbS1hcmNo\">https://github.com/countstarlight/deepin-wine-tim-arch</span></p>\n<h2 id=\"查找命令集及用法\"><a class=\"anchor\" href=\"#查找命令集及用法\">#</a> 查找命令集及用法</h2>\n<ol>\n<li><strong> <code>find</code>  &lt;指定目录&gt; &lt; 指定条件 &gt; &lt; 指定动作 &gt;</strong>\n<ul>\n<li><code>find . -name &quot;my*&quot;</code>  #搜索当前目录（含子目录，以下同）中，所有文件名以 my 开头的文件。</li>\n<li><code>find . -name &quot;my*&quot; -ls</code>  #搜索当前目录中所有文件名以 my 开头的文件并显示它们的详细信息。</li>\n<li><code>find . -type f -mmin -10</code>  #搜索当前目录中，所有过去 10 分钟中更新过的普通文件。如果不加 - type f 参数，则搜索普通文件 + 特殊文件 + 目录</li>\n</ul>\n</li>\n<li><strong> <code>locate</code> </strong>\n<ul>\n<li><code>locate /etc/sh</code>  #搜索 etc 目录下所有以 sh 开头的文件。</li>\n<li><code>locate ~/m</code>  # 搜索用户主目录下，所有以 m 开头的文件。</li>\n<li><code>locate -i ~/m</code>  #搜索用户主目录下，所有以 m 开头的文件，并且忽略大小写。</li>\n</ul>\n</li>\n<li><strong> <code>whereis</code> </strong>\n<ul>\n<li><code>whereis</code>  命令只能用于程序名的搜索，而且只搜索二进制文件（参数 - b）、man 说明文件（参数 - m）和源代码文件（参数 - s）。如果省略参数，则返回所有信息。</li>\n</ul>\n</li>\n<li><strong> <code>which</code> </strong>\n<ul>\n<li><code>which</code>  命令的作用是，在 PATH 变量指定的路径中，搜索某个系统命令的位置，并且返回第一个搜索结果。也就是说，使用 which 命令，就可以看到某个系统命令是否存在，以及执行的到底是哪一个位置的命令。</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"基础bash头配置\"><a class=\"anchor\" href=\"#基础bash头配置\">#</a> 基础 bash 头配置</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PS1</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[36;40m\\]\\u\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[m\\]\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[34;40m\\][\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[m\\]\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[32;40m\\]\\w\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[m\\]\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[34;40m\\]]\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[m\\]\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[32;40m\\]:\\[<span class=\"token entity\" title=\"\\e\">\\e</span>[m\\]\"</span></pre></td></tr></table></figure><p>查看完整系统版本信息： <code>cat /proc/version</code></p>\n<p>查看指定程序名的 pid： <code>pgrep -l redis</code></p>\n<p>查看 redis 的进程是否开启： <code>ps -ef | grep redis</code></p>\n<h2 id=\"查看列表型系统版本信息lsb_release-a\"><a class=\"anchor\" href=\"#查看列表型系统版本信息lsb_release-a\">#</a> 查看列表型系统版本信息：lsb_release -a</h2>\n<p><img data-src=\"https://gitee.com/obsidianlyg/gallery/raw/master/image//leasea.png\" alt=\"leasea.png\" /></p>\n<h2 id=\"配置环境变量\"><a class=\"anchor\" href=\"#配置环境变量\">#</a> 配置环境变量</h2>\n<p><strong>1、直接在命令行中设置</strong></p>\n<p><code>PATH# PATH=$PATH:/usr/local/apache/bin</code></p>\n<p>使用这种方法，只对当前会话有效，也就是说每当登出或注销系统以后，PATH 设置就会失效。</p>\n<p><strong>2、在 profile 中设置 PATH</strong></p>\n<p><code>vi /etc/profile</code>  找到 export 行，</p>\n<p>在下面新增加一行，内容为：</p>\n<p><code>export PATH=$PATH:/usr/local/apache/bin</code></p>\n<p>注：＝ 等号两边不能有任何空格。这种方法最好，除非手动强制修改 PATH 的值，否则将不会被改变。编辑 /etc/profile 后 PATH 的修改不会立马生效，</p>\n<p>如果需要立即生效的话，可以执行# source profile 命令。</p>\n<p><strong>3、在当前用户的 profile 中设置 PATH（推荐）</strong></p>\n<p><code>vi ~/.bash_profile</code></p>\n<p>修改 PATH 行，把 /usr/local/apache/bin 添加进去，如：</p>\n<p><code>PATH=$PATH:$HOME/bin:/usr/local/apache/bin</code> 。</p>\n<p><code>source ~/.bash_profile</code>  让这次的修改生效。</p>\n<p>注：这种方法只对当前用户起作用的，其他用户该修改无效。</p>\n<h2 id=\"查看端口\"><a class=\"anchor\" href=\"#查看端口\">#</a> 查看端口</h2>\n<p><code>netstat -nlt|grep 6379</code></p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        }
    ]
}