{
    "version": "https://jsonfeed.org/version/1",
    "title": "L小悠的日常L",
    "subtitle": "obsidianlyg",
    "icon": "https://obsidianlyg.github.io/images/favicon.ico",
    "description": "最好的生活是：时光，浓淡相宜，人心，远近相安",
    "home_page_url": "https://obsidianlyg.github.io",
    "items": [
        {
            "id": "https://obsidianlyg.github.io/Note/%E5%85%B3%E4%BA%8Ed3js%E7%94%9F%E6%88%90%E8%8A%82%E7%82%B9%E7%94%BB%E5%B8%83%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/",
            "url": "https://obsidianlyg.github.io/Note/%E5%85%B3%E4%BA%8Ed3js%E7%94%9F%E6%88%90%E8%8A%82%E7%82%B9%E7%94%BB%E5%B8%83%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/",
            "title": "关于d3js生成节点画布的个人笔记",
            "date_published": "2024-05-30T12:15:12.000Z",
            "content_html": "<h2 id=\"实现功能\"><a class=\"anchor\" href=\"#实现功能\">#</a> 实现功能</h2>\n<ol>\n<li>根据鼠标位置生成节点</li>\n<li>根据节点位置通过鼠标拖拽生成连线</li>\n<li>实现自定义线段颜色功能</li>\n<li>删除节点以及连线功能</li>\n<li>实现单个节点拖动功能</li>\n<li>实现整条线路的拖动功能<br />\n界面如下：<br />\n<img data-src=\"https://raw.githubusercontent.com/obsidianlyg/gallery/master/image/20240531081158.png\" alt=\"\" /></li>\n</ol>\n<h2 id=\"主要模块介绍\"><a class=\"anchor\" href=\"#主要模块介绍\">#</a> 主要模块介绍</h2>\n<h3 id=\"绘制连线\"><a class=\"anchor\" href=\"#绘制连线\">#</a> 绘制连线</h3>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> line <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>links<span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>d<span class=\"token punctuation\">.</span>source<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>d<span class=\"token punctuation\">.</span>target<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>line<span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stroke\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>objId<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>line<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"绘制节点\"><a class=\"anchor\" href=\"#绘制节点\">#</a> 绘制节点</h3>\n<p>设置为四种节点类型，初始节点，杆塔，开关，电表箱</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".node\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>nodes<span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>node<span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token comment\">// 这里可以换成 circle，加入属性 r，10 换成原型节点，移除 xlink</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">node </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>d<span class=\"token punctuation\">.</span>type<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"width\"</span><span class=\"token punctuation\">,</span> iconSize<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"height\"</span><span class=\"token punctuation\">,</span> iconSize<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"xlink:href\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'pole'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./pole.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'meterBox'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./meterBox.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'switch'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./switch.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'init'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./init.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>d3<span class=\"token punctuation\">.</span><span class=\"token function\">drag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> dragstarted<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"drag\"</span><span class=\"token punctuation\">,</span> dragged<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"end\"</span><span class=\"token punctuation\">,</span> dragended<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isDeletingNode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            links <span class=\"token operator\">=</span> links<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">link</span> <span class=\"token operator\">=></span> link<span class=\"token punctuation\">.</span>source <span class=\"token operator\">!==</span> d<span class=\"token punctuation\">.</span>id <span class=\"token operator\">&amp;&amp;</span> link<span class=\"token punctuation\">.</span>target <span class=\"token operator\">!==</span> d<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            nodes <span class=\"token operator\">=</span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">node</span> <span class=\"token operator\">=></span> node <span class=\"token operator\">!==</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token comment\">// isDeletingNode = false;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"点击了节点\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>node<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"添加节点\"><a class=\"anchor\" href=\"#添加节点\">#</a> 添加节点</h3>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>svg<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isAddingNode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> coords <span class=\"token operator\">=</span> d3<span class=\"token punctuation\">.</span><span class=\"token function\">pointer</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">getUuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Node</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>nodes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">const</span> type <span class=\"token operator\">=</span> nodeType<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        nodes<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span> id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> x<span class=\"token operator\">:</span> coords<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> coords<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"完整实现如下\"><a class=\"anchor\" href=\"#完整实现如下\">#</a> 完整实现如下</h3>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Interactive Line Loss Diagram with D3.js<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://d3js.org/d3.v6.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>    </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\"></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token selector\">.pole</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token property\">fill</span><span class=\"token punctuation\">:</span> orange<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token property\">stroke</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token property\">stroke-width</span><span class=\"token punctuation\">:</span> 1px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token selector\">.meterBox</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token property\">fill</span><span class=\"token punctuation\">:</span> green<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token property\">stroke</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token property\">stroke-width</span><span class=\"token punctuation\">:</span> 1px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token selector\">.gateway</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token property\">fill</span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token property\">stroke</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token property\">stroke-width</span><span class=\"token punctuation\">:</span> 1px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token selector\">.switch</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token property\">fill</span><span class=\"token punctuation\">:</span> gray<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token property\">stroke</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token property\">stroke-width</span><span class=\"token punctuation\">:</span> 1px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token selector\">.line</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token property\">stroke-width</span><span class=\"token punctuation\">:</span> 2px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token selector\">.label</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 12px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token property\">text-anchor</span><span class=\"token punctuation\">:</span> middle<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token selector\">.button-container</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token selector\">button</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token property\">margin-right</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token selector\">#colorPicker</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>addNodeButton<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">addNodeButton</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pole'</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>新增节点<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>addNodeButton<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">addNodeButton</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meterBox'</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>新增表箱<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>addNodeButton<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">addNodeButton</span><span class=\"token punctuation\">(</span><span class=\"token string\">'switch'</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>新增开关<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>addLinkButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>连线<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>deleteNodeButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>删除节点<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>deleteLinkButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>删除连线<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">logNodeButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>打印节点<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">selectButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>选择节点<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">selectAllButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>整体拖动<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>color<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>colorPicker<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">updateColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            更新颜色</pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>800<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>600<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>defs</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>pattern</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>grid<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">patternUnits</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>userSpaceOnUse<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M 20 0 L 0 0 0 20<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gray<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0.5<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>pattern</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>defs</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>rect</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>url(#grid)<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token keyword\">const</span> svg <span class=\"token operator\">=</span> d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"svg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token comment\">// let nodes = [];</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        <span class=\"token comment\">// let links = [];</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">let</span> links <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token keyword\">let</span> nodes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>            <span class=\"token string\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ec61a8f4-73ec-46fe-adb2-4473119a006c\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>            <span class=\"token string\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"init\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>            <span class=\"token string\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"init\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>            <span class=\"token string\">\"x\"</span><span class=\"token operator\">:</span> <span class=\"token number\">119.99999237060547</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>            <span class=\"token string\">\"y\"</span><span class=\"token operator\">:</span> <span class=\"token number\">43.71427917480469</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        <span class=\"token comment\">// 虚拟数据</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token comment\">//        nodes = jsonData.nodes;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre><span class=\"token comment\">//      links = jsonData.links;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        <span class=\"token keyword\">let</span> isAddingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        <span class=\"token keyword\">let</span> isAddingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>        <span class=\"token keyword\">let</span> isDeletingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        <span class=\"token keyword\">let</span> isDeletingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token keyword\">let</span> sourceNode <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>        <span class=\"token keyword\">let</span> dragLine <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token keyword\">let</span> nodeType <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>        <span class=\"token keyword\">let</span> selectedLink   <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>        <span class=\"token keyword\">let</span> allDrag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>        <span class=\"token keyword\">const</span> iconSize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"107\"></td><td><pre></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>        <span class=\"token comment\">// 绘制节点和连线</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>            <span class=\"token comment\">// 绘制连线</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>            <span class=\"token keyword\">const</span> line <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>links<span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>d<span class=\"token punctuation\">.</span>source<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>d<span class=\"token punctuation\">.</span>target<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>            line<span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stroke\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>objId<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> d<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isDeletingLink<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>                        links <span class=\"token operator\">=</span> links<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">link</span> <span class=\"token operator\">=></span> link <span class=\"token operator\">!==</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>                        <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>                        <span class=\"token comment\">// isDeletingLink = false;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>                        selectedLink <span class=\"token operator\">=</span> d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>                        <span class=\"token keyword\">const</span> colorPicker <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"colorPicker\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>                        colorPicker<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">\"block\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>                        colorPicker<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>left <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>event<span class=\"token punctuation\">.</span>pageX<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>                        colorPicker<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>event<span class=\"token punctuation\">.</span>pageY<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>                        colorPicker<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>color <span class=\"token operator\">||</span> <span class=\"token string\">\"#000000\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>                        colorPicker<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>            line<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>            <span class=\"token comment\">// 绘制节点</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>            <span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".node\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>nodes<span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>            node<span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">node </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>d<span class=\"token punctuation\">.</span>type<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"width\"</span><span class=\"token punctuation\">,</span> iconSize<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"height\"</span><span class=\"token punctuation\">,</span> iconSize<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"xlink:href\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'pole'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./pole.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'meterBox'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./meterBox.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'switch'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./switch.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'init'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'./init.png'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>d3<span class=\"token punctuation\">.</span><span class=\"token function\">drag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> dragstarted<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"drag\"</span><span class=\"token punctuation\">,</span> dragged<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"end\"</span><span class=\"token punctuation\">,</span> dragended<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>                <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isDeletingNode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>                        links <span class=\"token operator\">=</span> links<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">link</span> <span class=\"token operator\">=></span> link<span class=\"token punctuation\">.</span>source <span class=\"token operator\">!==</span> d<span class=\"token punctuation\">.</span>id <span class=\"token operator\">&amp;&amp;</span> link<span class=\"token punctuation\">.</span>target <span class=\"token operator\">!==</span> d<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>                        nodes <span class=\"token operator\">=</span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">node</span> <span class=\"token operator\">=></span> node <span class=\"token operator\">!==</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>                        <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>                        <span class=\"token comment\">// isDeletingNode = false;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>                        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"点击了节点\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>            node<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>            <span class=\"token comment\">// 添加标签</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>            <span class=\"token keyword\">const</span> label <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".label\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>nodes<span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>            label<span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> iconSize<span class=\"token operator\">/</span><span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>                <span class=\"token comment\">// .text(d => d.name);</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>                <span class=\"token comment\">// .text(d => d.type);</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>            label<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"190\"></td><td><pre></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>        <span class=\"token comment\">// 添加新节点</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>        svg<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isAddingNode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>                <span class=\"token keyword\">const</span> coords <span class=\"token operator\">=</span> d3<span class=\"token punctuation\">.</span><span class=\"token function\">pointer</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>                <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">getUuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>                <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Node</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>nodes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>                <span class=\"token comment\">// const type = nodes.length % 3 === 0 ? 'tower' : (nodes.length % 3 === 1 ? 'station' : 'gateway');</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>                <span class=\"token keyword\">const</span> type <span class=\"token operator\">=</span> nodeType<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>                nodes<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span> id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> x<span class=\"token operator\">:</span> coords<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> coords<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>                <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>                <span class=\"token comment\">// isAddingNode = false; // Reset the flag</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>        <span class=\"token comment\">// 拖拽行为的三个方法</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">dragstarted</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isAddingLink<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>                sourceNode <span class=\"token operator\">=</span> d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>                <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">getUuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre>                sourceNode<span class=\"token punctuation\">.</span>objId <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>                dragLine <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dragLine\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stroke\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gray\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stroke-width\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x1\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y1\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y2\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isAddingNode <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isAddingLink <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isDeletingNode <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isDeletingLink<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>                d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">raise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">classed</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">dragged</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dragLine<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre>                dragLine<span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre>                        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y2\"</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isAddingNode <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isAddingLink <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isDeletingNode <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isDeletingLink<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre>                d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre>                d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre></pre></td></tr><tr><td data-num=\"235\"></td><td><pre>                d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>                <span class=\"token comment\">// 更新连线的位置</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>                svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>allDrag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre>                <span class=\"token keyword\">const</span> dx <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>dx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>                <span class=\"token keyword\">const</span> dy <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>dy<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre></pre></td></tr><tr><td data-num=\"250\"></td><td><pre>                <span class=\"token comment\">// 更新被拖动节点的位置</span></pre></td></tr><tr><td data-num=\"251\"></td><td><pre>                d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+=</span> dx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"252\"></td><td><pre>                d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+=</span> dy<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"253\"></td><td><pre></pre></td></tr><tr><td data-num=\"254\"></td><td><pre>                d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"256\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"257\"></td><td><pre></pre></td></tr><tr><td data-num=\"258\"></td><td><pre>                <span class=\"token comment\">// 递归更新与当前节点相连的所有节点和连线的位置</span></pre></td></tr><tr><td data-num=\"259\"></td><td><pre>                <span class=\"token keyword\">const</span> visitedNodes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"260\"></td><td><pre>                <span class=\"token function\">updateConnectedNodes</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> dx<span class=\"token punctuation\">,</span> dy<span class=\"token punctuation\">,</span> visitedNodes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"261\"></td><td><pre></pre></td></tr><tr><td data-num=\"262\"></td><td><pre>                <span class=\"token comment\">// 更新所有连线的位置</span></pre></td></tr><tr><td data-num=\"263\"></td><td><pre>                svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"264\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"265\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y1\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"266\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"267\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y2\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> l<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"268\"></td><td><pre></pre></td></tr><tr><td data-num=\"269\"></td><td><pre>                <span class=\"token comment\">// 更新所有节点的位置</span></pre></td></tr><tr><td data-num=\"270\"></td><td><pre>                svg<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".node\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"271\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"272\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> iconSize <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"273\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"274\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"275\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"276\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">dragended</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"277\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dragLine<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"278\"></td><td><pre>                dragLine<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"279\"></td><td><pre>                dragLine <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"280\"></td><td><pre>                <span class=\"token keyword\">const</span> targetNode <span class=\"token operator\">=</span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">hypot</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> event<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> event<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"281\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>targetNode <span class=\"token operator\">&amp;&amp;</span> targetNode <span class=\"token operator\">!==</span> sourceNode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre>                    <span class=\"token keyword\">const</span> color <span class=\"token operator\">=</span> <span class=\"token function\">determineLinkColor</span><span class=\"token punctuation\">(</span>sourceNode<span class=\"token punctuation\">,</span> targetNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"283\"></td><td><pre>                    links<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>objId<span class=\"token operator\">:</span>sourceNode<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> source<span class=\"token operator\">:</span> sourceNode<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> target<span class=\"token operator\">:</span> targetNode<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> color<span class=\"token operator\">:</span> color <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"284\"></td><td><pre>                    <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"285\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre>                sourceNode <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"287\"></td><td><pre>                <span class=\"token comment\">// isAddingLink = false; // Reset the flag</span></pre></td></tr><tr><td data-num=\"288\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isAddingNode <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isAddingLink <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isDeletingNode <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isDeletingLink<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"290\"></td><td><pre>                d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">classed</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"291\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"293\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"294\"></td><td><pre>        <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"295\"></td><td><pre>         * 递归更新与当前节点相连的所有节点的位置</pre></td></tr><tr><td data-num=\"296\"></td><td><pre>         * @param &#123;object&#125; node - 当前节点</pre></td></tr><tr><td data-num=\"297\"></td><td><pre>         * @param &#123;number&#125; dx - x 方向的移动距离</pre></td></tr><tr><td data-num=\"298\"></td><td><pre>         * @param &#123;number&#125; dy - y 方向的移动距离</pre></td></tr><tr><td data-num=\"299\"></td><td><pre>         * @param &#123;Set&#125; visitedNodes - 已访问的节点集合</pre></td></tr><tr><td data-num=\"300\"></td><td><pre>         */</span></pre></td></tr><tr><td data-num=\"301\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">updateConnectedNodes</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">node<span class=\"token punctuation\">,</span> dx<span class=\"token punctuation\">,</span> dy<span class=\"token punctuation\">,</span> visitedNodes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"302\"></td><td><pre>            visitedNodes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"303\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"304\"></td><td><pre>            links<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">link</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"305\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">.</span>source <span class=\"token operator\">===</span> node<span class=\"token punctuation\">.</span>id <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>visitedNodes<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"306\"></td><td><pre>                    <span class=\"token keyword\">const</span> targetNode <span class=\"token operator\">=</span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> link<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"307\"></td><td><pre>                    targetNode<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+=</span> dx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"308\"></td><td><pre>                    targetNode<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+=</span> dy<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"309\"></td><td><pre>                    <span class=\"token function\">updateConnectedNodes</span><span class=\"token punctuation\">(</span>targetNode<span class=\"token punctuation\">,</span> dx<span class=\"token punctuation\">,</span> dy<span class=\"token punctuation\">,</span> visitedNodes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"310\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">.</span>target <span class=\"token operator\">===</span> node<span class=\"token punctuation\">.</span>id <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>visitedNodes<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"311\"></td><td><pre>                    <span class=\"token keyword\">const</span> sourceNode <span class=\"token operator\">=</span> nodes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> link<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"312\"></td><td><pre>                    sourceNode<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+=</span> dx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"313\"></td><td><pre>                    sourceNode<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+=</span> dy<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"314\"></td><td><pre>                    <span class=\"token function\">updateConnectedNodes</span><span class=\"token punctuation\">(</span>sourceNode<span class=\"token punctuation\">,</span> dx<span class=\"token punctuation\">,</span> dy<span class=\"token punctuation\">,</span> visitedNodes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"315\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"316\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"317\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"318\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"319\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">determineLinkColor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sourceNode<span class=\"token punctuation\">,</span> targetNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"320\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sourceNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'pole'</span> <span class=\"token operator\">&amp;&amp;</span> targetNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'pole'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"321\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token string\">'#1e90ff'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"322\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sourceNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'station'</span> <span class=\"token operator\">&amp;&amp;</span> targetNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'station'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"323\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token string\">'green'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"324\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sourceNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'gateway'</span> <span class=\"token operator\">&amp;&amp;</span> targetNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'gateway'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"325\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"326\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"327\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token string\">'#7f8c8d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"328\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"329\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"330\"></td><td><pre>        <span class=\"token comment\">// 按钮事件处理</span></pre></td></tr><tr><td data-num=\"331\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">addNodeButton</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"332\"></td><td><pre>            nodeType <span class=\"token operator\">=</span> type<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"333\"></td><td><pre>            isAddingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"334\"></td><td><pre>            isAddingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"335\"></td><td><pre>            isDeletingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"336\"></td><td><pre>            isDeletingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"337\"></td><td><pre>            allDrag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"338\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"339\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"340\"></td><td><pre>        d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#addLinkButton\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"341\"></td><td><pre>            isAddingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"342\"></td><td><pre>            isAddingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"343\"></td><td><pre>            isDeletingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"344\"></td><td><pre>            isDeletingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"345\"></td><td><pre>            allDrag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"346\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"347\"></td><td><pre></pre></td></tr><tr><td data-num=\"348\"></td><td><pre>        d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#deleteNodeButton\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"349\"></td><td><pre>            isDeletingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"350\"></td><td><pre>            isAddingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"351\"></td><td><pre>            isAddingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"352\"></td><td><pre>            isDeletingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"353\"></td><td><pre>            allDrag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"354\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"355\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"356\"></td><td><pre>        d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#deleteLinkButton\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"357\"></td><td><pre>            isDeletingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"358\"></td><td><pre>            isAddingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"359\"></td><td><pre>            isAddingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"360\"></td><td><pre>            isDeletingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"361\"></td><td><pre>            allDrag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"362\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"363\"></td><td><pre>        <span class=\"token comment\">// 整体拖动</span></pre></td></tr><tr><td data-num=\"364\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">selectAllButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"365\"></td><td><pre>            isDeletingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"366\"></td><td><pre>            isAddingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"367\"></td><td><pre>            isAddingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"368\"></td><td><pre>            isDeletingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"369\"></td><td><pre>            allDrag <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"370\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"371\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"372\"></td><td><pre>       <span class=\"token comment\">// 打印节点信息</span></pre></td></tr><tr><td data-num=\"373\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">logNodeButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"374\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Node type:\"</span><span class=\"token punctuation\">,</span> nodeType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"375\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Adding node:\"</span><span class=\"token punctuation\">,</span> isAddingNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"376\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Adding link:\"</span><span class=\"token punctuation\">,</span> isAddingLink<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"377\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Deleting node:\"</span><span class=\"token punctuation\">,</span> isDeletingNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"378\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Deleting link:\"</span><span class=\"token punctuation\">,</span> isDeletingLink<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"379\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Nodes:\"</span><span class=\"token punctuation\">,</span> nodes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"380\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Links:\"</span><span class=\"token punctuation\">,</span> links<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"381\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"382\"></td><td><pre>        <span class=\"token comment\">// 生成 id</span></pre></td></tr><tr><td data-num=\"383\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">getUuid</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"384\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> crypto <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"385\"></td><td><pre>              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> crypto<span class=\"token punctuation\">.</span>randomUUID <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"386\"></td><td><pre>                <span class=\"token keyword\">return</span> crypto<span class=\"token punctuation\">.</span><span class=\"token function\">randomUUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"387\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"388\"></td><td><pre>              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> crypto<span class=\"token punctuation\">.</span>getRandomValues <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">typeof</span> Uint8Array <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"389\"></td><td><pre>                <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">callback</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"390\"></td><td><pre>                  <span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"391\"></td><td><pre>                  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>num <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>crypto<span class=\"token punctuation\">.</span><span class=\"token function\">getRandomValues</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">15</span> <span class=\"token operator\">>></span> <span class=\"token punctuation\">(</span>num <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"392\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"393\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1e7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token number\">1e3</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token number\">4e3</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token number\">8e3</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token number\">1e11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">[018]</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"394\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"395\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"396\"></td><td><pre>            <span class=\"token keyword\">let</span> timestamp <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"397\"></td><td><pre>            <span class=\"token keyword\">let</span> perforNow <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> performance <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span> <span class=\"token operator\">&amp;&amp;</span> performance<span class=\"token punctuation\">.</span>now <span class=\"token operator\">&amp;&amp;</span> performance<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"398\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token string\">'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">[xy]</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"399\"></td><td><pre>              <span class=\"token keyword\">let</span> random <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"400\"></td><td><pre>              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>timestamp <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"401\"></td><td><pre>                random <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>timestamp <span class=\"token operator\">+</span> random<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">16</span> <span class=\"token operator\">|</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"402\"></td><td><pre>                timestamp <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>timestamp <span class=\"token operator\">/</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"403\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"404\"></td><td><pre>                random <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>perforNow <span class=\"token operator\">+</span> random<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">16</span> <span class=\"token operator\">|</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"405\"></td><td><pre>                perforNow <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>perforNow <span class=\"token operator\">/</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"406\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"407\"></td><td><pre>              <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>c <span class=\"token operator\">===</span> <span class=\"token string\">'x'</span> <span class=\"token operator\">?</span> random <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>random <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token number\">0x8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"408\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"409\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"410\"></td><td><pre>        <span class=\"token comment\">// 选择节点的方法</span></pre></td></tr><tr><td data-num=\"411\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">selectButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"412\"></td><td><pre>            isDeletingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"413\"></td><td><pre>            isAddingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"414\"></td><td><pre>            isAddingLink <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"415\"></td><td><pre>            isDeletingNode <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"416\"></td><td><pre>            allDrag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"417\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"418\"></td><td><pre>        <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"419\"></td><td><pre>         * 更新指定线段的 stroke 属性</pre></td></tr><tr><td data-num=\"420\"></td><td><pre>         * @param &#123;string&#125; sourceId - 连线起点节点的 ID</pre></td></tr><tr><td data-num=\"421\"></td><td><pre>         * @param &#123;string&#125; targetId - 连线终点节点的 ID</pre></td></tr><tr><td data-num=\"422\"></td><td><pre>         * @param &#123;string&#125; color - 新的颜色值</pre></td></tr><tr><td data-num=\"423\"></td><td><pre>         */</span></pre></td></tr><tr><td data-num=\"424\"></td><td><pre>         <span class=\"token keyword\">function</span> <span class=\"token function\">updateLinkStroke</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sourceId<span class=\"token punctuation\">,</span> targetId<span class=\"token punctuation\">,</span> color</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"425\"></td><td><pre>            <span class=\"token comment\">// 查找指定起点和终点的连线</span></pre></td></tr><tr><td data-num=\"426\"></td><td><pre>            <span class=\"token keyword\">const</span> link <span class=\"token operator\">=</span> links<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">l</span> <span class=\"token operator\">=></span> l<span class=\"token punctuation\">.</span>source <span class=\"token operator\">===</span> sourceId <span class=\"token operator\">&amp;&amp;</span> l<span class=\"token punctuation\">.</span>target <span class=\"token operator\">===</span> targetId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"427\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"428\"></td><td><pre>                <span class=\"token comment\">// 更新连线的颜色属性</span></pre></td></tr><tr><td data-num=\"429\"></td><td><pre>                link<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> color<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"430\"></td><td><pre>                <span class=\"token comment\">// 使用 D3.js 选择器选择指定的连线，并更新其 stroke 属性</span></pre></td></tr><tr><td data-num=\"431\"></td><td><pre>                d3<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".line\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"432\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>source <span class=\"token operator\">===</span> sourceId <span class=\"token operator\">&amp;&amp;</span> d<span class=\"token punctuation\">.</span>target <span class=\"token operator\">===</span> targetId<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"433\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stroke\"</span><span class=\"token punctuation\">,</span> color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"434\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"435\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"436\"></td><td><pre></pre></td></tr><tr><td data-num=\"437\"></td><td><pre>         <span class=\"token comment\">// 颜色选择器事件处理</span></pre></td></tr><tr><td data-num=\"438\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">updateColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"439\"></td><td><pre>            <span class=\"token keyword\">const</span> colorPicker <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"colorPicker\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"440\"></td><td><pre>            selectedLink<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> colorPicker<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"441\"></td><td><pre>            <span class=\"token function\">updateLinkStroke</span><span class=\"token punctuation\">(</span>selectedLink<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">,</span> selectedLink<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">,</span> selectedLink<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"442\"></td><td><pre>            colorPicker<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"443\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"444\"></td><td><pre>        <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"445\"></td><td><pre>    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"446\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"447\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Ubuntu%E5%AE%89%E8%A3%85%E5%90%8E%E6%97%A0%E6%B3%95%E5%8A%A0%E8%BD%BD%E5%85%A8%E9%83%A8%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E9%97%AE%E9%A2%98/",
            "url": "https://obsidianlyg.github.io/Note/Ubuntu%E5%AE%89%E8%A3%85%E5%90%8E%E6%97%A0%E6%B3%95%E5%8A%A0%E8%BD%BD%E5%85%A8%E9%83%A8%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E9%97%AE%E9%A2%98/",
            "title": "Ubuntu安装后无法加载全部磁盘空间问题",
            "date_published": "2024-04-11T02:32:00.000Z",
            "content_html": "<h1 id=\"原因\"><a class=\"anchor\" href=\"#原因\">#</a> 原因</h1>\n<p>在安装 UbuntuServer 时由于第一次载入镜像选择默认镜像源，导致 apt 配置始终无法加载但已经自动分配好空间了，强制退出后重新选择镜像源重复默认安装步骤后没有手动分配空间，导致磁盘自动搜索剩余空间进行安装。</p>\n<h1 id=\"解决方案\"><a class=\"anchor\" href=\"#解决方案\">#</a> 解决方案</h1>\n<h3 id=\"查看当前卷组\"><a class=\"anchor\" href=\"#查看当前卷组\">#</a> 查看当前卷组</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> vgdisplay</pre></td></tr></table></figure><h3 id=\"扩展现有卷组\"><a class=\"anchor\" href=\"#扩展现有卷组\">#</a> 扩展现有卷组</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv</pre></td></tr></table></figure><h3 id=\"重新计算磁盘空间\"><a class=\"anchor\" href=\"#重新计算磁盘空间\">#</a> 重新计算磁盘空间</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv</pre></td></tr></table></figure><h1 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpdXRpdC9hcnRpY2xlL2RldGFpbHMvMTMyMzY0NjE2\">ubuntu 安装空间只有磁盘一半</span></p>\n",
            "tags": [
                "ubuntu"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E5%85%B3%E4%BA%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A2%AB%E5%85%A5%E4%BE%B5%E7%9A%84%E4%B8%AA%E4%BA%BA%E6%97%A5%E5%BF%97(%E2%94%AC%E2%94%AC%EF%B9%8F%E2%94%AC%E2%94%AC)/",
            "url": "https://obsidianlyg.github.io/Note/%E5%85%B3%E4%BA%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A2%AB%E5%85%A5%E4%BE%B5%E7%9A%84%E4%B8%AA%E4%BA%BA%E6%97%A5%E5%BF%97(%E2%94%AC%E2%94%AC%EF%B9%8F%E2%94%AC%E2%94%AC)/",
            "title": "关于服务器被入侵的个人日志(┬┬﹏┬┬)",
            "date_published": "2024-03-12T06:10:10.000Z",
            "content_html": "<h2 id=\"发现起因\"><a class=\"anchor\" href=\"#发现起因\">#</a> 发现起因</h2>\n<p>打开 htop 发现 cpu 占用过高，查找占用过高进程，发现有五个相同名称的杂乱英文字符的进程<br />\n普通用户无法进行删除，通过 root 删除后又会出现另一串占用 100% cpu 的杂乱英文字符进程，并且在 htop 中发现 systemd 进程，每 5s 重启一次，感觉是密码太简单了，赶紧先换密码再说</p>\n<h2 id=\"查看路径\"><a class=\"anchor\" href=\"#查看路径\">#</a> 查看路径</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x3YzU0MTExMTcvYXJ0aWNsZS9kZXRhaWxzLzg1MzQyMzk5\">参考链接</span><br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzOTIxNzUwL2FydGljbGUvZGV0YWlscy8xMTYzMzUzNjE=\">参考链接 2</span><br />\n 通过 htop 中获取的进程 pid 再用 <code>ll /proc/&lt;pid&gt;</code>  查看进程信息</p>\n<h2 id=\"解决问题\"><a class=\"anchor\" href=\"#解决问题\">#</a> 解决问题</h2>\n<p>查看前缀有 exe 的执行位置，进入后将相关内容进行删除即可<br />\n（由于本人过于好奇暂时用 mv 移入别处，经过查找发现是开源挖矿 XMRig 程序外加 systemd 启动脚本😑）<br />\n此时基本解决了 cpu 占用问题，重启后也不会启动了</p>\n",
            "tags": [
                "运维"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E5%B0%9D%E8%AF%95%E5%90%84%E7%A7%8D%E5%8F%AF%E4%BB%A5%E8%81%94%E7%BD%91%E7%9A%84AI/",
            "url": "https://obsidianlyg.github.io/Note/%E5%B0%9D%E8%AF%95%E5%90%84%E7%A7%8D%E5%8F%AF%E4%BB%A5%E8%81%94%E7%BD%91%E7%9A%84AI/",
            "title": "尝试各种可以联网的AI",
            "date_published": "2024-03-07T11:10:10.000Z",
            "content_html": "<h2 id=\"phind\"><a class=\"anchor\" href=\"#phind\">#</a> phind</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucGhpbmQuY29tLw==\">https://www.phind.com/</span><br />\n 搜索次数限制：无<br />\n内容左右分布：<br />\n右侧显示搜索引用文章地址链接以及大致内容缩略显示<br />\n左侧显示总结<br />\n<img data-src=\"https://raw.githubusercontent.com/obsidianlyg/gallery/master/image/20240308085845.png\" alt=\"\" /></p>\n<h2 id=\"perplexity\"><a class=\"anchor\" href=\"#perplexity\">#</a> perplexity</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucGVycGxleGl0eS5haS8=\">https://www.perplexity.ai/</span><br />\n 搜索次数限制：每四小时 5 次搜索<br />\n内容上下分层，样式如下：<br />\n<strong>Sources</strong><br />\n 显示引用文章地址链接<br />\n<strong> Answer</strong><br />\n 总结内容<br />\n<strong> Related</strong><br />\n 相关问题推荐<br />\n<img data-src=\"https://raw.githubusercontent.com/obsidianlyg/gallery/master/image/20240308085532.png\" alt=\"\" /></p>\n<h2 id=\"kaigi\"><a class=\"anchor\" href=\"#kaigi\">#</a> kaigi</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9rYWdpLmNvbS8=\">https://kagi.com/</span><br />\n 搜索次数限制：无<br />\n Kagi 的 AI 集成哲学强调 AI 应该在搜索相关的、定义明确的、闭合的上下文中使用，以增强搜索体验，而不是创建或替代它。<br />\n<img data-src=\"https://raw.githubusercontent.com/obsidianlyg/gallery/master/image/20240307190525.png\" alt=\"\" /></p>\n<h2 id=\"you\"><a class=\"anchor\" href=\"#you\">#</a> you</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly95b3UuY29tLw==\">https://you.com/</span><br />\n 搜索次数限制：smart 没有限制，其余全部 5 次<br />\n<img data-src=\"https://raw.githubusercontent.com/obsidianlyg/gallery/master/image/20240307190258.png\" alt=\"\" /></p>\n<h2 id=\"gemini\"><a class=\"anchor\" href=\"#gemini\">#</a> Gemini</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9nZW1pbmkuZ29vZ2xlLmNvbS9hcHA=\">https://gemini.google.com/app</span><br />\n 不支持国内（<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaGF0LmdnZW1pbmkucHJvLw==\">国内版本，但不支持传图</span>）<br />\n搜索次数限制：无<br />\n<img data-src=\"https://raw.githubusercontent.com/obsidianlyg/gallery/master/image/8593d8ef783a240db0c7249907260068.png\" alt=\"\" /></p>\n<h2 id=\"magi\"><a class=\"anchor\" href=\"#magi\">#</a> magi</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tYWdpLmFpLw==\">https://magi.ai/</span></p>\n<blockquote>\n<p>通过 you 搜索推荐的 ai 搜索引擎，主界面很炫酷，暂时还没有注册</p>\n</blockquote>\n<p>如果这些还不够？<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudG9vbGlmeS5haS96aC9jYXRlZ29yeS9haS1zZWFyY2gtZW5naW5l\">尝试更多</span></p>\n",
            "tags": [
                "ai"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BB%91%E5%AE%9A%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B7%B2%E6%9C%89%E8%B4%A6%E5%8F%B7/",
            "url": "https://obsidianlyg.github.io/Note/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BB%91%E5%AE%9A%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B7%B2%E6%9C%89%E8%B4%A6%E5%8F%B7/",
            "title": "微信公众号绑定后台服务器已有账号",
            "date_published": "2024-02-23T07:51:39.000Z",
            "content_html": "<h2 id=\"前置条件\"><a class=\"anchor\" href=\"#前置条件\">#</a> 前置条件</h2>\n<ol>\n<li>已认证<span class=\"exturl\" data-url=\"aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tLw==\">公众号</span> / 已申请<span class=\"exturl\" data-url=\"aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL2RlYnVnL2NnaS1iaW4vc2FuZGJveGluZm8/YWN0aW9uPXNob3dpbmZvJmFtcDt0PXNhbmRib3gvaW5kZXg=\">微信测试接口</span><br />\n公众号 -&gt; 设置与开发 -&gt; 基本配置中获取 appid 与 appsecret<br />\n 微信测试接口同理</li>\n<li>自己的服务器资源</li>\n<li>需要微信的接口，<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXJzLndlaXhpbi5xcS5jb20vZG9jL29mZmlhY2NvdW50L0Jhc2ljX0luZm9ybWF0aW9uL0dldF9hY2Nlc3NfdG9rZW4uaHRtbA==\">获取 access_token</span>、<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXJzLndlaXhpbi5xcS5jb20vZG9jL29mZmlhY2NvdW50L0FjY291bnRfTWFuYWdlbWVudC9HZW5lcmF0aW5nX2FfUGFyYW1ldHJpY19RUl9Db2RlLmh0bWw=\">生成带参数二维码</span>、获取二维码图片（GET 请求（请使用 https 协议）<span class=\"exturl\" data-url=\"aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL2NnaS1iaW4vc2hvd3FyY29kZT90aWNrZXQ9VElDS0VUJUVGJUJDJTg5\">https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=TICKET）</span></li>\n<li>建立数据库绑定表（对服务器中的用户与公众号的绑定）</li>\n</ol>\n<h2 id=\"maven插件\"><a class=\"anchor\" href=\"#maven插件\">#</a> maven 插件</h2>\n<p>下方代码用到的 XmlUtil 与 BeanUtil 需要该插件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- https://mvnrepository.com/artifact/cn.hutool/hutool-all --></span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>cn.hutool<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>hutool-all<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>5.8.25<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"具体代码\"><a class=\"anchor\" href=\"#具体代码\">#</a> 具体代码</h2>\n<h3 id=\"三个基础类\"><a class=\"anchor\" href=\"#三个基础类\">#</a> 三个基础类</h3>\n<p><strong>绑定类</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">WeChatBindModel</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseModel</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token comment\">/**  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        * 网站用户标识  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        */</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"user_id\"</span><span class=\"token punctuation\">,</span>columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"VARCHAR\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> userId<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">/**  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        * 公众号用户标识  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        */</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token annotation punctuation\">@Id</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"open_id\"</span><span class=\"token punctuation\">,</span>columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"VARCHAR\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> openId<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">/**  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        * 创建时间  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        */</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"create_time\"</span><span class=\"token punctuation\">,</span>columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"VARCHAR\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> createTime<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>消息类</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Data</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">WechatNotifyRequestVO</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">ToUserName</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">FromUserName</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">CreateTime</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">MsgType</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">MsgId</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">Event</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">EventKey</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">Ticket</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">Content</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>method 枚举类</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">enum</span> <span class=\"token class-name\">RequestMethodEnum</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">/** get*/</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">GET</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">/** post*/</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">POST</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Integer</span> code<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> desc<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token class-name\">RequestMethodEnum</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> id<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>code <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>desc <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Integer</span> <span class=\"token function\">getCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">return</span> code<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getDesc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">return</span> desc<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"微信接入服务器的接口\"><a class=\"anchor\" href=\"#微信接入服务器的接口\">#</a> 微信接入服务器的接口</h3>\n<p><strong>接口</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">checkSignature</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">String</span> xml<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">String</span> method <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">//get 方法，验证微信配置是否成功</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">RequestMethodEnum</span><span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">.</span><span class=\"token function\">getDesc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>method<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> signature <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"signature\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">/// 微信加密签名  </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">String</span> timestamp <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"timestamp\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">/// 时间戳  </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token class-name\">String</span> nonce <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"nonce\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/// 随机数  </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">String</span> echostr <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"echostr\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 随机字符串  </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">boolean</span> bool <span class=\"token operator\">=</span> <span class=\"token class-name\">TokenValidator</span><span class=\"token punctuation\">.</span><span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>signature<span class=\"token punctuation\">,</span> timestamp<span class=\"token punctuation\">,</span> nonce<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>bool<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            response<span class=\"token punctuation\">.</span><span class=\"token function\">getWriter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span>echostr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">//post 方法，用来接收微信返回的消息</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        wechatbindService<span class=\"token punctuation\">.</span><span class=\"token function\">notifyMsg</span><span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>验证类 TokenValidator</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageDigest</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">NoSuchAlgorithmException</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TokenValidator</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> TOKEN <span class=\"token operator\">=</span> <span class=\"token string\">\"FBuVsYCoPQxbPAFnrwZGRxTIWD\"</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> signature<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> timestamp<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> nonce<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> arr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#123;</span>TOKEN<span class=\"token punctuation\">,</span> timestamp<span class=\"token punctuation\">,</span> nonce<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">StringBuilder</span> sb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s <span class=\"token operator\">:</span> arr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>        <span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> sb<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">String</span> result <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token class-name\">MessageDigest</span> md <span class=\"token operator\">=</span> <span class=\"token class-name\">MessageDigest</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SHA-1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> digest <span class=\"token operator\">=</span> md<span class=\"token punctuation\">.</span><span class=\"token function\">digest</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            result <span class=\"token operator\">=</span> <span class=\"token function\">bytesToHex</span><span class=\"token punctuation\">(</span>digest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">NoSuchAlgorithmException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>signature<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">bytesToHex</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bytes<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token class-name\">StringBuilder</span> sb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span> b <span class=\"token operator\">:</span> bytes<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token class-name\">String</span> hex <span class=\"token operator\">=</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHexString</span><span class=\"token punctuation\">(</span>b <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hex<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>hex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>        <span class=\"token keyword\">return</span> sb<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"消息转译与绑定\"><a class=\"anchor\" href=\"#消息转译与绑定\">#</a> 消息转译与绑定</h3>\n<h4 id=\"主要思路\"><a class=\"anchor\" href=\"#主要思路\">#</a> 主要思路</h4>\n<ol>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXJzLndlaXhpbi5xcS5jb20vZG9jL29mZmlhY2NvdW50L0FjY291bnRfTWFuYWdlbWVudC9HZW5lcmF0aW5nX2FfUGFyYW1ldHJpY19RUl9Db2RlLmh0bWw=\">生成带参数二维码</span>中可以传入场景值数字或者字符串，假设当前服务器的用户标识为字符串，那么可以将对应的场景值传入字符串，也就是 userId (在 scene_str 中传入 id 即可)。</li>\n<li>生成的二维码在手机扫码后，会对服务器进行传值，将场景值与 openid 同时给到服务器进行绑定 (在 EventKey 中获取场景值)</li>\n</ol>\n<p><strong>传参样例</strong></p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"expire_seconds\"</span><span class=\"token operator\">:</span> <span class=\"token number\">604800</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"action_name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"QR_STR_SCENE\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"action_info\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"scene\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"scene_str\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"d30dadd6-7941-4759-8bca-87eae8e10437\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>返回样例</strong></p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>xml</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ToUserName</span><span class=\"token punctuation\">></span></span><span class=\"token cdata\">&lt;![CDATA[开发者ID]]></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ToUserName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FromUserName</span><span class=\"token punctuation\">></span></span><span class=\"token cdata\">&lt;![CDATA[openid]]></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FromUserName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>CreateTime</span><span class=\"token punctuation\">></span></span>1708652664<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>CreateTime</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MsgType</span><span class=\"token punctuation\">></span></span><span class=\"token cdata\">&lt;![CDATA[event]]></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>MsgType</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Event</span><span class=\"token punctuation\">></span></span><span class=\"token cdata\">&lt;![CDATA[subscribe]]></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Event</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>EventKey</span><span class=\"token punctuation\">></span></span><span class=\"token cdata\">&lt;![CDATA[d30dadd6-7941-4759-8bca-87eae8e10437]]></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>EventKey</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>xml</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p><strong>主要方法</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>rollbackFor <span class=\"token operator\">=</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">notifyMsg</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> xml<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"后台接收到公众号发来的数据是:\\n&#123;&#125;\"</span><span class=\"token punctuation\">,</span> xml<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// 把微信发送给后端的 xml 消息转成 WechatNotifyRequestVO 对象  </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">=</span> <span class=\"token class-name\">XmlUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">xmlToMap</span><span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">WechatNotifyRequestVO</span> notify <span class=\"token operator\">=</span> <span class=\"token class-name\">BeanUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">fillBeanWithMap</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WechatNotifyRequestVO</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// 绑定用户信息，不存在则插入，不匹配则更新  </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"notify \\n&#123;&#125;\"</span><span class=\"token punctuation\">,</span>notify<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">boolean</span> isBind <span class=\"token operator\">=</span> <span class=\"token function\">handleBindInfo</span><span class=\"token punctuation\">(</span>notify<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// 事件类型，subscribe 表示订阅，unsubscribe 表示取消订阅，null 表示用户发送消息过来  </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token class-name\">String</span> event <span class=\"token operator\">=</span> notify<span class=\"token punctuation\">.</span><span class=\"token function\">getEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token class-name\">String</span> content <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> <span class=\"token string\">\"subscribe\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户关注公众号了....\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// 欢迎语句  </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">returnResponse</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">,</span> notify<span class=\"token punctuation\">,</span> <span class=\"token string\">\"[Party]终于等到你！欢迎你的关注！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> <span class=\"token string\">\"unsubscribe\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户取消公众号的订阅了....\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token comment\">// 删除所绑定的用户信息  </span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBlank</span><span class=\"token punctuation\">(</span>notify<span class=\"token punctuation\">.</span><span class=\"token function\">getContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户发送消息过来，消息内容是：\"</span> <span class=\"token operator\">+</span> notify<span class=\"token punctuation\">.</span><span class=\"token function\">getContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token comment\">// 回复，可以回复表情，蓝色可点击链接文字等  </span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token comment\">// 收到消息自动回复  </span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token function\">returnResponse</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">,</span> notify<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/:sun已经收到您的消息~\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isBind<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token function\">returnResponse</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">,</span> notify<span class=\"token punctuation\">,</span> <span class=\"token string\">\"绑定成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>返回微信的方法</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">returnResponse</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">WechatNotifyRequestVO</span> wechatNotifyRequestVO<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> content<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-type\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"application/xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    response<span class=\"token punctuation\">.</span><span class=\"token function\">setCharacterEncoding</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UTF-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    response<span class=\"token punctuation\">.</span><span class=\"token function\">getWriter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token function\">getXmlReturnMsg</span><span class=\"token punctuation\">(</span>wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getFromUserName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getToUserName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>对返回的 xml 封装成一个方法</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getXmlReturnMsg</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> toUser<span class=\"token punctuation\">,</span><span class=\"token class-name\">String</span> fromUser<span class=\"token punctuation\">,</span><span class=\"token class-name\">Long</span> createTime<span class=\"token punctuation\">,</span><span class=\"token class-name\">String</span> content<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"&lt;xml>\\n\"</span> <span class=\"token operator\">+</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token string\">\"  &lt;ToUserName>&lt;![CDATA[\"</span><span class=\"token operator\">+</span>toUser<span class=\"token operator\">+</span><span class=\"token string\">\"]]>&lt;/ToUserName>\\n\"</span> <span class=\"token operator\">+</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token string\">\"  &lt;FromUserName>&lt;![CDATA[\"</span><span class=\"token operator\">+</span>fromUser<span class=\"token operator\">+</span><span class=\"token string\">\"]]>&lt;/FromUserName>\\n\"</span> <span class=\"token operator\">+</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token string\">\"  &lt;CreateTime>\"</span><span class=\"token operator\">+</span>createTime<span class=\"token operator\">+</span><span class=\"token string\">\"&lt;/CreateTime>\\n\"</span> <span class=\"token operator\">+</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token string\">\"  &lt;MsgType>&lt;![CDATA[text]]>&lt;/MsgType>\\n\"</span> <span class=\"token operator\">+</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token string\">\"  &lt;Content>&lt;![CDATA[\"</span><span class=\"token operator\">+</span>content<span class=\"token operator\">+</span><span class=\"token string\">\"]]>&lt;/Content>\\n\"</span> <span class=\"token operator\">+</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token string\">\"&lt;/xml>\"</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>对绑定信息的处理</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">handleBindInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WechatNotifyRequestVO</span> wechatNotifyRequestVO<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 判断是否是绑定信息  </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SCAN\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getEventKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token function\">saveBindInfo</span><span class=\"token punctuation\">(</span>wechatNotifyRequestVO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"subscribe\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getEventKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token function\">saveBindInfo</span><span class=\"token punctuation\">(</span>wechatNotifyRequestVO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">saveBindInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WechatNotifyRequestVO</span> wechatNotifyRequestVO<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// 获取二维码参数  </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token class-name\">String</span> userId <span class=\"token operator\">=</span> wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getEventKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// 如果 event 是 SCAN 则进行正则匹配  </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token class-name\">String</span> pattern <span class=\"token operator\">=</span> <span class=\"token string\">\"qrscene_(\\\\d+)\"</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token class-name\">Pattern</span> regexPattern <span class=\"token operator\">=</span> <span class=\"token class-name\">Pattern</span><span class=\"token punctuation\">.</span><span class=\"token function\">compile</span><span class=\"token punctuation\">(</span>pattern<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token class-name\">Matcher</span> matcher <span class=\"token operator\">=</span> regexPattern<span class=\"token punctuation\">.</span><span class=\"token function\">matcher</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>matcher<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        userId <span class=\"token operator\">=</span> matcher<span class=\"token punctuation\">.</span><span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\">// 获取 openid  </span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token class-name\">String</span> openId <span class=\"token operator\">=</span> wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getFromUserName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\">// 获取时间  </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token class-name\">String</span> time <span class=\"token operator\">=</span> wechatNotifyRequestVO<span class=\"token punctuation\">.</span><span class=\"token function\">getCreateTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token class-name\">WeChatBindModel</span> model <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WeChatBindModel</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">,</span> openId<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token class-name\">WeChatBindModel</span> existingModel <span class=\"token operator\">=</span> wechatbindRepo<span class=\"token punctuation\">.</span><span class=\"token function\">findByOpenId</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">getOpenId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>existingModel <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> existingModel<span class=\"token punctuation\">.</span><span class=\"token function\">getUserId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>existingModel <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        existingModel<span class=\"token punctuation\">.</span><span class=\"token function\">setUserId</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">getUserId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        existingModel<span class=\"token punctuation\">.</span><span class=\"token function\">setCreateTime</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">getCreateTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        wechatbindRepo<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>existingModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        wechatbindRepo<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3OTI4MDM4L2FydGljbGUvZGV0YWlscy8xMjM0MTY5NDc=\">参考链接</span></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Obsidian%E7%AC%94%E8%AE%B0%E8%BD%AF%E4%BB%B6%EF%BC%88%E6%8F%92%E4%BB%B6%E6%94%B6%E8%97%8F%EF%BC%89/",
            "url": "https://obsidianlyg.github.io/Note/Obsidian%E7%AC%94%E8%AE%B0%E8%BD%AF%E4%BB%B6%EF%BC%88%E6%8F%92%E4%BB%B6%E6%94%B6%E8%97%8F%EF%BC%89/",
            "title": "Obsidian笔记软件(插件收藏)",
            "date_published": "2024-02-23T03:20:39.000Z",
            "content_html": "<h3 id=\"快捷键\"><a class=\"anchor\" href=\"#快捷键\">#</a> 快捷键：</h3>\n<p>生成 properties  <code>ctrl + ;</code>  或者用 三个 <code>-</code></p>\n<h3 id=\"外观主题\"><a class=\"anchor\" href=\"#外观主题\">#</a> 外观主题：</h3>\n<ul>\n<li>AnuPpuccin（需要配合 StyleSetting 第三方插件使用 - 用于显示是否使用某种样式）</li>\n<li>Everforest （简洁但是很好看）</li>\n<li>Blue Topaz (配合 StyleSetting, 中文设置)</li>\n</ul>\n<h3 id=\"插件推荐\"><a class=\"anchor\" href=\"#插件推荐\">#</a> 插件推荐：</h3>\n<ul>\n<li>日历插件：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2xpYW1jYWluL29ic2lkaWFuLWNhbGVuZGFyLXBsdWdpbg==\">obsidian-calendar-plugin</span></li>\n<li>markdown 表格插件：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3Rncm9zaW5nZXIvYWR2YW5jZWQtdGFibGVzLW9ic2lkaWFu\">advanced-tables-obsidian</span></li>\n<li>卡片式显示多个 md 笔记：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2RlYXRoYXUvc2xpZGluZy1wYW5lcy1vYnNpZGlhbg==\">sliding-panes-obsidian</span></li>\n<li>每日计划（有个时间轴，X 点到 X 点干什么）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2x5bmNoamFtZXMvb2JzaWRpYW4tZGF5LXBsYW5uZXI=\">obsidian-day-planner</span></li>\n<li>云同步：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3JlbW90ZWx5LXNhdmUvcmVtb3RlbHktc2F2ZQ==\">remotely-save</span></li>\n<li>生成好看的图表：Charts</li>\n<li>图表显示 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2Nhcm9uY2hlbi9vYnNpZGlhbi1jaGFydHN2aWV3LXBsdWdpbg==\">obsidian-chartsview-plugin</span></li>\n<li>生成时间轴：timeliness</li>\n<li>本地文件共享到 notion 的插件 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0Vhc3lDaHJpcy9vYnNpZGlhbi10by1ub3Rpb24=\">obsidian-to-notion</span></li>\n<li>关于图片的管理 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0RhcmFrYWgvb2JzaWRpYW4tZ2FsbGVyeQ==\">obsidian-gallery</span></li>\n<li>跟微信读书联动的插件 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3poYW9ob25neHVhbi9vYnNpZGlhbi13ZXJlYWQtcGx1Z2lu\">obsidian-weread-plugin</span></li>\n<li>通过鼠标缩放图片大小 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL25pY29qZXNrZS9tb3VzZXdoZWVsLWltYWdlLXpvb20=\">mousewheel-image-zoom</span></li>\n<li>对于侧边栏大纲样式、搜索、换位的定义 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2d1b3BlbmdodWkvb2JzaWRpYW4tcXVpZXQtb3V0bGluZQ==\">obsidian-quiet-outline</span></li>\n<li>任务相关的面板设计 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3Jvb3ZvL29ic2lkaWFuLWNhcmQtYm9hcmQ=\">obsidian-card-board</span></li>\n<li>代码高亮 : <strong>Editor Syntax Highlight</strong></li>\n<li>插入 icon（<strong>Icon Shortcodes</strong>）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FpZGVubHgvb2JzaWRpYW4taWNvbi1zaG9ydGNvZGVz\">obsidian-card-board</span></li>\n<li>生成思维导图 mindmap （vscode 也有这个插件）</li>\n<li>快速书写 LaTeX（<strong><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FydGlzdGljYXQxL29ic2lkaWFuLWxhdGV4LXN1aXRl\">Latex Suite</span></strong>）\n<ul>\n<li>其中 xx 为 \\times (文档没说)</li>\n</ul>\n</li>\n<li>设置选项的搜索 <a href=\"https://github.com/javalent/settings-search\"><strong>settings-search</strong></a></li>\n<li>带有奇特主题的 UML 语法转图像 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2pvZXRoZWkvb2JzaWRpYW4tcGxhbnR1bWw=\">obsidian-plantuml</span></li>\n<li>好像能直接显示视频链接 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0ZIYWNoZXovb2JzaWRpYW4tY29udmVydC11cmwtdG8taWZyYW1l\">obsidian-convert-url-to-iframe</span></li>\n<li>多模块样式 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NrUm9iaW5zb24vbXVsdGktY29sdW1uLW1hcmtkb3du\">multi-column-markdown</span></li>\n<li>免费的数据同步插件 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3ZydG1yei9vYnNpZGlhbi1saXZlc3luYw==\">obsidian-livesync</span></li>\n<li>md 格式化 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NyaXN0aWFudmFzcXVlei9vYnNpZGlhbi1wcmV0dGlmeQ==\">obsidian-prettify</span></li>\n<li>文件夹卡片样式 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3hwZ28vb2JzaWRpYW4tZm9sZGVyLW5vdGUtcGx1Z2lu\">obsidian-folder-note-plugin</span></li>\n<li>顶部编辑栏（标题大小颜色等选项） <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1BLTS1lci9vYnNpZGlhbi1lZGl0aW5nLXRvb2xiYXI=\">obsidian-editing-toolbar</span></li>\n<li>类似 notion 中顶部图片以及标题 icon 显示 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL25vYXRwYWQvb2JzaWRpYW4tYmFubmVycw==\">obsidian-banners</span></li>\n<li>根据已有文件智能提示关联  <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3RhZGFzaGktYWlrYXdhL29ic2lkaWFuLXZhcmlvdXMtY29tcGxlbWVudHMtcGx1Z2lu\">obsidian-various-complements-plugin</span></li>\n<li>类似于 notion 的数据库模式 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3RyZXktd2FsbGlzL29ic2lkaWFuLWRhc2hib2FyZHM=\">obsidian-dashboards</span></li>\n<li>丰富右键菜单 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NoZXRhY2hpZXppa2V1em9yL2NNZW51LVBsdWdpbg==\">cMenu-Plugin</span></li>\n<li>在 obsidian 内看 pdf 做笔记：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2VsaWFzLXN1bmRxdmlzdC9vYnNpZGlhbi1hbm5vdGF0b3I=\">obsidian-annotator</span></li>\n<li>联动 picgo 剪切板上传图床：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3Jlbm11MTIzL29ic2lkaWFuLWltYWdlLWF1dG8tdXBsb2FkLXBsdWdpbg==\">obsidian-image-auto-upload-plugin</span></li>\n<li>Dataview（生成数据库图表）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2JsYWNrc21pdGhndS9vYnNpZGlhbi1kYXRhdmlldw==\">obsidian-dataview</span></li>\n<li>Obsidian Icon Folder（文件夹显示 icon）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0Zsb3JpYW5Xb2Vsa2kvb2JzaWRpYW4taWNvbi1mb2xkZXI=\">obsidian-icon-folder</span></li>\n<li><strong>MySnippets （显示在右下角，可添加别人 css 主题之后会显示选项按钮用于选择样式显示）</strong></li>\n<li>快速创建文件：QuickAdd\n<ul>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zc3BhaS5jb20vcG9zdC82OTM3NQ==\">参考文档</span></p>\n</li>\n<li>\n<p>template 的选项的用法</p>\n<ul>\n<li>\n<p>yaml 写法</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>---</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>title: <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>--swig￼0--<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token environment constant\">UID</span><span class=\"token builtin class-name\">:</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>--swig￼1--<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>aliases: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>tags: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>项目状态: 提案</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>主题: <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>--swig￼2--<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>date: <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>--swig￼3--<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>---</pre></td></tr></table></figure><ul>\n<li><code>&#123;&#123;NAME&#125;&#125;</code>  是文件名的写法</li>\n<li><code>&#123;&#123;VALUE:主题是什么？&#125;&#125;</code>  这种写法会作为一个提示输入弹窗，让我录入。</li>\n<li><code>&#123;&#123;DATE:YYYY-MM-DD HH:mm:ss&#125;&#125;</code>  在创建文件时会变成当前的年月日时分秒</li>\n</ul>\n</li>\n<li>\n<p>特殊格式语法：在模板中这样写，可以在新建时出现选择框。</p>\n</li>\n</ul>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>--swig￼7--<span class=\"token operator\">></span></pre></td></tr></table></figure></li>\n<li>\n<p>capture 的选项的用法</p>\n<ul>\n<li>指定文件，在内部直接插入模板的用法，语法同上 ，没有  <code>---</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>制作模板时生成的语法：</p>\n<ul>\n<li>\n<p>时间相关</p>\n<ul>\n<li><code>&#123;&#123;date&#125;&#125;</code>  默认 <code>YYYY-MM-DD</code></li>\n<li>可自定义为 <code>&#123;&#123;date:YYYY-MM-DD hh:mm:ss&#125;&#125;</code></li>\n<li><code>&#123;&#123;time&#125;&#125;</code>  默认 <code>hh:mm</code>  可与 date 连用</li>\n</ul>\n</li>\n<li>\n<p>双链用法</p>\n<ul>\n<li><code>[[页面名称]]</code></li>\n<li>或者直接按住相关标签拖动到编辑界面即可</li>\n</ul>\n</li>\n<li>\n<p><code>&#123;&#123;title&#125;&#125;</code>  会自动获取文件名生成标题</p>\n</li>\n<li>\n<p><code>tag:</code>  会生成在标签列表中</p>\n</li>\n<li>\n<p>特殊是语法：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token operator\">!</span>tip<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">!</span>后面的单词不同会出现不同的标识和背景颜色（默认有<span class=\"token number\">12</span>种样式）</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>同一行代表会显示相同的标识符和背景</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>note</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">abstract</span><span class=\"token punctuation\">,</span> summary<span class=\"token punctuation\">,</span> tldr</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>info<span class=\"token punctuation\">,</span> todo</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>tip<span class=\"token punctuation\">,</span> hint<span class=\"token punctuation\">,</span> important</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>success<span class=\"token punctuation\">,</span> check<span class=\"token punctuation\">,</span> done</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>question<span class=\"token punctuation\">,</span> help<span class=\"token punctuation\">,</span> faq</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>warning<span class=\"token punctuation\">,</span> caution<span class=\"token punctuation\">,</span> attention</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>failure<span class=\"token punctuation\">,</span> fail<span class=\"token punctuation\">,</span> missing</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>danger<span class=\"token punctuation\">,</span> error</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>bug</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>example</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>quote<span class=\"token punctuation\">,</span> cite</pre></td></tr></table></figure></li>\n<li>\n<p>关于附件存储问题</p>\n<p>由于将复制的图片会默认存储到根目录下导致文件冗杂</p>\n<p>可到设置中 <code>文件与连接</code> 内下方的 <code>附件默认存放路径</code>  选择 <code>当前文件所在文件夹下指定的子文件夹中</code></p>\n<p>选中后在下方填写对应文件夹名称即可</p>\n</li>\n</ul>\n",
            "tags": [
                "obsidian"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E5%85%B3%E4%BA%8Eobsidian%E7%9A%84%E5%85%8D%E8%B4%B9%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95/",
            "url": "https://obsidianlyg.github.io/Note/%E5%85%B3%E4%BA%8Eobsidian%E7%9A%84%E5%85%8D%E8%B4%B9%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95/",
            "title": "关于obsidian的免费同步方法",
            "date_published": "2024-02-22T03:05:39.000Z",
            "content_html": "<h2 id=\"前提条件\"><a class=\"anchor\" href=\"#前提条件\">#</a> 前提条件</h2>\n<p>下载插件 <a href=\"https://github.com/remotely-save/remotely-save\"> <code>Remotely Save</code> </a><br />\n 注册<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hY2NvdW50LnRlcmFjbG91ZC5qcC9SZWdpc3RGb3JtLnBocC9pbmRleC8=\"> infini-cloud 云端存储网站</span></p>\n<h2 id=\"配置云端存储\"><a class=\"anchor\" href=\"#配置云端存储\">#</a> 配置云端存储</h2>\n<p>注册 infini-cloud 后，进入 MyPage 页面在 <code>Apps Connection</code>  下勾选 Turn on Apps Connection<br />\n<a href=\"https://imgse.com/i/pFNkizq\"><img data-src=\"https://s11.ax1x.com/2024/02/22/pFNkizq.png\" alt=\"pFNkizq.png\" /></a></p>\n<h2 id=\"配置插件\"><a class=\"anchor\" href=\"#配置插件\">#</a> 配置插件</h2>\n<p>选择远程服务：Webdav<br />\n 服务器地址： <code>Apps Connection</code>  中的 URL<br />\n 用户名和密码对应 <code>Apps Connection</code>  的 ID 和 Password<br />\n 鉴权类型为：basic</p>\n<p><strong>配置完成后，点击侧边栏更新按钮即可同步</strong><br />\n<a href=\"https://imgse.com/i/pFNkYwD\"><img data-src=\"https://s11.ax1x.com/2024/02/22/pFNkYwD.png\" alt=\"pFNkYwD.png\" /></a></p>\n",
            "tags": [
                "obsidian"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/AutoHotkey%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/",
            "url": "https://obsidianlyg.github.io/Note/AutoHotkey%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/",
            "title": "AutoHotkey使用说明",
            "date_published": "2024-02-01T16:00:00.000Z",
            "content_html": "<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3ODE2OTIyL2FydGljbGUvZGV0YWlscy8xMzA4NDk3MjQ=\">参考文档</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYXV0b2hvdGtleS5jb20vZG9jcy92Mi9ob3d0by9SdW5FeGFtcGxlcy5odG0=\">官方文档（可以调整为中文）</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYXV0b2hvdGtleS5jb20v\">下载地址</span></p>\n<p>录入一个后缀为 <code>.ahk</code>  的文件，双击运行即可</p>\n<h2 id=\"基础配置\"><a class=\"anchor\" href=\"#基础配置\">#</a> 基础配置</h2>\n<blockquote>\n<p>如果同时存在 2.0 与 1.1 程序，需要提前在文件开头声明  <code>#Requires AutoHotkey v2.0</code></p>\n</blockquote>\n<p><strong>按键映射配置</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#Requires AutoHotkey v2.0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>CapsLock::Esc</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Esc::CapsLock</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>^Left::^<span class=\"token comment\">#Left</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>^Right::^<span class=\"token comment\">#Right</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">!</span>Left::Home</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">!</span>Right::End</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>+Del::+Ins</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>^Del::^Ins</pre></td></tr></table></figure><p><strong>鼠标按键循环切换虚拟桌面（v2）</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>XButton1:: <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    cur :<span class=\"token operator\">=</span> RegRead<span class=\"token punctuation\">(</span><span class=\"token string\">\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion<span class=\"token entity\" title=\"\\E\">\\E</span>xplorer\\VirtualDesktops\"</span>, <span class=\"token string\">\"CurrentVirtualDesktop\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    all :<span class=\"token operator\">=</span> RegRead<span class=\"token punctuation\">(</span><span class=\"token string\">\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion<span class=\"token entity\" title=\"\\E\">\\E</span>xplorer\\VirtualDesktops\"</span>, <span class=\"token string\">\"VirtualDesktopIDs\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    ix :<span class=\"token operator\">=</span> floor<span class=\"token punctuation\">(</span>InStr<span class=\"token punctuation\">(</span>all, cur<span class=\"token punctuation\">)</span> / strlen<span class=\"token punctuation\">(</span>cur<span class=\"token punctuation\">))</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    ixa :<span class=\"token operator\">=</span> floor<span class=\"token punctuation\">(</span>strlen<span class=\"token punctuation\">(</span>all<span class=\"token punctuation\">)</span> / strlen<span class=\"token punctuation\">(</span>cur<span class=\"token punctuation\">))</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">;</span> msgbox <span class=\"token string\">\"current desktop index:\"</span> ix</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">;</span> msgbox <span class=\"token string\">\"current desktop index:\"</span> ixa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ix <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        Loop <span class=\"token punctuation\">(</span>ixa - <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            Send <span class=\"token string\">\"^#&#123;Right&#125;\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            Sleep <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        Send <span class=\"token string\">\"^#&#123;Left&#125;\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>XButton2:: <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    cur :<span class=\"token operator\">=</span> RegRead<span class=\"token punctuation\">(</span><span class=\"token string\">\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion<span class=\"token entity\" title=\"\\E\">\\E</span>xplorer\\VirtualDesktops\"</span>, <span class=\"token string\">\"CurrentVirtualDesktop\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    all :<span class=\"token operator\">=</span> RegRead<span class=\"token punctuation\">(</span><span class=\"token string\">\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion<span class=\"token entity\" title=\"\\E\">\\E</span>xplorer\\VirtualDesktops\"</span>, <span class=\"token string\">\"VirtualDesktopIDs\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    ix :<span class=\"token operator\">=</span> floor<span class=\"token punctuation\">(</span>InStr<span class=\"token punctuation\">(</span>all, cur<span class=\"token punctuation\">)</span> / strlen<span class=\"token punctuation\">(</span>cur<span class=\"token punctuation\">))</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    ixa :<span class=\"token operator\">=</span> floor<span class=\"token punctuation\">(</span>strlen<span class=\"token punctuation\">(</span>all<span class=\"token punctuation\">)</span> / strlen<span class=\"token punctuation\">(</span>cur<span class=\"token punctuation\">))</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">;</span> msgbox <span class=\"token string\">\"current desktop index:\"</span> ix</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">;</span> msgbox <span class=\"token string\">\"current desktop index:\"</span> ixa</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ix <span class=\"token operator\">==</span> ixa - <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        Loop <span class=\"token punctuation\">(</span>ixa - <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            Send <span class=\"token string\">\"^#&#123;Left&#125;\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            Sleep <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        Send <span class=\"token string\">\"^#&#123;Right&#125;\"</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>在虚拟桌面之间移动应用 (v1.1)</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>^<span class=\"token operator\">!</span>Right::</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">;</span>获取活动窗口ID</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>WinGet, active_id, ID, A</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">;</span>在当前桌面隐藏该窗口</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>WinHide, ahk_id %active_id%</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">;</span>移动到下一个桌面并显示该窗口</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Send <span class=\"token comment\">#^&#123;Right&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>WinShow, ahk_id %active_id%</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">;</span>移动后激活当前窗口（可选）</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>WinActivate, ahk_id %active_id%</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">;</span>移回当前桌面（可选）</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">;</span>Send <span class=\"token comment\">#^&#123;Left&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token builtin class-name\">return</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>^<span class=\"token operator\">!</span>Left::</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>WinGet, active_id, ID, A</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>WinHide, ahk_id %active_id%</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>Send <span class=\"token comment\">#^&#123;Left&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>WinShow, ahk_id %active_id%</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>WinActivate, ahk_id %active_id%</pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">;</span>Send <span class=\"token comment\">#^&#123;Right&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token builtin class-name\">return</span></pre></td></tr></table></figure><p><strong>在虚拟桌面之间移动应用 (v2)</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#Requires AutoHotkey v2.0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>F11::<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    active_id :<span class=\"token operator\">=</span> WinGetID<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    WinHide active_id</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    Send <span class=\"token string\">\"^#&#123;Right&#125;\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    WinShow active_id</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    WinActivate active_id</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>F10::<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    active_id :<span class=\"token operator\">=</span> WinGetID<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    WinHide active_id</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    Send <span class=\"token string\">\"^#&#123;Left&#125;\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    WinShow active_id</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    WinActivate active_id</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"按键映射\"><a class=\"anchor\" href=\"#按键映射\">#</a> 按键映射</h2>\n<h3 id=\"功能键\"><a class=\"anchor\" href=\"#功能键\">#</a> <strong>功能键</strong></h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Win</th>\n<th style=\"text-align:center\">Alt</th>\n<th style=\"text-align:center\">Cltr</th>\n<th style=\"text-align:center\">Shift</th>\n<th style=\"text-align:center\">Alt Gr</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><code>#</code></td>\n<td style=\"text-align:center\"><code>!</code></td>\n<td style=\"text-align:center\"><code>^</code></td>\n<td style=\"text-align:center\"><code>+</code></td>\n<td style=\"text-align:center\"><code>&lt;^&gt;!</code></td>\n</tr>\n</tbody>\n</table>\n<p>其中， <code>&lt;, &gt;</code>  为修饰符，用于区分成对出现的按键，例如 <code>&lt;!</code>  表示左侧的 <code>Ctrl</code> 。按照这个逻辑理解， <code>&lt;^&gt;!</code>  应该表示左 <code>Ctrl</code>  + 右 <code>Alt</code> ，对于某些具有 <code>Alt Gr</code>  键的电脑而言，则专门指代这个按键。</p>\n<h3 id=\"键盘按键\"><a class=\"anchor\" href=\"#键盘按键\">#</a> 键盘按键</h3>\n<table>\n<thead>\n<tr>\n<th>按键</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>F1 - F24</td>\n<td>键盘顶部的 12 个或更多的功能键</td>\n</tr>\n<tr>\n<td>Up, Down, Left, Right</td>\n<td>上下左右方向键</td>\n</tr>\n<tr>\n<td>Space, Esc, BS, Del, Ins</td>\n<td>空格、退出、退格、删除、插入</td>\n</tr>\n<tr>\n<td>CapsLock, ScrollLock</td>\n<td>大小写锁定键、滚动锁定键</td>\n</tr>\n<tr>\n<td>Home, End, PgUp, PgDn</td>\n<td>Home 键，End 键，上下翻页键</td>\n</tr>\n<tr>\n<td>Tab, Enter</td>\n<td>Tab 键，回车键</td>\n</tr>\n<tr>\n<td>LWin, LShift, LAlt, LCtrl</td>\n<td>左 Win, Shift, Alt, Ctrl</td>\n</tr>\n<tr>\n<td>Numpad0-9</td>\n<td>数字键盘 0-9</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"语法v2\"><a class=\"anchor\" href=\"#语法v2\">#</a> 语法（v2）</h3>\n<p>显示消息弹窗</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">;</span> 可以字符串，可以是赋值，空格隔开</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>MsgBox <span class=\"token string\">\"The active window's ID is \"</span> active_id</pre></td></tr></table></figure><p>隐藏窗口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">;</span> 获取当前窗口id并进行隐藏</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>active_id :<span class=\"token operator\">=</span> WinGetID<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>WinHide active_id</pre></td></tr></table></figure><p>显示窗口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>WinShow active_id</pre></td></tr></table></figure><p>聚焦窗口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>WinActivate active_id</pre></td></tr></table></figure><p>发送指令</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Send <span class=\"token string\">\"^#Right\"</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Java%E4%B8%ADList%E9%9B%86%E5%90%88%E5%88%86%E9%A1%B5/",
            "url": "https://obsidianlyg.github.io/Note/Java%E4%B8%ADList%E9%9B%86%E5%90%88%E5%88%86%E9%A1%B5/",
            "title": "利用Java导入Excel到数据库",
            "date_published": "2023-12-05T06:43:39.000Z",
            "content_html": "<h3 id=\"使用stream-api进行分页\"><a class=\"anchor\" href=\"#使用stream-api进行分页\">#</a> 使用 stream api 进行分页</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> subList <span class=\"token operator\">=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">skip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>pageNo<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">toList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>pageNo 为当前页数，pageSize 为每页大小</p>\n<h3 id=\"配合jpa使用样例\"><a class=\"anchor\" href=\"#配合jpa使用样例\">#</a> 配合 JPA 使用样例</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">summaryList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IkgPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>page <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getPageSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token comment\">// 不分页全量查询  </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span> <span class=\"token operator\">==</span> page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                page <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IkgPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            page<span class=\"token punctuation\">.</span><span class=\"token function\">setPageNumber</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            page<span class=\"token punctuation\">.</span><span class=\"token function\">setPageSize</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span>MAX_VALUE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">//        Map&lt;String, Object> param = page.getParams();  </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">//        if (param != null) &#123;  </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">//  </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//        &#125;  </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">></span></span> summaryDTOList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> maps <span class=\"token operator\">=</span> bidmarginrecoveryRepo<span class=\"token punctuation\">.</span><span class=\"token function\">getSummary</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">:</span> maps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token class-name\">BidMarginSummaryDTO</span> dto <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BidMarginSummaryDTO</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setProjectId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"projectId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setCmpName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"collectionUnit\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setNextDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"nextDate\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">double</span> margin <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">double</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"margin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">double</span> currentAmount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">double</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"currentAmount\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">double</span> actualAmount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">double</span><span class=\"token punctuation\">)</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"actualAmount\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token comment\">// 保证金  </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setApplyAmount</span><span class=\"token punctuation\">(</span>margin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token comment\">// 保证金申请的实交金额  </span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setActualAmount</span><span class=\"token punctuation\">(</span>actualAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token comment\">// 已回收金额  </span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setRecoveryAmount</span><span class=\"token punctuation\">(</span>currentAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token comment\">// 未回收金额  </span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            dto<span class=\"token punctuation\">.</span><span class=\"token function\">setNotRecoveryAmount</span><span class=\"token punctuation\">(</span>margin<span class=\"token operator\">-</span>currentAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            summaryDTOList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>dto<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">int</span> total <span class=\"token operator\">=</span> summaryDTOList<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">int</span> pageSize <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getPageSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">int</span> pageNo <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getPageNumber</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">//        int pageSum = (total -1) / pageSize +1;  </span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        page<span class=\"token punctuation\">.</span><span class=\"token function\">setTotal</span><span class=\"token punctuation\">(</span>total<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        page<span class=\"token punctuation\">.</span><span class=\"token function\">setRows</span><span class=\"token punctuation\">(</span>summaryDTOList<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">skip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>pageNo <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span>pageSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">toList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">return</span> page<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpdXhpYW83MjM4NDYvYXJ0aWNsZS9kZXRhaWxzLzExNjIxMDY2MA==\">参考链接</span></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/SpringBoot%E4%B8%8B%E4%BD%BF%E7%94%A8Quartz%E8%AE%BE%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/",
            "url": "https://obsidianlyg.github.io/Note/SpringBoot%E4%B8%8B%E4%BD%BF%E7%94%A8Quartz%E8%AE%BE%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/",
            "title": "SpringBoot下使用Quartz设置定时任务",
            "date_published": "2023-11-28T03:46:00.000Z",
            "content_html": "<h3 id=\"基础使用\"><a class=\"anchor\" href=\"#基础使用\">#</a> <strong>基础使用</strong></h3>\n<p>Quartz 的核心类有以下三部分：</p>\n<ul>\n<li><strong>任务 Job ：</strong> 需要实现的任务类，实现  <code>execute()</code>  方法，执行后完成任务。</li>\n<li><strong>触发器 Trigger ：</strong> 包括  <code>SimpleTrigger</code>  和  <code>CronTrigger</code> 。</li>\n<li><strong>调度器 Scheduler ：</strong> 任务调度器，负责基于  <code>Trigger</code>  触发器，来执行 Job 任务。</li>\n</ul>\n<h3 id=\"添加依赖\"><a class=\"anchor\" href=\"#添加依赖\">#</a> 添加依赖</h3>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- 核心包 --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.quartz-scheduler<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>quartz<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.3.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">&lt;!-- 工具包 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.quartz-scheduler<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>quartz-jobs<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.3.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"demo\"><a class=\"anchor\" href=\"#demo\">#</a> demo</h3>\n<p>QuartzConfig 类<br />\n这个类用来进行任务描述，进行定时执行并将对应的执行逻辑类进行绑定</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">/**  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre> * 定义任务描述和具体的执行时间  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre> */</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">QuartzConfig</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JobDetail</span> <span class=\"token function\">jobDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 指定任务描述具体的实现类  </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">JobBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">newJob</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IDCardWarningJob</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token comment\">// 指定任务的名称  </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">withIdentity</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"IDCardWarningJob\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token comment\">// 任务描述  </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">withDescription</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"任务描述：身份预警更新表\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token comment\">// 每次任务执行后进行存储  </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">storeDurably</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Trigger</span> <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token comment\">// 创建触发器  </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">TriggerBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">newTrigger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token comment\">// 绑定工作任务  </span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">forJob</span><span class=\"token punctuation\">(</span><span class=\"token function\">jobDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">//                .withSchedule (CronScheduleBuilder.dailyAtHourAndMinute (1, 0))  // 设置每天凌晨 1 点触发一次任务  </span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">withSchedule</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CronScheduleBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">cronSchedule</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0 0 1 * * ?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">// 设置每天凌晨 1 点触发一次任务  </span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>demoJob 类<br />\n这个类负责定时任务的逻辑处理（execute 方法中写代码逻辑）</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>alibaba<span class=\"token punctuation\">.</span>druid<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>logging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Log</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>alibaba<span class=\"token punctuation\">.</span>druid<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>logging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LogFactory</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>iknight<span class=\"token punctuation\">.</span>cost<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IdentityWarningService</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Job</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JobExecutionContext</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>quartz<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JobExecutionException</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Autowired</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">IDCardWarningJob</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Job</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Log</span> logger <span class=\"token operator\">=</span> <span class=\"token class-name\">LogFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLog</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IDCardWarningJob</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token annotation punctuation\">@Autowired</span>  </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">IdentityWarningService</span> service<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setClaimPostServiceImpl</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IdentityWarningService</span> service<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>service <span class=\"token operator\">=</span> service<span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JobExecutionContext</span> context<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">JobExecutionException</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        service<span class=\"token punctuation\">.</span><span class=\"token function\">updateDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>关于 cron 表达式可以跳转这个连接 -&gt;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9xcWUyLmNvbS9jcm9u\"> 表达式生成器</span></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E9%80%9A%E8%BF%87Java%E5%AF%BC%E5%85%A5Excel/",
            "url": "https://obsidianlyg.github.io/Note/%E9%80%9A%E8%BF%87Java%E5%AF%BC%E5%85%A5Excel/",
            "title": "利用Java导入Excel到数据库",
            "date_published": "2023-08-02T09:05:39.000Z",
            "content_html": "<h1 id=\"esayexcel的使用\"><a class=\"anchor\" href=\"#esayexcel的使用\">#</a> EsayExcel 的使用</h1>\n<h2 id=\"引入依赖\"><a class=\"anchor\" href=\"#引入依赖\">#</a> 引入依赖</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.alibaba<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>easyexcel<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.1.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"类属性中的注解\"><a class=\"anchor\" href=\"#类属性中的注解\">#</a> 类属性中的注解</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># 默认下标从<span class=\"token number\">0</span>开始，index可以不填，value值必填</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"excel名称\"</span><span class=\"token punctuation\">,</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre># 可以识别多行字段</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品价格\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre># 忽略该属性</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token annotation punctuation\">@ExcelIgnore</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> sex<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"代码部分\"><a class=\"anchor\" href=\"#代码部分\">#</a> 代码部分</h2>\n<p>在 Service 中的代码如下</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">importExcel</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MultipartFile</span> file<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Boolean</span> keep<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token comment\">// 获取文件流</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token class-name\">InputStream</span> inputStream <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token comment\">//easyExcel 导入文件</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token class-name\">EasyExcel</span><span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>inputStream<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EmployeeModel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EmpImportListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> pubCodeRepo<span class=\"token punctuation\">,</span> orgRepo<span class=\"token punctuation\">,</span> keep<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">sheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">doRead</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>若 Excel 中只有第一行有标题可以去除 head 与 headRowNumber 方法</strong><br />\n SyncLineLossImportListener 类</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SyncLineLossImportListener</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AnalysisEventListener</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TPowerSyncLineLoss</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Logger</span> LOGGER <span class=\"token operator\">=</span> <span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SyncLineLossImportListener</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     * 每隔 5 条存储数据库，实际使用中可以 3000 条，然后清理 list ，方便内存回收</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> BATCH_COUNT <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TPowerSyncLineLoss</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">ListUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayListWithExpectedSize</span><span class=\"token punctuation\">(</span>BATCH_COUNT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     * 如果使用了 spring, 请使用这个构造方法。每次创建 Listener 的时候需要把 spring 管理的类传进来</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">TPowerSyncLineLossService</span> tPowerSyncLineLossService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> dataDate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SyncLineLossImportListener</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TPowerSyncLineLossService</span> tPowerSyncLineLossService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tPowerSyncLineLossService <span class=\"token operator\">=</span> tPowerSyncLineLossService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SyncLineLossImportListener</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TPowerSyncLineLossService</span> tPowerSyncLineLossService<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> dataDate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tPowerSyncLineLossService <span class=\"token operator\">=</span> tPowerSyncLineLossService<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataDate <span class=\"token operator\">=</span> dataDate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TPowerSyncLineLoss</span> syncLineLoss<span class=\"token punctuation\">,</span> <span class=\"token class-name\">AnalysisContext</span> analysisContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"解析到一条数据:&#123;&#125;\"</span><span class=\"token punctuation\">,</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>syncLineLoss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>syncLineLoss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token comment\">// 达到 BATCH_COUNT 了，需要去存储一次数据库，防止数据几万条数据在内存，容易 OOM</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> BATCH_COUNT<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token function\">saveData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token comment\">// 存储完成清理 list</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            list <span class=\"token operator\">=</span> <span class=\"token class-name\">ListUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayListWithExpectedSize</span><span class=\"token punctuation\">(</span>BATCH_COUNT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>     * 所有数据解析完成了 都会来调用</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>     *</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>     * @param context</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">doAfterAllAnalysed</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AnalysisContext</span> context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token comment\">// 这里也要保存数据，确保最后遗留的数据也存储到数据库</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token function\">saveData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"所有数据解析完成！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>     * 加上存储数据库</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">saveData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;&#125;条数据，开始存储数据库！\"</span><span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>tmp<span class=\"token operator\">-></span><span class=\"token punctuation\">&#123;</span>tmp<span class=\"token punctuation\">.</span><span class=\"token function\">setDataDate</span><span class=\"token punctuation\">(</span>dataDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        tPowerSyncLineLossService<span class=\"token punctuation\">.</span><span class=\"token function\">saveBatch</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        LOGGER<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"存储数据库成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>设置二级表头<br />\n在需要合并单元格的属性上设置  <code>@ExcelMerge</code>  注解，二级表头通过设置  <code>@ExcelProperty</code>  注解中 <strong>value</strong> 值为数组形式来实现该效果：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @author william@StarImmortal</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token annotation punctuation\">@Data</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderBO</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"订单主键\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> isPrimaryKey <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> id<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"订单编号\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> orderId<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"收货地址\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> address<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"创建时间\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token annotation punctuation\">@DateTimeFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yyyy-MM-dd HH:mm:ss\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelMerge</span><span class=\"token punctuation\">(</span>merge <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Date</span> createTime<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品编号\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> productId<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品名称\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品标题\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> subtitle<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"品牌名称\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> brandName<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品价格\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">BigDecimal</span> price<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token annotation punctuation\">@ExcelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"商品信息\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"商品数量\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token annotation punctuation\">@ColumnWidth</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> count<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxOTkxNjU4OTIzL2FydGljbGUvZGV0YWlscy8xMjgxNTMwMTI=\">导入导出参考连接</span></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/ventoy%E4%B8%BB%E9%A2%98%E6%B5%8B%E8%AF%95/",
            "url": "https://obsidianlyg.github.io/Note/ventoy%E4%B8%BB%E9%A2%98%E6%B5%8B%E8%AF%95/",
            "title": "ventoy主题配置并测试",
            "date_published": "2022-07-14T05:11:45.000Z",
            "content_html": "<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmVudG95Lm5ldC9jbi9kb3dubG9hZC5odG1s\">ventoy 下载地址</span></p>\n<h2 id=\"准备工作\"><a class=\"anchor\" href=\"#准备工作\">#</a> 准备工作</h2>\n<p>ventoy 软件</p>\n<p>安装好 ventoy 的 u 盘</p>\n<p>安装好 VMware</p>\n<p>选好主题（<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ25vbWUtbG9vay5vcmcvYnJvd3NlP2NhdD0xMDkmYW1wO29yZD1yYXRpbmc=\">主题链接</span>）</p>\n<h2 id=\"配置\"><a class=\"anchor\" href=\"#配置\">#</a> 配置</h2>\n<ol>\n<li>将主题包解压并放到 U 盘里</li>\n<li>打开 ventoy 安装位置，点击 VentoyPlugson.exe 启动插件并启动（启动后会弹出 web 配置界面）</li>\n<li>选择主题插件选项 -&gt; 主题配置文件栏点击新增 -&gt; 输入完整的绝对路径并确定</li>\n<li>停止并退出插件 -&gt;<img data-src=\"https://i.imgtg.com/2023/06/27/OkzsLg.png\" alt=\"image-20220714133001837\" /></li>\n</ol>\n<h2 id=\"测试\"><a class=\"anchor\" href=\"#测试\">#</a> 测试</h2>\n<p>打开 VMware 新建虚拟机（基本新建步骤不做介绍，可自行百度）</p>\n<p>关键步骤：</p>\n<ul>\n<li>\n<p>点击编辑虚拟机设置 -&gt; 硬件选项 -&gt; 点击添加 -&gt; 点击硬盘</p>\n</li>\n<li>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/Okz8cC.png\" alt=\"image-20220714133943441\" /></p>\n</li>\n<li>\n<p>选择 SATA→使用物理磁盘 →设备一般选最后一个，之后一直下一步完成即可</p>\n</li>\n<li>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/OkzuOL.png\" alt=\"image-20220714142328396\" /></p>\n</li>\n<li>\n<p>最上边绿色三角，选择打开电源时进入固件</p>\n</li>\n<li>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/OkzINi.png\" alt=\"image-20220714134305864\" /></p>\n</li>\n<li>\n<p>最后开启虚拟机即可看到主题啦（温馨提示：更新完主题配置，重启虚拟机才能看到更新后的内容）</p>\n</li>\n</ul>\n<p><img data-src=\"https://i.imgtg.com/2023/06/27/Okz3LX.png\" alt=\"image-20220714134421036\" /></p>\n",
            "tags": [
                "linux"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Linux%E5%A4%87%E4%BB%BD%EF%BC%88Rsnapshot%EF%BC%89/",
            "url": "https://obsidianlyg.github.io/Note/Linux%E5%A4%87%E4%BB%BD%EF%BC%88Rsnapshot%EF%BC%89/",
            "title": "Linux备份（Rsnapshot）",
            "date_published": "2022-07-04T01:04:52.000Z",
            "content_html": "<h1 id=\"linux备份rsnapshot\"><a class=\"anchor\" href=\"#linux备份rsnapshot\">#</a> Linux 备份（Rsnapshot）</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudHh1dy50b3AvYXJ0aWNsZS9yc25hcHNob3Q=\">参考链接</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NodXlhbndlbjg1MDcvYXJ0aWNsZS9kZXRhaWxzLzEwMDkwNjk5MA==\">参考链接 2</span></p>\n<h3 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h3>\n<p><code>apt install rsnapshot rsync</code></p>\n<h3 id=\"修改配置文件\"><a class=\"anchor\" href=\"#修改配置文件\">#</a> 修改配置文件</h3>\n<p><code>vim /etc/rsnapshot.conf</code></p>\n<blockquote>\n<p>特别注意配置文件对 tab 有着严格的要求，建议复制内部自带的 tab 进行编写</p>\n</blockquote>\n<ul>\n<li>编写配置\n<ul>\n<li>\n<p><code>snapshot_root</code>  指定一个备份目录</p>\n</li>\n<li>\n<p><code>cmd_ssh</code>  允许远程备份（直接取消注释即可）</p>\n</li>\n<li>\n<p>指定备份保留数量</p>\n<p>如下所示，其中的 <code>hourly</code>  参数是名称，后面数值对应备份保留数量</p>\n<p>对于备份，采用的是增量备份，无需担心过多的频率带来的额外空间开销</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#########################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#           BACKUP INTERVALS            #</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># Must be unique and in ascending order #</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># i.e. alpha, beta, gamma, etc.      #</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#########################################</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>retain\thourly\t<span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>retain\tdaily\t<span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>retain\tweekly\t<span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>retain\tmonthly\t<span class=\"token number\">2</span></pre></td></tr></table></figure></li>\n<li>\n<p>指定当前服务器的 SSH 端口</p>\n<p>若更改了 SSH 默认端口，需要指定远程备份服务器的端口号，否则不变即可</p>\n<p><code>ssh_args -p xxxx</code></p>\n</li>\n<li>\n<p>备份目录</p>\n<p>对于本地备份，直接指定路径即可</p>\n<blockquote>\n<p>注意最后要添加 / 进行路径闭合，不然语法检查不通过</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 本地备份路径</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>backup        /       localhost/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>backup        /etc/       localhost/</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 远程备份</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>backup         root@example.com:/home/         /data/backup/</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 排除不需要的目录，多个可用逗号隔开</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>backup        /       localhost/       <span class=\"token assign-left variable\">exclude</span><span class=\"token operator\">=</span>/mnt1,exclude<span class=\"token operator\">=</span>/mnt2,exclude<span class=\"token operator\">=</span>/mnt3</pre></td></tr></table></figure></li>\n<li>\n<p>配置概览</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>config_version\t<span class=\"token number\">1.2</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>snapshot_root\t/mnt3/back_up/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>cmd_cp\t\t/bin/cp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>cmd_rm\t\t/bin/rm</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>cmd_rsync\t/usr/bin/rsync</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>cmd_logger\t/usr/bin/logger</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>retain\thourly\t<span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>retain\tdaily\t<span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>retain\tweekly\t<span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>retain\tmonthly\t<span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>verbose\t\t<span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>loglevel\t<span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>lockfile\t/var/run/rsnapshot.pid</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>backup\t/\t\tlocalhost/\t<span class=\"token assign-left variable\">exclude</span><span class=\"token operator\">=</span>/mnt1,exclude<span class=\"token operator\">=</span>/mnt2,exclude<span class=\"token operator\">=</span>/mnt3</pre></td></tr></table></figure></li>\n<li>\n<p>参数解释</p>\n<ol>\n<li><code>config_version 1.2</code> = 配置文件版本</li>\n<li><code>snapshot_root</code> = 存储快照的备份目的地</li>\n<li><code>cmd_cp</code> = 复制命令的路径</li>\n<li><code>cmd_rm</code> = 删除命令的路径</li>\n<li><code>cmd_rsync</code> = rsync 的路径</li>\n<li><code>cmd_ssh</code> = SSH 路径</li>\n<li><code>cmd_logger</code> = shell 命令接口到 syslog 的路径</li>\n<li><code>cmd_du</code> = 磁盘使用命令的路径</li>\n<li><code>interval hourly</code> = 要保留多少小时的备份。</li>\n<li><code>interval daily</code> = 要保留多少每日备份。</li>\n<li><code>interval weekly</code> = 要保留多少每周备份。</li>\n<li><code>interval monthly</code> = 每月要保留多少备份。</li>\n<li><code>ssh_args</code> = 可选的 SSH 参数，例如不同的端口 (-p)</li>\n<li><code>verbose</code> = verbose</li>\n<li><code>loglevel</code> = loglevel</li>\n<li><code>logfile</code> = 日志文件的路径</li>\n<li><code>exclude_file</code> = 排除文件的路径（将更详细地解释）</li>\n<li><code>rsync_long_args</code> = 传递给 rsync 的长参数</li>\n<li><code>lockfile</code> = lockfile</li>\n<li><code>backup</code> = 要备份的内容的完整路径，然后是放置的相对路径。</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<p>对配置文件的语法测试</p>\n<p><code>rsnapshot configtest</code></p>\n<p>测试当前配置，但不使其生效</p>\n<p>rsnapshot -t hourly</p>\n<h3 id=\"执行备份\"><a class=\"anchor\" href=\"#执行备份\">#</a> 执行备份</h3>\n<p><code>rsnapshot hourly</code></p>\n<h3 id=\"自动化流程\"><a class=\"anchor\" href=\"#自动化流程\">#</a> <strong>自动化流程</strong></h3>\n<p>使流程自动化，你需要安排 rsnapshot 以一定的时间间隔运行 Cron. 默认情况下，rsnapshot 自带 cron 文件在  <code>/etc/cron.d/rsnapshot</code> <br />\n，如果它不存在，则创建一个并向其添加以下几行。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># This is a sample cron file for rsnapshot.</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># The values used correspond to the examples in /etc/rsnapshot.conf.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># There you can also set the backup points and many other things.</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># To activate this cron file you have to uncomment the lines below.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># Feel free to adapt it to your needs.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">0</span>     */12    * * *    root    /usr/bin/rsnapshot hourly</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">30</span>     <span class=\"token number\">3</span>     * * *    root    /usr/bin/rsnapshot daily</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">15</span>     <span class=\"token number\">3</span>     * * <span class=\"token number\">1</span>    root    /usr/bin/rsnapshot weekly</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">30</span>     <span class=\"token number\">2</span>     <span class=\"token number\">1</span> * *    root    /usr/bin/rsnapshot monthly</pre></td></tr></table></figure><blockquote>\n<p>实际上可以直接输入 <code>crontab -e</code>  之后直接编辑即可</p>\n</blockquote>\n",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/about/",
            "url": "https://obsidianlyg.github.io/about/",
            "title": "关于个人",
            "date_published": "2022-06-26T16:00:00.000Z",
            "content_html": "<h1 id=\"本鱼\"><a class=\"anchor\" href=\"#本鱼\">#</a> 本鱼</h1>\n<p>昵称：鲈鱼</p>\n<p>性别：男</p>\n<p>个人 QQ：879142964</p>\n<hr />\n<p>简介：</p>\n<ul>\n<li>爱好：硬要说的话就是，本鱼特别喜欢听音乐，<br />\n特别是纯音乐，当然其他音乐也是可以接受的，<br />\n音乐类型偏向轻柔吧。<br />\n特别是在做事情的时候，很喜欢听音乐。</li>\n</ul>\n",
            "tags": [
                "about"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Ubuntu%E6%8D%A2%E6%BA%90/",
            "url": "https://obsidianlyg.github.io/Note/Ubuntu%E6%8D%A2%E6%BA%90/",
            "title": "Ubuntu笔记",
            "date_published": "2022-05-01T02:29:28.000Z",
            "content_html": "<h2 id=\"查看信息\"><a class=\"anchor\" href=\"#查看信息\">#</a> 查看信息</h2>\n<p>查看完整整的 Ubuntu 系统信息：cat /proc/version</p>\n<p>查看列表型系统版本信息：lsb_release -a</p>\n<h2 id=\"换源\"><a class=\"anchor\" href=\"#换源\">#</a> 换源</h2>\n<p>Ubuntu 系统中，软件源文件地址为：/etc/apt/sources.list</p>\n<p>替换文件内容</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#添加阿里源</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#添加清华源</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse multiverse</span></pre></td></tr></table></figure><h2 id=\"ssh允许远程root连接\"><a class=\"anchor\" href=\"#ssh允许远程root连接\">#</a> ssh 允许远程 root 连接</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/ssh/sshd_config</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PermitRootLogin <span class=\"token function\">yes</span></pre></td></tr></table></figure><h2 id=\"修改root密码\"><a class=\"anchor\" href=\"#修改root密码\">#</a> 修改 root 密码</h2>\n<p><code>sudo passwd root</code></p>\n<h2 id=\"删除用户\"><a class=\"anchor\" href=\"#删除用户\">#</a> 删除用户</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#删除用户（在 root 权限下）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">userdel</span> -f <span class=\"token punctuation\">(</span>强制删除用户<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">userdel</span> -r <span class=\"token punctuation\">(</span>同时删除用户以及家目录<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">userdel</span> -fr xiyang</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#查看指定位置文件最后一行</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">tail</span> -1 /etc/passwd</pre></td></tr></table></figure><h2 id=\"解决启动终端无法加载bashrc导致文件无法高亮\"><a class=\"anchor\" href=\"#解决启动终端无法加载bashrc导致文件无法高亮\">#</a> 解决启动终端无法加载.bashrc 导致文件无法高亮</h2>\n<p>添加.bash_profile</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token builtin class-name\">test</span> -f .bashrc <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">source</span> .bashrc</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">fi</span></pre></td></tr></table></figure>",
            "tags": [
                "ubuntu"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/maven%E9%85%8D%E7%BD%AE/",
            "url": "https://obsidianlyg.github.io/Note/maven%E9%85%8D%E7%BD%AE/",
            "title": "maven基础配置",
            "date_published": "2022-04-30T05:30:58.000Z",
            "content_html": "<ol>\n<li>\n<p>打开安装的 maven 的 setting.xml</p>\n</li>\n<li>\n<p>修改仓库位置 - localRepository 标签 (改成自己想改的位置)</p>\n</li>\n<li>\n<p>在 mirrors 标签添加</p>\n</li>\n</ol>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>alimaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>aliyun maven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://maven.aliyun.com/nexus/content/repositories/central/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>repo1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>central<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>central repo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://repo1.maven.org/maven2/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>aliyunmaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mirrorOf</span><span class=\"token punctuation\">></span></span>apache snapshots<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirrorOf</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>阿里云阿帕奇仓库<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://maven.aliyun.com/repository/apache-snapshots<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mirror</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><ol start=\"4\">\n<li>在 profiles 标签添加</li>\n</ol>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>profile</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repositories</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>aliyunmaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>aliyunmaven<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://maven.aliyun.com/repository/public<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>layout</span><span class=\"token punctuation\">></span></span>default<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>layout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>releases</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>enabled</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>enabled</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>snapshots</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>MavenCentral<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>http://repo1.maven.org/maven2/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>aliyunmavenApache<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>https://maven.aliyun.com/repository/apache-snapshots<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repository</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>repositories</span><span class=\"token punctuation\">></span></span>             </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>profile</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure>",
            "tags": [
                "maven"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/Jenkins%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/",
            "url": "https://obsidianlyg.github.io/Note/Jenkins%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/",
            "title": "Jenkins安装及使用",
            "date_published": "2022-04-30T04:54:43.000Z",
            "content_html": "<h1 id=\"jenkins安装及使用\"><a class=\"anchor\" href=\"#jenkins安装及使用\">#</a> Jenkins 安装及使用</h1>\n<p>ubuntuserver 安装步骤</p>\n<h2 id=\"前置要求\"><a class=\"anchor\" href=\"#前置要求\">#</a> 前置要求</h2>\n<h3 id=\"安装java和maven\"><a class=\"anchor\" href=\"#安装java和maven\">#</a> 安装 java 和 maven</h3>\n<h3 id=\"下载jenkins\"><a class=\"anchor\" href=\"#下载jenkins\">#</a> 下载 jenkins</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> -q -O - https://pkg.jenkins.io/debian/jenkins.io.key <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> apt-key <span class=\"token function\">add</span> -</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">sh</span> -c <span class=\"token string\">'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> jenkins</pre></td></tr></table></figure><h3 id=\"需要有jdk镜像\"><a class=\"anchor\" href=\"#需要有jdk镜像\">#</a> 需要有 jdk 镜像</h3>\n<p>构建最小 jdk 镜像</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamF2YS5jb20vZW4vZG93bmxvYWQvbWFudWFsLmpzcA==\">jre8 下载地址</span></p>\n<p>选择  Linux x64filesize</p>\n<p>解压文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -xzvf jre-8u181-linux-x64.tar.gz</pre></td></tr></table></figure><p>删除无用的文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> jre1.8.0_181/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rm</span> -rf COPYRIGHT LICENSE README release THIRDPARTYLICENSEREADME-JAVAFX.txt THIRDPARTYLICENSEREADME.txt Welcome.html</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rm</span> -rf  lib/plugin.jar <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        lib/ext/jfxrt.jar <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        bin/javaws <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        lib/javaws.jar <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        lib/desktop <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        plugin <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        lib/deploy* <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        lib/*javafx* <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        lib/*jfx* <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        lib/amd64/libdecora_sse.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        lib/amd64/libprism_*.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        lib/amd64/libfxplugins.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        lib/amd64/libglass.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        lib/amd64/libgstreamer-lite.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        lib/amd64/libjavafx*.so <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        lib/amd64/libjfx*.so</pre></td></tr></table></figure><p>重新打包</p>\n<p><code>tar zcvf jre8.tar.gz *</code></p>\n<p>新建 Dockerfile</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># using alpine-glibc instead of alpine  is mainly because JDK relies on glibc</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>FROM docker.io/jeanblanchard/alpine-glibc</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># author</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>MAINTAINER simon</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># A streamlined jre</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ADD jre8.tar.gz /usr/java/jdk/</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># set env</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>ENV JAVA_HOME /usr/java/jdk</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ENV <span class=\"token environment constant\">PATH</span> <span class=\"token variable\">$&#123;<span class=\"token environment constant\">PATH</span>&#125;</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$&#123;JAVA_HOME&#125;</span>/bin</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># run container with base path:/opt</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>WORKDIR /opt</pre></td></tr></table></figure><p>构建 docker 镜像 (Dockerfile 与压缩包在同一目录下)</p>\n<p><code>docker build -t jdk8 .</code></p>\n<p>java 中 pom 文件修改，指定 jdk8 镜像</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.spotify<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>docker-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.0.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>imageName</span><span class=\"token punctuation\">></span></span>ibase/$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>imageName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">&lt;!--&lt;dockerDirectory>src/main/docker&lt;/dockerDirectory>--></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>forceTags</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>forceTags</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>baseImage</span><span class=\"token punctuation\">></span></span>jdk8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>baseImage</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>entryPoint</span><span class=\"token punctuation\">></span></span>[\"java\",\"-jar\",\"/$&#123;project.build.finalName&#125;.jar\"]<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>entryPoint</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>targetPath</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>targetPath</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>directory</span><span class=\"token punctuation\">></span></span>$&#123;project.build.directory&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>directory</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>include</span><span class=\"token punctuation\">></span></span>$&#123;project.build.finalName&#125;.jar<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>include</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>另一种写法 (这是我用过的)</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>build</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>finalName</span><span class=\"token punctuation\">></span></span>lwapp-config<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>finalName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugins</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-boot-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.spotify<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>docker-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.2.2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    <span class=\"token comment\">&lt;!-- 安装 docker 的主机的地址 --></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>imageName</span><span class=\"token punctuation\">></span></span>192.168.98.205:5092/$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>imageName</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>baseImage</span><span class=\"token punctuation\">></span></span>jdk8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>baseImage</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>entryPoint</span><span class=\"token punctuation\">></span></span>[\"java\",\"-jar\",\"/$&#123;project.build.finalName&#125;.jar\"]<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>entryPoint</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    <span class=\"token comment\">&lt;!--&lt;dockerCertPath>/etc/ca/docker-ca&lt;/dockerCertPath>--></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>targetPath</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>targetPath</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>directory</span><span class=\"token punctuation\">></span></span>$&#123;project.build.directory&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>directory</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>include</span><span class=\"token punctuation\">></span></span>$&#123;project.build.finalName&#125;.jar<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>include</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resource</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    <span class=\"token comment\">&lt;!-- 安装 docker 的主机的地址 --></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dockerHost</span><span class=\"token punctuation\">></span></span>http://192.168.98.205:2375<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dockerHost</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugins</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>build</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h3 id=\"安装私有docker仓库\"><a class=\"anchor\" href=\"#安装私有docker仓库\">#</a> 安装私有 docker 仓库</h3>\n<p><code>docker run -di --name=myregistry -p 5092:5000 registry</code></p>\n<p>尝试访问 registry 容器 ：<span class=\"exturl\" data-url=\"aHR0cDovLzEwLjYyLjE3LjEwMToxMDA5Mi92Mi9fY2F0YWxvZw==\">http://10.62.17.101:10092/v2/_catalog</span></p>\n<p>想要上传还需要 docker 开放 2375 端口</p>\n<p><code>vi /usr/lib/systemd/system/docker.service</code></p>\n<p>进入后修改</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 注释掉或删除这句话</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/bin/dockerd -H fd:// --containerd<span class=\"token operator\">=</span>/run/containerd/containerd.sock</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 加入下面这句</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock -H fd:// --containerd<span class=\"token operator\">=</span>/run/containerd/containerd.sock</pre></td></tr></table></figure><h3 id=\"让虚拟机识别到更改的仓库\"><a class=\"anchor\" href=\"#让虚拟机识别到更改的仓库\">#</a> 让虚拟机识别到更改的仓库</h3>\n<p>在 /etc/docker/daemon.json 添加</p>\n<p><code>&quot;insecure-registries&quot;:[&quot;192.168.98.205:5092&quot;]</code></p>\n<p>重新加载 docker 和 daemon</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl daemon-reload</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl restart docker</pre></td></tr></table></figure><p>修改要上传的标签并上传</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker tag jdk8 <span class=\"token number\">192.168</span>.98.205:5092/jdk8</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docker push <span class=\"token number\">192.168</span>.98.205:5092/jdk8</pre></td></tr></table></figure><h3 id=\"可选项安装gogs\"><a class=\"anchor\" href=\"#可选项安装gogs\">#</a> (可选项) 安装 gogs</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker run -d -p <span class=\"token number\">20022</span>:22 -p <span class=\"token number\">23000</span>:3000 -v /root/gogs_data:/data gogs/gogs</pre></td></tr></table></figure><p>注：将自己的代码上传到 gogs 或者其他的 git 仓库中，Jenkins 会根据这个仓库地址的代码进行生成镜像</p>\n<h2 id=\"jenkins的使用\"><a class=\"anchor\" href=\"#jenkins的使用\">#</a> Jenkins 的使用</h2>\n<ol>\n<li>安装好后 Jenkins 默认启动了 8080 端口，输入网址进入需要输入密钥</li>\n</ol>\n<p>密钥可以使用  <code>systemctl status jenkins</code>  查看</p>\n<p>或者  <code>cat /var/lib/jenkins/secrets/initialAdminPassword</code></p>\n<ol start=\"2\">\n<li>进入后会有两个选项可以不用选直接点击右上角关闭</li>\n<li>主界面侧边栏找到系统管理</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGTcC.png\" alt=\"image-20220430125903251\" /></p>\n<ol>\n<li>\n<p>点击插件管理<img data-src=\"https://i.imgtg.com/2023/06/19/OTGWOL.png\" alt=\"image-20220430125956038\" /></p>\n</li>\n<li>\n<p>选择可选插件搜索想要的插件选中后点击 install（安装 Git plugin 和 Maven Integration plugin）</p>\n</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGbNi.png\" alt=\"image-20220430130423000\" /></p>\n<ol start=\"6\">\n<li>退出插件管理进入全局工具配置</li>\n<li>配置 maven 的 setting 文件的路径和 jdk 的路径 (jdk 可以不用改使用默认的)，配置完成点击保存即可</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGkLX.png\" alt=\"image-20220430130900088\" /></p>\n<ol start=\"8\">\n<li>返回主页点击新建任务，输入名称选择 - 构建一个 maven 项目，点击确定</li>\n<li>源码管理选择 Git，输入之前上传仓库的 clone 地址</li>\n<li>(之前的都不用动) Build 的 RootPom 选择 git 仓库中的位置。(在表面则不用改，文件夹内部则为：文件夹名 /pom.xml)</li>\n<li>Goals and options 根据需求填写，一般为  <code>clean package docker:build -DpushImage</code></li>\n<li>点击保存后返回主界面点击三角开关即可，成功则显示绿色√，否则为红色 ×</li>\n</ol>\n<p><img data-src=\"https://i.imgtg.com/2023/06/19/OTGxut.png\" alt=\"image-20220430131609017\" /></p>\n",
            "tags": [
                "Java"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Note/redis%E5%85%A5%E9%97%A8/",
            "url": "https://obsidianlyg.github.io/Note/redis%E5%85%A5%E9%97%A8/",
            "title": "redis入门",
            "date_published": "2022-02-02T09:15:12.000Z",
            "content_html": "<h2 id=\"redis测试\"><a class=\"anchor\" href=\"#redis测试\">#</a> redis 测试</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 测试： 100 个并发连接  100000 请求</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>redis-benchmark -h localhost -p <span class=\"token number\">6379</span> -c <span class=\"token number\">100</span> -n <span class=\"token number\">100000</span></pre></td></tr></table></figure><h2 id=\"五大数据类型\"><a class=\"anchor\" href=\"#五大数据类型\">#</a> 五大数据类型</h2>\n<blockquote>\n<p><strong>redis</strong> 是<strong>单线程</strong>的，可以用作<strong>数据库</strong>，<strong>缓存</strong>和<strong>消息中间件 MQ</strong></p>\n</blockquote>\n<p>官方表示：redis 是基于内存操作的，CPU 不是 redis 性能瓶颈，redis 的瓶颈是根据机器的内存和网络带宽，既然可以使用单线程来实现，就使用单线程了！</p>\n<p>为什么默认端口是 6379：粉丝效应</p>\n<p>redis 默认有 16 个数据库，默认使用的是第 0 个数据库</p>\n<p>可以使用 select 进行切换</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcw==\">官方文档</span></p>\n<h3 id=\"redis-key\"><a class=\"anchor\" href=\"#redis-key\">#</a> Redis-key</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root<span class=\"token punctuation\">[</span>/usr/local/bin<span class=\"token punctuation\">]</span>: redis-cli -p <span class=\"token number\">6379</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token keyword\">select</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> DBSIZE <span class=\"token comment\">#查看 DB 大小</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> keys * <span class=\"token comment\">#查看所有的 key</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>flushdb <span class=\"token comment\">#清除当前数据库</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>flushall <span class=\"token comment\">#清空所有数据库</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>EXISTS age <span class=\"token comment\">#判断 age 键是否存在，有为 1，否则为 0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> exists age1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> move age <span class=\"token number\">1</span> <span class=\"token comment\">#移除 age , 1 代表当前数据库</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span>expire age <span class=\"token number\">10</span> <span class=\"token comment\"># 10 秒后过期</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span>ttl age <span class=\"token comment\">#还剩多少时间过期</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span>type age <span class=\"token comment\">#查看当前数据类型</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>string</pre></td></tr></table></figure><h3 id=\"string字符串\"><a class=\"anchor\" href=\"#string字符串\">#</a> String（字符串）</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> key1 v1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> append key1 hell  <span class=\"token comment\"># 存在则追加，不存在则新建</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get key1</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token string\">\"v1hell\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> strlen key1 <span class=\"token comment\"># 获取字符串的长度</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">6</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> views <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> incr views  <span class=\"token comment\"># 自动加 1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> decr views <span class=\"token comment\"># 自动减 1</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> incrby views <span class=\"token number\">10</span> <span class=\"token comment\"># 增加指定数值 同理 decrby</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">11</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 字符串范围 range</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> key1 <span class=\"token string\">\"hello,kuangshen\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> GETRANGE key1 <span class=\"token number\">0</span> <span class=\"token number\">3</span>  <span class=\"token comment\"># 截取 [0,3]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token string\">\"hell\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> GETRANGE key1 <span class=\"token number\">0</span> -1  <span class=\"token comment\"># 取所有</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token string\">\"hello,kuangshen\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 替换</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SETRANGE key2 <span class=\"token number\">1</span> xx <span class=\"token comment\"># 从 1 开始替换字符串</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">7</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> GETRANGE key2 <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token string\">\"axxdefg\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># setex (set with expire) # 设置过期时间</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># setnx (set if not exist) # 不存在设置 （在分布式锁中会常用）</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setex key3 <span class=\"token number\">30</span> <span class=\"token string\">\"sds\"</span> <span class=\"token comment\"># key3 30 秒存在时间</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ttl key3</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">26</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setnx mykey <span class=\"token string\">\"hello\"</span> <span class=\"token comment\"># 设置成功返回 1 否则返回 0 如果不存在则创建，如果存在就创建失败</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setnx mykey <span class=\"token string\">\"Mongo\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get mykey</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># 同时设置（获取）多个键值对</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>mset</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>mget</pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mset k1 v1 k2 v2 k3 v3</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> keys *</pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k1\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mget k1 k2 k3</pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v1\"</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v2\"</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v3\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>同样的 msetnx msetex 同理（原子性操作，要么一起成功要么一起失败）</pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\"># 关于对象</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token builtin class-name\">set</span> user:1 <span class=\"token punctuation\">&#123;</span>name:zhangsan, age:3<span class=\"token punctuation\">&#125;</span> <span class=\"token comment\"># 这是一个 user:1 对象 值为 json 字符来保存对象！</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\"># 这里 key 的设计: user:&#123;id&#125;:&#123;filed&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\"># 冒号：代表一个层级，方便查看和管理</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mset user:1:name zhangsan user:1:age <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mget user:1:name user:1:age</pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"zhangsan\"</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"2\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>getset <span class=\"token comment\"># 先 get 再 set</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getset db redis  <span class=\"token comment\"># 如果不存在返回 nil 并创建</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get db</pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token string\">\"redis\"</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getset db mongodb <span class=\"token comment\"># 如果存在则返回当前值，并修改</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token string\">\"redis\"</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get db</pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token string\">\"mongodb\"</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr></table></figure><p>数据结构是想通的！</p>\n<p>String 类型使用场景：value 除了是字符串还可以是数字</p>\n<ul>\n<li>计数器</li>\n<li>统计多单位数量</li>\n<li>粉丝数</li>\n<li>对象缓存存储</li>\n</ul>\n<h3 id=\"list列表\"><a class=\"anchor\" href=\"#list列表\">#</a> List（列表）</h3>\n<p>在 redis 的 list 中，可以做成栈，队列，阻塞队列！redis 不区分大小写命令</p>\n<p>list 内部可以存在重复值</p>\n<p>注：只有 push 和 pop 才分左右，其余前置 l 均为 list 的意思</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LPUSH list one  <span class=\"token comment\"># lpush 中的 l 指的是 left，从左边插入，同理有 rpush，相当于压栈</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LPUSH list teo</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LPUSH list three</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LRANGE list <span class=\"token number\">0</span> -1 <span class=\"token comment\"># 查所有， 都是从零开始计算的</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"teo\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> LRANGE list <span class=\"token number\">0</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"teo\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>移除命令，同理有lpop和rpop</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>获取下标值index，也是分lindex和rindex</pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"teo\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"four\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lindex list <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>获取list长度，llen</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> llen list</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>移除指定的值</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>lrem  （list remove）</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>因为list内部可以存在重复值，所以出现lrem key count value</pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> lrem list <span class=\"token number\">1</span> one</pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:6379<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>只保留一部分值</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>ltrim</pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello3\"</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ltrim mylist <span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token comment\"># 通过下标截取指定长度</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>rpoplpush <span class=\"token comment\"># 移除列表最后一个元素，并添加到新的列表中</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>rpoplpush <span class=\"token builtin class-name\">source</span> destination</pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> rpoplpush mylist myotherlist</pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange myotherlist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange mylist <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello1\"</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello2\"</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>lset 更新元素（前提:该元素存在，否则会报错）</pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lpush list value1</pre></td></tr><tr><td data-num=\"84\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lset list <span class=\"token number\">0</span> item <span class=\"token comment\"># 更新元素</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"89\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"90\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"item\"</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>linsert 从列表中具体的值前面（或后面）插入值</pre></td></tr><tr><td data-num=\"94\"></td><td><pre>linsert key before<span class=\"token operator\">|</span>after pivot value</pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"96\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"item\"</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> linsert list before item before</pre></td></tr><tr><td data-num=\"99\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange list <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"101\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"before\"</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"item\"</span></pre></td></tr></table></figure><blockquote>\n<p>小结</p>\n</blockquote>\n<ul>\n<li>实际上是一个链表</li>\n<li>key 不存在就创建，存在则新增</li>\n<li>如果移除了所有值，也就是空链表，则代表不存在</li>\n<li>在两边插入或改值时，效率最高，中间元素效率会低一点。</li>\n</ul>\n<h3 id=\"set集合\"><a class=\"anchor\" href=\"#set集合\">#</a> Set（集合）</h3>\n<p>set 是一个无序不重复集合</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd myset lovekuangshen <span class=\"token comment\"># 建立集合，增加值</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> smembers myset  <span class=\"token comment\"># 查看集合内容</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"lovekuangshen\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sismember myset hello <span class=\"token comment\"># 判断 hello 是否存在于 myset 中</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> scard myset <span class=\"token comment\"># 查看集合中元素的个数</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>srem key value <span class=\"token comment\"># 移除集合中的元素</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>SRANDMEMBER key <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">]</span> 随机筛选元素，默认筛选个数为1</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>随机删除key，指定删除key</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>spop随机移除元素</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>将一个指定的值移动到另外一个set中</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>smove <span class=\"token builtin class-name\">source</span> destination member</pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> smove myset myset2 hello</pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SMEMBERS myset</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"lovekuangshen\"</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SMEMBERS myset2</pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hello\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"set2\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>微博，B站，共同关注！（并集）</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>数字集合类：</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>- 差集</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>- 交集</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>- 并集</pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd <span class=\"token builtin class-name\">set</span> a</pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd <span class=\"token builtin class-name\">set</span> b</pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd <span class=\"token builtin class-name\">set</span> c</pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd set2 c</pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd set2 d</pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd set2 e</pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SDIFF <span class=\"token builtin class-name\">set</span> set2 <span class=\"token comment\"># 找不同，也就是差集</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"a\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"b\"</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SINTER <span class=\"token builtin class-name\">set</span> set2 <span class=\"token comment\"># 交集 可以实现共同好友</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"c\"</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> SUNION <span class=\"token builtin class-name\">set</span> set2 <span class=\"token comment\"># 并集</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"a\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"c\"</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"b\"</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"e\"</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"d\"</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span></pre></td></tr></table></figure><p>微博，A 用户将所有关注的人放在一个 set 集合中！将它的粉丝也放在一个集合中！<br />\n 共同关注，共同爱好，二度好友，推荐好友！(六度分割理论)</p>\n<h3 id=\"hash哈希\"><a class=\"anchor\" href=\"#hash哈希\">#</a> Hash（哈希）</h3>\n<p>map 集合，key-map</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hset <span class=\"token builtin class-name\">hash</span> filed1 kuangshen  <span class=\"token comment\"># 设置值</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hget <span class=\"token builtin class-name\">hash</span> filed1 <span class=\"token comment\"># 获取值</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hmset <span class=\"token builtin class-name\">hash</span> filed2 k2 filed3 k3 filed4 k4 <span class=\"token comment\"># 同时设置多个值</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hmget <span class=\"token builtin class-name\">hash</span> filed1 filed2 filed3 <span class=\"token comment\"># 同时获取多个值</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hgetall <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取全部数据</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed1\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed2\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed3\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token number\">7</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed4\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k4\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hdel <span class=\"token builtin class-name\">hash</span> filed1 <span class=\"token comment\"># 删除指定字段</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hgetall <span class=\"token builtin class-name\">hash</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed2\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed3\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed4\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k4\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hlen <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取长度</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre> HEXISTS <span class=\"token builtin class-name\">hash</span> filed2 <span class=\"token comment\"># 判断元素是否存在</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre> <span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre> <span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hkeys <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取所有 key</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed2\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed3\"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"filed4\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hvals <span class=\"token builtin class-name\">hash</span> <span class=\"token comment\"># 获取所有值</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k2\"</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k3\"</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"k4\"</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre> HINCRBY <span class=\"token builtin class-name\">hash</span> f1 <span class=\"token number\">1</span> <span class=\"token comment\"># f1 自增 1 HINCRBY hash f1 -1 相当于自减</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre> <span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hsetnx <span class=\"token builtin class-name\">hash</span> f1 <span class=\"token number\">5</span> <span class=\"token comment\"># 如果不存在则可以设置，存在则不行</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hsetnx <span class=\"token builtin class-name\">hash</span> f2 <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p>hash 存变更数据 user name age，尤其是用户信息之类的，经常变动的信息，hash 更适合于对象的存储，String 更适合字符串的存储！</p>\n<h3 id=\"zset有序集合\"><a class=\"anchor\" href=\"#zset有序集合\">#</a> zset（有序集合）</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zadd myset <span class=\"token number\">1</span> one <span class=\"token number\">2</span> two <span class=\"token number\">3</span> three <span class=\"token comment\"># 添加三个值，数字是排序标志</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange myset <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zadd salary <span class=\"token number\">2500</span> xiaohong <span class=\"token number\">5000</span> zhangsan <span class=\"token number\">500</span> kuangshen</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>排序</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># ZRANGEBYSCORE key min max withscores (选填，附带成绩等排序标志)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZRANGEBYSCORE myset <span class=\"token punctuation\">(</span>-1 <span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token comment\"># (后两个是区间，有括号表示不包含该数字)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZRANGEBYSCORE salary -inf +inf <span class=\"token comment\"># 全部用户从小到大排序 (范围)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xiaohong\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"zhangsan\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZREVRANGE myset <span class=\"token number\">0</span> -1 <span class=\"token comment\"># 从大到小排列</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"three\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"two\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"one\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ZRANGEBYSCORE salary -inf <span class=\"token number\">2500</span> withscores <span class=\"token comment\"># 2500 以内</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"500\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xiaohong\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"2500\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>zrem 移除元素</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrem salary xiaohong</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange salary <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"kuangshen\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"zhangsan\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>zcard key 查看元素个数</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>zcount key min max 统计区间值的个数</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zcount myset <span class=\"token number\">1</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr></table></figure><p>案例思路： set 排序，存储班级成绩表，工资排序表，排行榜</p>\n<p>普通消息， 1， 重要消息， 2， 带权重进行判断！</p>\n<h2 id=\"三种特殊数据类型\"><a class=\"anchor\" href=\"#三种特殊数据类型\">#</a> 三种特殊数据类型</h2>\n<h3 id=\"geospatial地理位置\"><a class=\"anchor\" href=\"#geospatial地理位置\">#</a> geospatial（地理位置）</h3>\n<p>朋友定位，附近的人，打车距离计算</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9qaW5nd2VpZHUuYm1jeC5jb20v\">经纬度查询 (获取测试数据)</span></p>\n<blockquote>\n<p>geoadd (添加地理位置)</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">##################################################################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 规则：地球两极无法添加， 一般直接通过 java 程序一次性导入</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>geoadd key 经度 纬度 名字</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd china:city <span class=\"token number\">116.23128</span> <span class=\"token number\">40.22077</span> beijing</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd china:city <span class=\"token number\">121</span> <span class=\"token number\">31</span> shanghai</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd china:city <span class=\"token number\">106</span> <span class=\"token number\">29</span> chongqing</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><blockquote>\n<p>geopos (获取)</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geopos china:city xian</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"108.00000160932540894\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"34.00000062127011091\"</span></pre></td></tr></table></figure><blockquote>\n<p>geodist (获取两点距离)</p>\n</blockquote>\n<p>单位：</p>\n<ul>\n<li><strong>m</strong> for meters.</li>\n<li><strong>km</strong> for kilometers.</li>\n<li><strong>mi</strong> for miles.</li>\n<li><strong>ft</strong> for feet.</li>\n</ul>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geodist china:city beijing chongqing</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">\"1557966.1279\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geodist china:city beijing chongqing km</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token string\">\"1557.9661\"</span></pre></td></tr></table></figure><blockquote>\n<p>georadius</p>\n</blockquote>\n<p>附近的人 (获取所有附近的人的地址，定位！)</p>\n<p>georadius 经度 纬度 半径 单位</p>\n<p>withcoord 显示他人的定位信息</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shenzhen\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hangzhou\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km count <span class=\"token number\">2</span> <span class=\"token comment\"># 限制显示的数量</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km withdist<span class=\"token comment\"># 显示到 (110,30) 中心的距离</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"402.8557\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"483.2155\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadius china:city  <span class=\"token number\">110</span> <span class=\"token number\">30</span> <span class=\"token number\">1000</span> km withcoord</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"106.00000172853469849\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"28.99999952347345555\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"108.00000160932540894\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"34.00000062127011091\"</span></pre></td></tr></table></figure><blockquote>\n<p>georadiusbymember</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 找出位于指定元素周围的其他元素</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadiusbymember china:city chongqing <span class=\"token number\">1000</span> km</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr></table></figure><blockquote>\n<p>geohash - 返回一个或多个位置元素的个 geohash 表示</p>\n</blockquote>\n<p>该命令返回 11 个字符的 geohash 字符串</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 将二维的经纬度转换成一维的字符串，，如果两个字符串越接近，那么距离越近。</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geohash china:city beijing chongqing</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"wx4sucvncn0\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"wm5kup6c5p0\"</span></pre></td></tr></table></figure><blockquote>\n<p>geo 底层实现原理就是 zset，可以使用 zset 命令操作 geo！</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange china:city <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shenzhen\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"hangzhou\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shanghai\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"beijing\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrem china:city hangzhou <span class=\"token comment\"># 移除 geo 建立的元素</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange china:city <span class=\"token number\">0</span> -1</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"chongqing\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"xian\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shenzhen\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shanghai\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"beijing\"</span></pre></td></tr></table></figure><h3 id=\"hyperloglog\"><a class=\"anchor\" href=\"#hyperloglog\">#</a> Hyperloglog</h3>\n<p>基数（一个集合中不重复的元素）</p>\n<blockquote>\n<p>简介：用于做基数统计的算法</p>\n</blockquote>\n<p>优点：占用内存固定， 2^64 个不同的元素的基数，只需要废 12KB 的内存，从内存角度看 Hyperloglog 是首选</p>\n<p>0.81% 错误率！统计 UV 任务是可以忽略不计的。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> pfadd mykey a b c d e f g h i j <span class=\"token comment\"># 添加</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFCount mykey <span class=\"token comment\"># 计数，统计基数数量</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFCOUNT mykey2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">9</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFMERGE mykey3 mykey mykey2 <span class=\"token comment\"># 合并</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> PFCOUNT mykey3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">15</span></pre></td></tr></table></figure><p>允许容错，一定可以使用 Hyperloglog</p>\n<p>不允许容错，就使用 set 或者自己的数据类型即可</p>\n<h3 id=\"bitmaps\"><a class=\"anchor\" href=\"#bitmaps\">#</a> Bitmaps</h3>\n<blockquote>\n<p>按位存储</p>\n</blockquote>\n<p>统计疫情感染人数：000000110101010</p>\n<p>统计用户信息：活跃，不活跃！登录，未登录！365 打卡！两个状态的都可以使用 bitmaps</p>\n<p>Bitmaps 位图，数据结构！都是操作二进制位来进行记录的，只有 0 和 1 两种状态</p>\n<blockquote>\n<p>测试</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token comment\"># 设置七天的打卡状态，0-6 > 周一到周天</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">1</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">2</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">3</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">4</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">5</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit sign <span class=\"token number\">6</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getbit sign <span class=\"token number\">3</span> <span class=\"token comment\"># 确认周四有没有打卡</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 统计的操作，统计打卡天数，默认全部</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> bitcount sign</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr></table></figure><h2 id=\"redis的事务\"><a class=\"anchor\" href=\"#redis的事务\">#</a> redis 的事务</h2>\n<p><mark>redis 的单条命令可以保证原子性（要么同时成功，要么同时失败），但是 redis 的事务不行</mark></p>\n<p>redis 事务本质：一组命令的集合。一个事务中的所有命令都会被序列化，在事务的执行过程中，会按照顺序执行。</p>\n<p>一次性，顺序性，排他性。执行一系列的命令！</p>\n<p><mark>redis 事务没有隔离级别的概念</mark></p>\n<p>所有命令在事务中，并没有被直接执行！只有发起执行命令的时候才会执行！</p>\n<p>redis 事务：</p>\n<ul>\n<li>开启事务（multi）</li>\n<li>命令入队（......）</li>\n<li>执行事务（exec）</li>\n</ul>\n<blockquote>\n<p>正常执行事务</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi <span class=\"token comment\"># 开启事务</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 v1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k2 v2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k2</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k3 v3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span> <span class=\"token comment\"># 执行事务</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v2\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> OK</pre></td></tr></table></figure><blockquote>\n<p>放弃事务</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 v1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k2 v2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k4 v4</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> DISCARD <span class=\"token comment\"># 取消事务</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k4 <span class=\"token comment\"># 事务中队列的命令都不会被执行</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>编译型异常（代码有问题，命令有错），事务中所有的命令都不会被执行</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 v1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k3 v3</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getset k3</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> ERR wrong number of arguments <span class=\"token keyword\">for</span> <span class=\"token string\">'getset'</span> <span class=\"token builtin class-name\">command</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> EXECABORT Transaction discarded because of previous errors.</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k1</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>运行时异常（例如：1/0），如果事务队列中存在语法性错误，那么执行命令的时候，其他命令是可以正常执行的。错误命令会抛出异常。</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k1 <span class=\"token string\">\"v1\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> incr k</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k2 v2</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> k3 v3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k3</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span> <span class=\"token comment\"># 虽然第一条错了，但是后面仍然执行成功</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> ERR value is not an integer or out of range</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> OK</pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"v3\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get k2</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token string\">\"v2\"</span></pre></td></tr></table></figure><blockquote>\n<p>监控 watch</p>\n</blockquote>\n<p>悲观锁：</p>\n<ul>\n<li>很悲观，认为什么时候都会出现问题，无论做什么都会加锁！</li>\n</ul>\n<p>乐观锁：</p>\n<ul>\n<li>很乐观，认为什么时候都不会出现问题，所以不会上锁！更新数据的时候去判断一下，在此期间是否有人修改过这个数据。</li>\n<li>获取 version，更新的时候去比较 version</li>\n</ul>\n<blockquote>\n<p>监视测试</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> money <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> out <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token function\">watch</span> money  <span class=\"token comment\"># 监视 money 对象</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi <span class=\"token comment\"># 事务正常结束，数据期间没有发生变动，这个时候正常执行成功！(一旦事务执行后，监视会自动取消)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> DECRBY money <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> INCRBY out <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">80</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">20</span></pre></td></tr></table></figure><p>测试多线程修改值，使用 watch 相当于 redis 的乐观锁操作</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> WATCH money</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> multi</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> DECRBY money <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> INCRBY out <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>QUEUED</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">exec</span> <span class=\"token comment\"># 执行之前。另外一个线程修改了这个值，这个时候，会导致事务执行失败！（无论失败成功 exec 都会自动解锁）</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> unwatch <span class=\"token comment\"># 停止监视，之后再重新监视执行</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token function\">watch</span> money</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>OK</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://obsidianlyg.github.io/Note/%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E6%B5%8B%E8%AF%95/",
            "url": "https://obsidianlyg.github.io/Note/%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E6%B5%8B%E8%AF%95/",
            "title": "移动应用测试",
            "date_published": "2022-01-20T16:14:39.000Z",
            "content_html": "<h1 id=\"移动应用测试\"><a class=\"anchor\" href=\"#移动应用测试\">#</a> 移动应用测试</h1>\n<h2 id=\"查看包名\"><a class=\"anchor\" href=\"#查看包名\">#</a> 查看包名：</h2>\n<ul>\n<li>\n<p>方案一：如果你应用已经安装在手机上了，可以直接打开手机上该应用，进入到你要操作的界面，然后执行 (<strong>注：一定要用 cmd 运行，powershell 会报参数不正确</strong>):</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb shell dumpsys activity recents <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"intent=&#123;\"</span></pre></td></tr></table></figure><p>会出现如下信息：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.<span class=\"token environment constant\">HOME</span><span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10000000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.launcher3/.Launcher<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10000000 <span class=\"token assign-left variable\">pkg</span><span class=\"token operator\">=</span>tv.danmaku.bili <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>tv.danmaku.bili/.MainActivityV2<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.flysilkworm/.app.activity.FrameworkActivity<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10800000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>io.appium.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>C:<span class=\"token punctuation\">\\</span>WINDOWS<span class=\"token punctuation\">\\</span>System3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>adb shell dumpsys activity recents <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"intent=&#123;\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>tv.danmaku.bili/.MainActivityV2<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.<span class=\"token environment constant\">HOME</span><span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10000000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.launcher3/.Launcher<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.flysilkworm/.app.activity.FrameworkActivity<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10200000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>com.android.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token assign-left variable\">intent</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>act<span class=\"token operator\">=</span>android.intent.action.MAIN <span class=\"token assign-left variable\">cat</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">flg</span><span class=\"token operator\">=</span>0x10800000 <span class=\"token assign-left variable\">cmp</span><span class=\"token operator\">=</span>io.appium.settings/.Settings<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>其中 cmp=tv.danmaku.bili/.MainActivityV2 就是 / 之前是包名（appPackage），之后是 appActivity</p>\n</li>\n<li>\n<p>方案二：如果是已有 apk 在电脑上</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>aapt dump badging D:<span class=\"token punctuation\">\\</span>Desktop<span class=\"token punctuation\">\\</span>软测<span class=\"token punctuation\">\\</span>iBiliPlayer-bili.apk <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"package\"</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>aapt dump badging D<span class=\"token punctuation\">:</span>\\Desktop\\软测\\iBiliPlayer<span class=\"token operator\">-</span>bili<span class=\"token punctuation\">.</span>apk <span class=\"token operator\">|</span> find <span class=\"token string\">\"launchable-activity\"</span></pre></td></tr></table></figure><p>会出现如下信息：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>、</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>C:<span class=\"token punctuation\">\\</span>WINDOWS<span class=\"token punctuation\">\\</span>System3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>aapt dump badging D:<span class=\"token punctuation\">\\</span>Desktop<span class=\"token punctuation\">\\</span>软测<span class=\"token punctuation\">\\</span>iBiliPlayer-bili.apk <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"package\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>package: <span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span><span class=\"token string\">'tv.danmaku.bili'</span> <span class=\"token assign-left variable\">versionCode</span><span class=\"token operator\">=</span><span class=\"token string\">'6430500'</span> <span class=\"token assign-left variable\">versionName</span><span class=\"token operator\">=</span><span class=\"token string\">'6.43.0'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span>、 </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>C:<span class=\"token punctuation\">\\</span>WINDOWS<span class=\"token punctuation\">\\</span>System3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>aapt dump badging D:<span class=\"token punctuation\">\\</span>Desktop<span class=\"token punctuation\">\\</span>软测<span class=\"token punctuation\">\\</span>iBiliPlayer-bili.apk <span class=\"token operator\">|</span> <span class=\"token function\">find</span> <span class=\"token string\">\"launchable-activity\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>launchable-activity: <span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span><span class=\"token string\">'tv.danmaku.bili.MainActivityV2'</span>  <span class=\"token assign-left variable\">label</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">icon</span><span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr></table></figure><p>1、的 name 是包名，2、的 name 是 appActivity（tv.danmaku.bili.MainActivityV2，</p>\n<p>可以省略 tv.danmaku.bili）</p>\n</li>\n<li>\n<p>方案三：算是方案一的进阶吧 (推荐)</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb shell dumpsys window w <span class=\"token operator\">|</span>findstr <span class=\"token punctuation\">\\</span>/ <span class=\"token operator\">|</span>findstr <span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 或者</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>adb shell dumpsys activity activities <span class=\"token operator\">|</span> findstr mFocusedActivity</pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"在ui-automator-viewerbat中运行一次python就连不上的问题\"><a class=\"anchor\" href=\"#在ui-automator-viewerbat中运行一次python就连不上的问题\">#</a> 在 UI Automator Viewer.bat 中运行一次 Python 就连不上的问题：</h2>\n<p><strong>特别提示：如果按照 Python 模板写，按 q 退出可以避免连不上的问题，相关代码如下</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>q <span class=\"token operator\">=</span> input<span class=\"token punctuation\">(</span><span class=\"token string\">'input q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    driver.quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>方案一：重启模拟器</p>\n<p>方案二：重启 adb（推荐方案二，因为方案一很慢 (￣_￣|||)）</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb kill-server <span class=\"token operator\">&amp;</span> adb start-server</pre></td></tr></table></figure><p>方案三：appium 重连（原因：运行后 appium 占用指定端口与本身需要的端口冲突导致）</p>\n<h2 id=\"python中测试基本语法\"><a class=\"anchor\" href=\"#python中测试基本语法\">#</a> <strong>Python 中测试基本语法</strong>：</h2>\n<p>参考语法文档：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5ieWh5Lm5ldC90dXQvYXV0by9hcHBpdW0vMDIv\">http://www.byhy.net/tut/auto/appium/02/</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 根据 id</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_elements_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"android:id/button2\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#既可以找多个元素也可以找单个元素</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 点击事件</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"cn.xuexi.android:id/comm_head_xuexi_score\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># tap 点按（bounds 属性，停留的时间）</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>driver<span class=\"token punctuation\">.</span>tap<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token number\">850</span><span class=\"token punctuation\">,</span><span class=\"token number\">1080</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 发送文字事件（resource-id）</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>sbox <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'search_src_text'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sbox<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'Doyoudo'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 根据 class 元素</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_elements_by_class_name<span class=\"token punctuation\">(</span><span class=\"token string\">'android.widget.TextView'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 根据 ACCESSIBILITY ID（content-desc 属性）</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_accessibility_id<span class=\"token punctuation\">(</span><span class=\"token string\">'找人'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 根据 Xpath</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//ele1/ele2[@attr=\"value\"]'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 模拟滑动</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>driver<span class=\"token punctuation\">.</span>swipe<span class=\"token punctuation\">(</span>start_x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">,</span> start_y<span class=\"token operator\">=</span>y1<span class=\"token punctuation\">,</span> end_x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">,</span> end_y<span class=\"token operator\">=</span>y2<span class=\"token punctuation\">,</span> duration<span class=\"token operator\">=</span><span class=\"token number\">800</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># 按键</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\"># 输入回车键，确定搜索</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\"># 返回</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>BACK<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># 隐式等待 设置缺省等待 10 秒时间（不推荐）</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>driver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># 强制等待 等 5 秒（推荐）</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\"># 显示等待 (有点多直接看链接吧)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>blog<span class=\"token punctuation\">.</span>csdn<span class=\"token punctuation\">.</span>net<span class=\"token operator\">/</span>sinat_41774836<span class=\"token operator\">/</span>article<span class=\"token operator\">/</span>details<span class=\"token operator\">/</span><span class=\"token number\">88965281</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\"># 打开通知栏，返回直接 BACK 键</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>driver<span class=\"token punctuation\">.</span>open_notifications<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\"># 截屏手机，并且下载到指定目录中</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>os<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">(</span><span class=\"token string\">'adb shell screencap /sdcard/screen3.png &amp;&amp; adb pull /sdcard/screen3.png'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><a href=\"https://blog.csdn.net/Asaasa1/article/details/109383652\"><strong>关于 TouchAction 类与 MultiAction 类的相关用法</strong></a> (九宫格解锁可以用 touchaction)</p>\n<p><strong>联合查询:</strong></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># xpath 方式： 可以联合 @resource-id 属性和 @text 文本属性来下定位</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">\"//*[@resource-id='com.taobao.taobao:id/tv_scan_text'][@text='扫一扫']\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 内嵌 Java 方式： 后面可以一直.name () 这种方式添加（调用 UI Automator API 的 java 代码，实现最为直接的自动化控制。）</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>code <span class=\"token operator\">=</span> <span class=\"token string\">'new UiSelector().text(\"追番\").resourceId(\"tv.danmaku.bili:id/tab_title\")'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_android_uiautomator<span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ele<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\"># 具体 java 代码 来自谷歌 Android 文档：</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>developer<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>training<span class=\"token operator\">/</span>testing<span class=\"token operator\">/</span>ui<span class=\"token operator\">-</span>automator</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">#常用列表</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        text<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 对应 text</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        resourceId<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 对应 resource-id</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        description<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 对应 content-desc</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        className<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 对应 class</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        index<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\"># 对应 index</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        instance<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># 是匹配的结果所有元素里面的第几个元素</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        textContains<span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 根据文本包含什么字符串 (与 text 连用)</span></pre></td></tr></table></figure><p><strong>注：</strong></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_android_uiautomator<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">'new UiSelector(). className(\" android.widget. TextView\"). textContains(\"白月黑羽\").instance(4)'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>等同于下方代码</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>eles <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_elements_by_android_uiautomator<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token string\">'new UiSelector(). className(\"android.widget. TextView\"). textContains(\"白月黑羽\")'</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>eles<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"python基础模板python的第三方库appium-python-client\"><a class=\"anchor\" href=\"#python基础模板python的第三方库appium-python-client\">#</a> <strong>Python 基础模板</strong>（Python 的第三方库 appium-python-client）</h2>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> appium <span class=\"token keyword\">import</span> webdriver</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> appium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>extensions<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>nativekey <span class=\"token keyword\">import</span> AndroidKey</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>desired_caps <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string\">'platformName'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Android'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 被测手机是安卓</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">'platformVersion'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'5'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 手机安卓版本</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string\">'deviceName'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'HUAWEI'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 设备名，安卓手机可以随意填写</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'appPackage'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'tv.danmaku.bili'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 启动 APP Package 名称</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string\">'appActivity'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'.MainActivityV2'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 启动 Activity 名称</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token string\">'unicodeKeyboard'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 使用自带输入法，输入中文时填 True</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">'resetKeyboard'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 执行完程序恢复原来输入法</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">'noReset'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>       <span class=\"token comment\"># 不要重置 App</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token string\">'newCommandTimeout'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6000</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token string\">'automationName'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'UiAutomator2'</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\"># 'app': r'd:\\apk\\bili.apk',</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\"># 连接 Appium Server，初始化自动化环境</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    driver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Remote<span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:4723/wd/hub'</span><span class=\"token punctuation\">,</span> desired_caps<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\"># 设置缺省等待时间</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\"># 青少年保护</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    iknow <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_elements_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"text3\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">if</span> iknow<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        iknow<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"expand_search\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    sbox <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'search_src_text'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    sbox<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'Doyoudo'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    driver<span class=\"token punctuation\">.</span>press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    eles <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_elements_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">for</span> ele <span class=\"token keyword\">in</span> eles<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    ele<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    q <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        driver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> err<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'An exception happened: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    q <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        driver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"自定义python模板\"><a class=\"anchor\" href=\"#自定义python模板\">#</a> 自定义 Python 模板</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">import</span> <span class=\"token function\">time</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>from appium <span class=\"token function\">import</span> webdriver</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>from appium.webdriver.common.touch_action <span class=\"token function\">import</span> TouchAction</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>from appium.webdriver.extensions.android.nativekey <span class=\"token function\">import</span> AndroidKey</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>desired_caps <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'platformName'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'Android'</span>,</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string\">'platformVersion'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'7'</span>,</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token string\">'deviceName'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'HUAWEI'</span>,</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">'appPackage'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'tv.danmaku.bili'</span>,  <span class=\"token comment\"># adb shell dumpsys activity activities | findstr mFocusedActivity</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">'appActivity'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'.MainActivityV2'</span>,  <span class=\"token comment\"># 启动 Activity 名称</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token string\">'unicodeKeyboard'</span><span class=\"token builtin class-name\">:</span> True,</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token string\">'resetKeyboard'</span><span class=\"token builtin class-name\">:</span> True,</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token string\">'noReset'</span><span class=\"token builtin class-name\">:</span> True,</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token string\">'newCommandTimeout'</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">6000</span>,</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token string\">'automationName'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'UiAutomator2'</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>def id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_element_by_id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>def ids<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_elements_by_id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>def xpath<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_element_by_xpath<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>def xpaths<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_elements_by_xpath<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>def desc<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_element_by_accessibility_id<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>def class_names<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.find_elements_by_class_name<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>def tap<span class=\"token punctuation\">(</span>a, b, c, d<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token builtin class-name\">return</span> driver.tap<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>a, b<span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span>c, d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>, <span class=\"token number\">100</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>def back<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    driver.press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.BACK<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>def enter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    driver.press_keycode<span class=\"token punctuation\">(</span>AndroidKey<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.ENTER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>def move<span class=\"token punctuation\">(</span>x, y, m, n<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    driver.swipe<span class=\"token punctuation\">(</span>start_x<span class=\"token operator\">=</span>x, <span class=\"token assign-left variable\">start_y</span><span class=\"token operator\">=</span>y, <span class=\"token assign-left variable\">end_x</span><span class=\"token operator\">=</span>m, <span class=\"token assign-left variable\">end_y</span><span class=\"token operator\">=</span>n, <span class=\"token assign-left variable\">duration</span><span class=\"token operator\">=</span><span class=\"token number\">800</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>def long_press<span class=\"token punctuation\">(</span>el1, el2<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    action <span class=\"token operator\">=</span> TouchAction<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    action.long_press<span class=\"token punctuation\">(</span>el1<span class=\"token punctuation\">)</span>.move_to<span class=\"token punctuation\">(</span>el2<span class=\"token punctuation\">)</span>.release<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>try:</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    driver <span class=\"token operator\">=</span> webdriver.Remote<span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:4723/wd/hub'</span>, desired_caps<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    driver.implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    time.sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    q <span class=\"token operator\">=</span> input<span class=\"token punctuation\">(</span><span class=\"token string\">'input q to quit\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        driver.quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>except Exception as err:</pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    print<span class=\"token punctuation\">(</span><span class=\"token string\">'An exception happened: '</span> + str<span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">))</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    q <span class=\"token operator\">=</span> input<span class=\"token punctuation\">(</span><span class=\"token string\">'error q to quit'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">if</span> q <span class=\"token operator\">==</span> <span class=\"token string\">'q'</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        driver.quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"appium测试ui界面模板就是python中的desired_caps注这里内部必须都为双引号\"><a class=\"anchor\" href=\"#appium测试ui界面模板就是python中的desired_caps注这里内部必须都为双引号\">#</a> appium 测试 ui 界面模板 (就是 python 中的 desired_caps）<strong>注：这里内部必须都为双引号</strong></h2>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"platformName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Android\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\"platformVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"57\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token property\">\"deviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"HUAWEI\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token property\">\"appPackage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cn.xuexi.android\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token property\">\"appActivity\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"com.alibaba.android.rimet.biz.SplashActivity\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token property\">\"unicodeKeyboard\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token property\">\"resetKeyboard\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token property\">\"noReset\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token property\">\"newCommandTimeout\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token property\">\"automationName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UiAutomator2\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"adb基本命令\"><a class=\"anchor\" href=\"#adb基本命令\">#</a> adb 基本命令</h2>\n<ul>\n<li>\n<p><strong>先附上参考文档：</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cud2FuYW5kcm9pZC5jb20vYmxvZy9zaG93LzIzMTA=\">https://www.wanandroid.com/blog/show/2310</span></p>\n</li>\n<li>\n<p><strong>查看当前连接设备</strong></p>\n<p><code>adb devices</code></p>\n</li>\n<li>\n<p><strong>如果发现多个设备</strong></p>\n<p><code>adb -s 设备号 其他指令</code></p>\n</li>\n<li>\n<p><strong>查看顶部 Activity</strong></p>\n<ul>\n<li>\n<p>windows 环境下:</p>\n<p><code>adb shell dumpsys activity | findstr &quot;mFocusedActivity&quot;</code></p>\n</li>\n<li>\n<p>Linux、Mac 环境下：</p>\n<p><code>adb shell dumpsys activity | grep &quot;mFocusedActivity&quot;</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>查看日志</strong></p>\n<p><code>adb logcat</code></p>\n</li>\n<li>\n<p><strong>安装 apk 文件</strong></p>\n<p><code>adb install xxx.apk</code></p>\n<p>推荐使用覆盖安装:</p>\n<p><code>adb install -r xxx.apk</code></p>\n</li>\n<li>\n<p><strong>卸载 App</strong></p>\n<p><code>adb uninstall com.zhy.app</code></p>\n<p>如果想要保留数据，则</p>\n<p><code>adb uninstall -k com.zhy.app</code></p>\n</li>\n<li>\n<p><strong>传递文件</strong></p>\n<ul>\n<li>\n<p>往手机 SDCard 传递文件</p>\n<p><code>adb push 文件名 手机端SDCard路径</code></p>\n</li>\n<li>\n<p>从手机端下载文件</p>\n<p><code>adb pull /sdcard/xxx.txt</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>启动 Activity</strong></p>\n<p><code>adb shell am start 包名/完整Activity路径</code></p>\n</li>\n<li>\n<p><strong>清除 APP 数据</strong></p>\n<p><code>adb shell pm clear com.example.packagename</code></p>\n<p><strong>注：该命令清除掉 APP 的缓存，还能把 APP 的数据给清空</strong></p>\n</li>\n<li>\n<p><strong>查看所有 App 的名称</strong></p>\n<p><code>adb shell pm list packages</code></p>\n<p>注：该命令可以查看手机上的 APP 名称。可以在后面加上 -f ，这样还能显示该 APP 的路径，即： <code>adb shell pm list packages -f</code>  或者  <code>adb shell pm path &lt;PACKAGE&gt;</code></p>\n<p><strong>列出第三方应用</strong>： <code>adb shell pm list packages -3</code></p>\n</li>\n</ul>\n",
            "tags": [
                "Python"
            ]
        },
        {
            "id": "https://obsidianlyg.github.io/Arch/Arch/ArcoLinux/",
            "url": "https://obsidianlyg.github.io/Arch/Arch/ArcoLinux/",
            "title": "arch衍生版arcolinux",
            "date_published": "2021-12-27T08:54:55.000Z",
            "content_html": "<h1 id=\"arcolinux\"><a class=\"anchor\" href=\"#arcolinux\">#</a> ArcoLinux</h1>\n<p>super+shfit+a，程序启动窗口</p>\n<p>super+Q，退出</p>\n<p>super + 鼠标单击，可以拖动窗口</p>\n<p>super+Enter，打开默认 urxvt 终端模拟器，附带三个，termite,xfec 自带终端和 alacritt</p>\n<p>Super+Space，修改当前窗口布局</p>\n<p>软件包管理工具有 pacman,pamac,yay</p>\n<p><img data-src=\"https://gitee.com/obsidianlyg/gallery/raw/master/image//2021-08-10_08-27.png\" alt=\"ArcoLinux%20dbdbb4c808024da189a08d644815664f/2021-08-10_08-27.png\" /></p>\n",
            "tags": [
                "arch个人笔记",
                "arch"
            ]
        }
    ]
}